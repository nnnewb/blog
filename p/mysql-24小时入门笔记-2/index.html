<!doctype html><html lang=zh-cn dir=ltr>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="查询 SELECT SELECT是一个特殊的关键字，它的语义是查询，取出结果。 注意：仅为个人理解。 FROM FROM子句，标识要查询的对象的来源，来源可能是多个的"><title>MySQL 24小时入门笔记 - 2</title>
<link rel=canonical href=https://nnnewb.github.io/blog/p/mysql-24%E5%B0%8F%E6%97%B6%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0-2/>
<link rel=stylesheet href=/blog/scss/style.min.709d4f89582c5a09dc94158a722a16093cdffe24d9a8c77dd3f422c786203c41.css><script src=https://unpkg.com/dayjs@1.8.21/dayjs.min.js></script>
<script src=https://unpkg.com/dayjs@1.8.21/plugin/relativeTime.js></script>
<script src=https://unpkg.com/dayjs@1.8.21/locale/zh-cn.js></script>
<script>dayjs.locale('zh-cn'),dayjs.extend(dayjs_plugin_relativeTime)</script><meta property="og:title" content="MySQL 24小时入门笔记 - 2">
<meta property="og:description" content="查询 SELECT SELECT是一个特殊的关键字，它的语义是查询，取出结果。 注意：仅为个人理解。 FROM FROM子句，标识要查询的对象的来源，来源可能是多个的">
<meta property="og:url" content="https://nnnewb.github.io/blog/p/mysql-24%E5%B0%8F%E6%97%B6%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0-2/">
<meta property="og:site_name" content="weakptr's 笔记">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="mysql"><meta property="article:published_time" content="2018-06-23T15:41:00+08:00"><meta property="article:modified_time" content="2018-06-23T15:41:00+08:00">
<meta name=twitter:title content="MySQL 24小时入门笔记 - 2">
<meta name=twitter:description content="查询 SELECT SELECT是一个特殊的关键字，它的语义是查询，取出结果。 注意：仅为个人理解。 FROM FROM子句，标识要查询的对象的来源，来源可能是多个的">
</head>
<body class=article-page>
<script>(function(){const a='StackColorScheme';localStorage.setItem(a,"dark")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky">
<button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box>
<span class=hamburger-inner></span>
</span>
</button>
<header>
<figure class=site-avatar>
<a href=/blog>
<img src=/blog/img/avatar_hub37949326d1692892aa1e64434c0dda6_382115_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a>
<span class=emoji>🍑</span>
</figure>
<div class=site-meta>
<h1 class=site-name><a href=/blog>weakptr's 笔记</a></h1>
<h2 class=site-description>弃船！</h2>
</div>
</header><ol class=social-menu>
<li>
<a href=https://github.com/nnnewb/ target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg>
</a>
</li>
</ol><ol class=menu id=main-menu>
<li>
<a href=/blog><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>首页</span>
</a>
</li>
<li>
<a href=/blog/about><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>关于我</span>
</a>
</li>
<li>
<a href=/blog/archive><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>归档</span>
</a>
</li>
<li>
<a href=/blog/categories><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>分类</span>
</a>
</li>
<li>
<a href=/blog/tags><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg>
<span>标签</span>
</a>
</li>
<li>
<a href=/blog/link><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>友链</span>
</a>
</li>
<li>
<a href=/blog/search><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>搜索</span>
</a>
</li>
<div class=menu-bottom-section>
</div>
</ol>
</aside>
<main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/blog/categories/sql/>
sql
</a>
</header>
<div class=article-title-wrapper>
<h2 class=article-title>
<a href=/blog/p/mysql-24%E5%B0%8F%E6%97%B6%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0-2/>MySQL 24小时入门笔记 - 2</a>
</h2>
</div>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2018-06-23T15:41:00+08:00>2018年 6月 23日</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
阅读时长: 7 分钟
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<h2 id=查询>查询</h2>
<h3 id=select>SELECT</h3>
<p><code>SELECT</code>是一个特殊的关键字，它的语义是查询，取出结果。</p>
<blockquote>
<p><strong>注意</strong>：仅为个人理解。</p>
</blockquote>
<h3 id=from>FROM</h3>
<p><code>FROM</code>子句，标识要查询的对象的来源，来源可能是多个的。在查询有多个来源表的情况下，称之为联结查询（<code>Join query</code>）。</p>
<p>最常见的常规写法是<code>SELECT column FROM table</code>，表示从特定表取出所有行的特定列。</p>
<h3 id=where>WHERE</h3>
<p><code>WHERE</code>子句用于过滤查询的行，只有满足条件的行会被查询出来。</p>
<p>常见的用法有<code>SELECT column FROM table WHERE column &lt;> 0</code>，表示在<code>table</code>表中查询<code>column</code>非空的行，返回这些行的<code>column</code>。</p>
<p>其中的二元关系运算符<code>&lt;></code>表示不等于，其他常见的关系运算符还有这些。</p>
<div class=table-wrapper><table>
<thead>
<tr>
<th>运算符</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>=</code></td>
<td>相等</td>
</tr>
<tr>
<td><code>></code></td>
<td>大于</td>
</tr>
<tr>
<td><code>&lt;</code></td>
<td>小于</td>
</tr>
<tr>
<td><code>>=</code></td>
<td>大于等于</td>
</tr>
<tr>
<td><code>&lt;=</code></td>
<td>小于等于</td>
</tr>
<tr>
<td><code>!=</code></td>
<td>不等于</td>
</tr>
<tr>
<td><code>&lt;></code></td>
<td>不等于</td>
</tr>
</tbody>
</table></div>
<p>此外还有一些<code>SQL</code>关键字可以辅助编写判断逻辑。</p>
<p><code>SQL</code>关键字<code>IN</code>可以用于判断元素是否在集合中。举例，<code>SELECT 1 IN (1,2,3)</code>，查询<code>1</code>是否在<code>1,2,3</code>这个集合中。被判断的集合需要被小括号包围，并且以逗号分隔元素。</p>
<p><code>SQL</code>关键字<code>BETWEEN</code>可以判断元素是否在一定区间中。举例，<code>SELECT 1 BETWEEN 0 and 10</code>，查询<code>1</code>是否在<code>0</code>到<code>10</code>的区间内。语法是<code>BETWEEN [low] AND [high]</code>，区间较小的一端必须在左侧，较大的一端必须在右侧。</p>
<p><code>SQL</code>关键字<code>LIKE</code>可以用非常简单的通配符来判断元素是否匹配一定的规则。举例，<code>SELECT 'abcabcabc' LIKE '%CAB%'</code>，判断字符串<code>abcabcabc</code>是否匹配<code>%CAB%</code>。值得注意的是，模式串中的<code>%</code>代表的是匹配 0 或任意多个字符，就像是正则表达式中的<code>*</code>一样。此外还有<code>_</code>，下划线，匹配 1 个任意字符。</p>
<p><code>MySQL</code>扩展的<code>REGEXP</code>可以用正则表达式来匹配元素是否符合模式串。举例，<code>SELECT 'abcabcabc' REGEXP '.*cab.*'</code>，正则表达式不做赘述，简单的模式串大家都会写。</p>
<h3 id=order-by>ORDER BY</h3>
<p><code>ORDER BY</code>就像字面意义上说的那样，按照某个列来进行排序。举例来说，我有一个学生表，记录了学号和姓名，我可以按照学号排序。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>students</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></code></pre></td></tr></table>
</div>
</div><p>默认排序是升序，也可以通过指定<code>DESC</code>或者<code>ASC</code>来决定怎么排。<code>ASC</code>是升序，<code>DESC</code>是降序。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>students</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></code></pre></td></tr></table>
</div>
</div><h3 id=as>AS</h3>
<p><code>AS</code>常见的用法是建立别名。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=k>SELECT</span><span class=w> </span><span class=k>column</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id_alias</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>my_table</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>table_alias</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>table_alias</span><span class=p>.</span><span class=k>column</span><span class=w> </span><span class=o>&lt;&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></code></pre></td></tr></table>
</div>
</div><p>这里出现了一个新的语法细节，<code>table_alias.column</code>。用点<code>.</code>连接表名和列名的行为类似于 C++中的</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=k>typedef</span> <span class=n>table_alias</span> <span class=o>=</span> <span class=n>my_table</span><span class=p>;</span>
<span class=k>auto</span> <span class=n>id_alias</span> <span class=o>=</span> <span class=n>SELECT</span><span class=p>(</span><span class=n>table_alias</span><span class=o>::</span><span class=n>column</span><span class=p>,</span> <span class=n>table_alias</span><span class=o>::</span><span class=n>column</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>);</span>
</code></pre></td></tr></table>
</div>
</div><p>看得出来，<code>table_alias.column</code>是完全限定了<code>column</code>是哪个<code>column</code>，之所以有这种语法，是因为<code>FROM</code>子句需要支持多个表作为查询来源。到时候可能就会用到<code>table1.column &lt;> 1 AND table2.column &lt;> 2</code>这样的写法了。</p>
<p>而查询开头的<code>column AS id_alias</code>则是标识查询结果列叫做<code>id_alias</code>，举例如子查询的情况下，便于引用。</p>
<h3 id=join>JOIN</h3>
<p><code>JOIN</code>的术语叫做<strong>联结</strong>，使用了<code>JOIN</code>关键字的查询叫做<strong>联结查询</strong>。</p>
<p>联结查询和一般的查询不同的地方是，联结查询的数据来源是多个表。</p>
<p>最简单的联结查询是内联结查询。</p>
<p>举例来说，我现在有表<code>students</code>如下，所有学生根据超能力开发等级分配到多个班级。</p>
<div class=table-wrapper><table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>class</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>stu1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>stu2</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>stu3</td>
<td>3</td>
</tr>
<tr>
<td>4</td>
<td>stu4</td>
<td>4</td>
</tr>
</tbody>
</table></div>
<p>又有表<code>top_class</code>，收录了所有接收高等级超能力者的班级，能进入这些班级的学生都是如同能考上<code>985</code>、<code>211</code>般恐怖如斯的存在。</p>
<div class=table-wrapper><table>
<thead>
<tr>
<th>id</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Lv 5</td>
</tr>
<tr>
<td>2</td>
<td>Lv 4</td>
</tr>
<tr>
<td>3</td>
<td>Lv 3</td>
</tr>
</tbody>
</table></div>
<p>现在我们要查询出学生中那些恐怖如斯的存在有哪些。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=k>SELECT</span><span class=w> </span><span class=n>students</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>students</span><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>top_class</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>top_class</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>students</span><span class=p>.</span><span class=k>class</span><span class=p>;</span><span class=w>
</span></code></pre></td></tr></table>
</div>
</div><p>语法<code>JOIN [表] ON [条件]</code>也很简单啦。在例子中，<code>JOIN</code>表示要联结表<code>top_class</code>，<code>ON</code>表示查询的对象要符合条件<code>top_class.id = students.class</code>。不好理解？看看伪代码。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=k>for</span><span class=p>(</span><span class=k>auto</span> <span class=nl>student</span> <span class=p>:</span> <span class=n>students</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 先过滤 students 表本身，这个过滤应该由 WHERE 子句完成
</span><span class=c1></span>  <span class=k>for</span><span class=p>(</span><span class=k>auto</span> <span class=nl>cls</span> <span class=p>:</span> <span class=n>top_class</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 然后联结表 top_class
</span><span class=c1></span>    <span class=k>if</span><span class=p>(</span><span class=n>student</span><span class=p>.</span><span class=n>cls</span> <span class=o>=</span> <span class=n>cls</span><span class=p>.</span><span class=n>id</span><span class=p>)</span> <span class=c1>// 判断 ON students.class = top_class.id
</span><span class=c1></span>      <span class=n>results</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>student</span><span class=p>);</span> <span class=c1>// 得出结果
</span><span class=c1></span>  <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意，伪代码的查询过程是错误的，为了方便理解 students.class = top_class.id 才这么写。真实数据库实现联结查询的方法应当查阅对应<code>DBMS</code>的文档。</p>
</blockquote>
<p>注意的关键点有<code>ON</code>很像但不同于<code>WHERE</code>，在了解<code>LEFT JOIN</code>和<code>RIGHT JOIN</code>时会区分。</p>
<h3 id=left-join>LEFT JOIN</h3>
<p><code>LEFT JOIN</code>又叫<strong>左联结</strong>，基本思路是写在<code>LEFT JOIN</code>左边的表满足条件即可作为结果，即使右边的表没有满足条件的条目。</p>
<p>还是以上文的学园都市数据库为例（我 tm 写了什么&mldr;）</p>
<p>学生表 <code>students</code></p>
<div class=table-wrapper><table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>class</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>stu1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>stu2</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>stu3</td>
<td>3</td>
</tr>
<tr>
<td>4</td>
<td>stu4</td>
<td>4</td>
</tr>
</tbody>
</table></div>
<p>班级表 <code>top_class</code></p>
<div class=table-wrapper><table>
<thead>
<tr>
<th>id</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Lv 5</td>
</tr>
<tr>
<td>2</td>
<td>Lv 4</td>
</tr>
<tr>
<td>3</td>
<td>Lv 3</td>
</tr>
</tbody>
</table></div>
<p>现在我们查询学生都处在哪些班级，得到班级的名字。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=k>SELECT</span><span class=w> </span><span class=n>students</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>top_class</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>cls</span><span class=w>
</span><span class=w>       </span><span class=k>FROM</span><span class=w> </span><span class=n>students</span><span class=w> </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>top_class</span><span class=w>
</span><span class=w>            </span><span class=k>ON</span><span class=w> </span><span class=n>top_class</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>students</span><span class=p>.</span><span class=k>class</span><span class=p>;</span><span class=w>
</span></code></pre></td></tr></table>
</div>
</div><p>查询结果应该是这样子的。</p>
<div class=table-wrapper><table>
<thead>
<tr>
<th>name</th>
<th>cls</th>
</tr>
</thead>
<tbody>
<tr>
<td>stu1</td>
<td>Lv 5</td>
</tr>
<tr>
<td>stu2</td>
<td>Lv 4</td>
</tr>
<tr>
<td>stu3</td>
<td>Lv 3</td>
</tr>
<tr>
<td>stu4</td>
<td><code>NULL</code></td>
</tr>
</tbody>
</table></div>
<p>注意到了吗？<code>stu4</code>虽然不是<code>top_class</code>的学生，但是还是被查询出来了。</p>
<h3 id=right-join>RIGHT JOIN</h3>
<p>继续拿学园都市做例子&mldr;&mldr;</p>
<p>其实是和左联结一个鸟样。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=k>SELECT</span><span class=w> </span><span class=n>students</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>top_class</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>cls</span><span class=w>
</span><span class=w>       </span><span class=k>FROM</span><span class=w> </span><span class=n>top_class</span><span class=w> </span><span class=k>RIGHT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>students</span><span class=w>
</span><span class=w>            </span><span class=k>ON</span><span class=w> </span><span class=n>top_class</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>students</span><span class=p>.</span><span class=k>class</span><span class=p>;</span><span class=w>
</span></code></pre></td></tr></table>
</div>
</div><p>我们注意到&mldr;&mldr;我就是把 <code>students</code>和 <code>top_class</code>换了个位置。查询结果其实是一样的。</p>
<div class=table-wrapper><table>
<thead>
<tr>
<th>name</th>
<th>cls</th>
</tr>
</thead>
<tbody>
<tr>
<td>stu1</td>
<td>Lv 5</td>
</tr>
<tr>
<td>stu2</td>
<td>Lv 4</td>
</tr>
<tr>
<td>stu3</td>
<td>Lv 3</td>
</tr>
<tr>
<td>stu4</td>
<td><code>NULL</code></td>
</tr>
</tbody>
</table></div>
<h3 id=cross-join>CROSS JOIN</h3>
<p>交叉联结，查询结果是联结的表和<code>FROM</code>的表的笛卡尔积，这么说听的明白不？听不明白就算了，因为交叉联结基本用不到。</p>
<p>其实就是把两个表的每个行都排列组合一下：</p>
<ul>
<li>表 A 行 1-表 B 行 1</li>
<li>表 A 行 1-表 B 行 2</li>
<li>&mldr;&mldr;</li>
<li>表 A 行 10-表 B 行 1</li>
<li>表 A 行 10-表 B 行 2</li>
<li>表 A 行 10-表 B 行 3</li>
<li>&mldr;&mldr;</li>
</ul>
<h3 id=join-自己>JOIN 自己？</h3>
<p>术语叫自联结，其实也挺好理解的，直接举个例子看看。</p>
<div class=table-wrapper><table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>class</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>stu1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>stu2</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>stu3</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>stu4</td>
<td>2</td>
</tr>
</tbody>
</table></div>
<blockquote>
<p>注意我数据改了哈。</p>
</blockquote>
<p>现在要查询出所有和<code>stu1</code>同一个班级的学生。</p>
<p>一般我们想怎么查？先查出<code>stu1</code>是哪个班级的：<code>SELECT class FROM students WHERE name = 'stu1'</code>，然后查出所有属于这个班级的学生：<code>SELECT name FROM students WHERE class = [上次查出来的班级]</code>。</p>
<p>那么&mldr;怎么写成一句话呢？</p>
<p>这时候自联结就可以上场了。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=k>SELECT</span><span class=w> </span><span class=n>s1</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>s1</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>s1</span><span class=p>.</span><span class=k>class</span><span class=w>
</span><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>students</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>s1</span><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>students</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>s2</span><span class=w>
</span><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>s1</span><span class=p>.</span><span class=k>class</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>s2</span><span class=p>.</span><span class=k>class</span><span class=w>
</span><span class=w>	</span><span class=k>AND</span><span class=w> </span><span class=n>s2</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;stu1&#39;</span><span class=p>;</span><span class=w>
</span></code></pre></td></tr></table>
</div>
</div><p>查询结果是</p>
<div class=table-wrapper><table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>class</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>stu1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>stu2</td>
<td>1</td>
</tr>
</tbody>
</table></div>
<p>基本思路是这样的：<code>FROM</code>的表是<code>s1</code>，因此<code>INNER JOIN</code>查询结果来自<code>s1</code>而不是<code>s2</code>。查找<code>s1</code>表中每个行的<code>class</code>在<code>s2</code>表里有没有行具有同样的<code>class</code>属性，同时，<code>s2</code>具有和<code>s1</code>同样<code>class</code>属性的行还必须有个<code>stu1</code>的<code>name</code>。</p>
<p>分析得知，<code>s2</code>中有<code>stu1</code>这个<code>name</code>的行只有<code>1</code>，所以<code>s2</code>表其实长这样。</p>
<div class=table-wrapper><table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>class</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>stu1</td>
<td>1</td>
</tr>
</tbody>
</table></div>
<p>这时候再去看<code>s1</code>表，<code>s1</code>表的<code>class</code>同时存在于<code>s2</code>表的行只有<code>1</code>和<code>2</code>了。</p>
<h3 id=outer-join>OUTER JOIN</h3>
<p>其实<code>OUTER JOIN</code>上面的<code>LEFT JOIN</code>和<code>RIGHT JOIN</code>已经讲过了，<code>LEFT JOIN</code>的完整写法就是<code>LEFT OUTER JOIN</code>，<code>RIGHT JOIN</code>就是<code>RIGHT OUTER JOIN</code>，和<code>INNER JOIN</code>的区别在于<code>OUTER JOIN</code>包含了指定表里不满足<code>ON</code>条件的行。</p>
<p>这有个知识点，就是<code>ON</code>条件不过滤指定<code>OUTER JOIN</code>的表的不满足条件的行，但是<code>WHERE</code>会过滤。</p>
<h3 id=union>UNION</h3>
<p><code>UNION</code>关键字的术语是<strong>联合查询</strong>。</p>
<p>作用是将多个<code>SELECT</code>的结果放在一起并返回。</p>
<p>举个例子&mldr;&mldr;我们要查询全美最好的大学<code>american_top_college</code>和中国最好的大学<code>chinese_top_college</code>数据，来决定报考哪个大学（反正都考不上），如果不想写成两句<code>SELECT</code>，然后手工合并成一个表格的话，那么就用<code>UNION</code>查询吧。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=k>SELECT</span><span class=w> </span><span class=s1>&#39;american&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>nation</span><span class=p>,</span><span class=w> </span><span class=n>american_top_college</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>college_name</span><span class=p>,</span><span class=w> </span><span class=n>american_top_college</span><span class=p>.</span><span class=n>score_line</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>score_line</span><span class=w>
</span><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>american_top_college</span><span class=w>
</span><span class=w></span><span class=k>UNION</span><span class=w>
</span><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=s1>&#39;china&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>nation</span><span class=p>,</span><span class=w> </span><span class=n>chinese_top_college</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>college_name</span><span class=p>,</span><span class=w> </span><span class=n>chinese_top_college</span><span class=p>.</span><span class=n>score_line</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>score_line</span><span class=p>;</span><span class=w>
</span></code></pre></td></tr></table>
</div>
</div><p>查询结果&mldr;不展示了。</p>
<p>还有个细节可能要注意，如果有大学同时是美国大学和中国大学的话，那么为了在联合查询中排除相同的项目，可以使用<code>UNION ALL</code>而不是<code>UNION</code>。</p>
<h3 id=fulltext>FULLTEXT</h3>
<p><code>MySQL</code>支持一种实用的文本索引方式，叫做<strong>全文本搜索</strong>。大家都知道，正则表达式和简单通配符来查找文本是非常消耗性能的操作，而且难以优化（反正我想不出任何减少查询的优化思路）。<code>MySQL</code>提供了全文本搜索的属性来帮助索引文本（但是想到中文支持我觉得已经凉的差不多了），快速查询出包含特定词汇之类的行。</p>
<blockquote>
<p>抱歉我觉得不行。不说别的，中文分词就&mldr;&mldr;</p>
</blockquote>
<p>跳过了跳过了。</p>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/blog/tags/mysql/>mysql</a>
</section>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>相关文章</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article>
<a href=/blog/p/mysql-xa-distributed-transaction-processing-model-2pc/>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>MySQL XA 事务和分布式事务处理模型：2阶段提交</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/mysql-24%E5%B0%8F%E6%97%B6%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0-4/>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>MySQL 24小时入门笔记 - 4</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/mysql-24%E5%B0%8F%E6%97%B6%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0-3/>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>MySQL 24小时入门笔记 - 3</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/mysql-24%E5%B0%8F%E6%97%B6%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0-1/>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>MySQL 24小时入门笔记 - 1</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<footer class=site-footer>
<section class=copyright>
&copy;
2021 -
2023 weakptr's 笔记
</section>
<section class=powerby>
GitHub Pages <br>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计
，由 <a href=https://nnnewb.github.io/blog/>nnnewb</a> 修改
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">目录</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#查询>查询</a>
<ol>
<li><a href=#select>SELECT</a></li>
<li><a href=#from>FROM</a></li>
<li><a href=#where>WHERE</a></li>
<li><a href=#order-by>ORDER BY</a></li>
<li><a href=#as>AS</a></li>
<li><a href=#join>JOIN</a></li>
<li><a href=#left-join>LEFT JOIN</a></li>
<li><a href=#right-join>RIGHT JOIN</a></li>
<li><a href=#cross-join>CROSS JOIN</a></li>
<li><a href=#join-自己>JOIN 自己？</a></li>
<li><a href=#outer-join>OUTER JOIN</a></li>
<li><a href=#union>UNION</a></li>
<li><a href=#fulltext>FULLTEXT</a></li>
</ol>
</li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/blog/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>