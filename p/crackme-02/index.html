<!doctype html><html lang=zh-cn dir=ltr>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="å¾—æœ‰ä¸ªå‰è¨€ æ€»ä¹‹ä¸Šä¸€ä¸ª crackme-01 è¿˜è¿‡å¾—å»ï¼Œç¨å¾®åŠ å¼ºä¸€ç‚¹ï¼ŒæŠŠå¯†ç éšè—èµ·æ¥ï¼Œä¸è¦éšä¾¿è¢«çœ‹åˆ°ã€‚ 0x01 æºç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28"><title>è‡ªå¨±è‡ªä¹ crackme-02</title>
<link rel=canonical href=https://nnnewb.github.io/blog/p/crackme-02/>
<link rel=stylesheet href=/blog/scss/style.min.709d4f89582c5a09dc94158a722a16093cdffe24d9a8c77dd3f422c786203c41.css><script src=https://unpkg.com/dayjs@1.8.21/dayjs.min.js></script>
<script src=https://unpkg.com/dayjs@1.8.21/plugin/relativeTime.js></script>
<script src=https://unpkg.com/dayjs@1.8.21/locale/zh-cn.js></script>
<script>dayjs.locale('zh-cn'),dayjs.extend(dayjs_plugin_relativeTime)</script><meta property="og:title" content="è‡ªå¨±è‡ªä¹ crackme-02">
<meta property="og:description" content="å¾—æœ‰ä¸ªå‰è¨€ æ€»ä¹‹ä¸Šä¸€ä¸ª crackme-01 è¿˜è¿‡å¾—å»ï¼Œç¨å¾®åŠ å¼ºä¸€ç‚¹ï¼ŒæŠŠå¯†ç éšè—èµ·æ¥ï¼Œä¸è¦éšä¾¿è¢«çœ‹åˆ°ã€‚ 0x01 æºç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28">
<meta property="og:url" content="https://nnnewb.github.io/blog/p/crackme-02/">
<meta property="og:site_name" content="weakptr's ç¬”è®°">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="æ±‡ç¼–"><meta property="article:tag" content="é€†å‘"><meta property="article:published_time" content="2021-09-15T15:43:00+08:00"><meta property="article:modified_time" content="2021-09-15T15:43:00+08:00">
<meta name=twitter:title content="è‡ªå¨±è‡ªä¹ crackme-02">
<meta name=twitter:description content="å¾—æœ‰ä¸ªå‰è¨€ æ€»ä¹‹ä¸Šä¸€ä¸ª crackme-01 è¿˜è¿‡å¾—å»ï¼Œç¨å¾®åŠ å¼ºä¸€ç‚¹ï¼ŒæŠŠå¯†ç éšè—èµ·æ¥ï¼Œä¸è¦éšä¾¿è¢«çœ‹åˆ°ã€‚ 0x01 æºç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28">
</head>
<body class=article-page>
<script>(function(){const a='StackColorScheme';localStorage.setItem(a,"light")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky">
<button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box>
<span class=hamburger-inner></span>
</span>
</button>
<header>
<figure class=site-avatar>
<a href=/blog/>
<img src=/blog/img/avatar_hub37949326d1692892aa1e64434c0dda6_382115_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a>
<span class=emoji>ğŸ‘</span>
</figure>
<div class=site-meta>
<h1 class=site-name><a href=/blog>weakptr's ç¬”è®°</a></h1>
<h2 class=site-description>å¼ƒèˆ¹ï¼</h2>
</div>
</header><ol class=social-menu>
<li>
<a href=https://github.com/nnnewb/ target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg>
</a>
</li>
</ol><ol class=menu id=main-menu>
<li>
<a href=/blog/blog/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>é¦–é¡µ</span>
</a>
</li>
<li>
<a href=/blog/blog/about><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>å…³äºæˆ‘</span>
</a>
</li>
<li>
<a href=/blog/blog/archive><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>å½’æ¡£</span>
</a>
</li>
<li>
<a href=/blog/blog/categories><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>åˆ†ç±»</span>
</a>
</li>
<li>
<a href=/blog/blog/tags><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg>
<span>æ ‡ç­¾</span>
</a>
</li>
<li>
<a href=/blog/blog/link><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>å‹é“¾</span>
</a>
</li>
<li>
<a href=/blog/blog/search><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœç´¢</span>
</a>
</li>
<div class=menu-bottom-section>
</div>
</ol>
</aside>
<main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/blog/categories/%E9%80%86%E5%90%91/>
é€†å‘
</a>
</header>
<div class=article-title-wrapper>
<h2 class=article-title>
<a href=/blog/p/crackme-02/>è‡ªå¨±è‡ªä¹ crackme-02</a>
</h2>
</div>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2021-09-15T15:43:00+08:00>2021å¹´ 9æœˆ 15æ—¥</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
é˜…è¯»æ—¶é•¿: 14 åˆ†é’Ÿ
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<h2 id=å¾—æœ‰ä¸ªå‰è¨€>å¾—æœ‰ä¸ªå‰è¨€</h2>
<p>æ€»ä¹‹ä¸Šä¸€ä¸ª crackme-01 è¿˜è¿‡å¾—å»ï¼Œç¨å¾®åŠ å¼ºä¸€ç‚¹ï¼ŒæŠŠå¯†ç éšè—èµ·æ¥ï¼Œä¸è¦éšä¾¿è¢«çœ‹åˆ°ã€‚</p>
<h2 id=0x01-æºç >0x01 æºç </h2>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span><span class=cp></span>
<span class=n>size_t</span> <span class=nf>getline</span><span class=p>(</span><span class=kt>char</span> <span class=o>**</span><span class=n>lineptr</span><span class=p>,</span> <span class=n>size_t</span> <span class=o>*</span><span class=n>n</span><span class=p>,</span> <span class=n>FILE</span> <span class=o>*</span><span class=n>stream</span><span class=p>)</span> <span class=p>{</span>
  <span class=kt>char</span> <span class=o>*</span><span class=n>bufptr</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
  <span class=kt>char</span> <span class=o>*</span><span class=n>p</span> <span class=o>=</span> <span class=n>bufptr</span><span class=p>;</span>
  <span class=n>size_t</span> <span class=n>size</span><span class=p>;</span>
  <span class=kt>int</span> <span class=n>c</span><span class=p>;</span>

  <span class=k>if</span> <span class=p>(</span><span class=n>lineptr</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>stream</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=n>bufptr</span> <span class=o>=</span> <span class=o>*</span><span class=n>lineptr</span><span class=p>;</span>
  <span class=n>size</span> <span class=o>=</span> <span class=o>*</span><span class=n>n</span><span class=p>;</span>

  <span class=n>c</span> <span class=o>=</span> <span class=n>fgetc</span><span class=p>(</span><span class=n>stream</span><span class=p>);</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>c</span> <span class=o>==</span> <span class=n>EOF</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>bufptr</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>bufptr</span> <span class=o>=</span> <span class=n>malloc</span><span class=p>(</span><span class=mi>128</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>bufptr</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
      <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=n>size</span> <span class=o>=</span> <span class=mi>128</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=n>p</span> <span class=o>=</span> <span class=n>bufptr</span><span class=p>;</span>
  <span class=k>while</span> <span class=p>(</span><span class=n>c</span> <span class=o>!=</span> <span class=n>EOF</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>((</span><span class=n>p</span> <span class=o>-</span> <span class=n>bufptr</span><span class=p>)</span> <span class=o>&gt;</span> <span class=p>(</span><span class=n>size</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))</span> <span class=p>{</span>
      <span class=n>size</span> <span class=o>=</span> <span class=n>size</span> <span class=o>+</span> <span class=mi>128</span><span class=p>;</span>
      <span class=n>bufptr</span> <span class=o>=</span> <span class=n>realloc</span><span class=p>(</span><span class=n>bufptr</span><span class=p>,</span> <span class=n>size</span><span class=p>);</span>
      <span class=k>if</span> <span class=p>(</span><span class=n>bufptr</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
      <span class=p>}</span>
    <span class=p>}</span>
    <span class=o>*</span><span class=n>p</span><span class=o>++</span> <span class=o>=</span> <span class=n>c</span><span class=p>;</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>c</span> <span class=o>==</span> <span class=sc>&#39;\n&#39;</span><span class=p>)</span> <span class=p>{</span>
      <span class=k>break</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=n>c</span> <span class=o>=</span> <span class=n>fgetc</span><span class=p>(</span><span class=n>stream</span><span class=p>);</span>
  <span class=p>}</span>

  <span class=o>*</span><span class=n>p</span><span class=o>++</span> <span class=o>=</span> <span class=sc>&#39;\0&#39;</span><span class=p>;</span>
  <span class=o>*</span><span class=n>lineptr</span> <span class=o>=</span> <span class=n>bufptr</span><span class=p>;</span>
  <span class=o>*</span><span class=n>n</span> <span class=o>=</span> <span class=n>size</span><span class=p>;</span>

  <span class=k>return</span> <span class=n>p</span> <span class=o>-</span> <span class=n>bufptr</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
<span class=p>}</span>

<span class=n>size_t</span> <span class=nf>r_trim</span><span class=p>(</span><span class=kt>char</span> <span class=o>*</span><span class=n>str</span><span class=p>,</span> <span class=n>size_t</span> <span class=n>len</span><span class=p>)</span> <span class=p>{</span>
  <span class=n>size_t</span> <span class=n>slen</span> <span class=o>=</span> <span class=n>strnlen</span><span class=p>(</span><span class=n>str</span><span class=p>,</span> <span class=n>len</span><span class=p>);</span>
  <span class=k>for</span> <span class=p>(</span><span class=n>size_t</span> <span class=n>i</span> <span class=o>=</span> <span class=n>slen</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>str</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39; &#39;</span> <span class=o>||</span> <span class=n>str</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;\n&#39;</span> <span class=o>||</span> <span class=n>str</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;\r&#39;</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>str</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;\0&#39;</span><span class=p>;</span>
    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
      <span class=k>break</span><span class=p>;</span>
    <span class=p>}</span>
  <span class=p>}</span>
  <span class=k>return</span> <span class=n>strnlen</span><span class=p>(</span><span class=n>str</span><span class=p>,</span> <span class=n>len</span><span class=p>);</span>
<span class=p>}</span>

<span class=kt>char</span> <span class=o>*</span><span class=nf>calculate</span><span class=p>(</span><span class=kt>char</span> <span class=o>*</span><span class=n>username</span><span class=p>,</span> <span class=k>const</span> <span class=n>size_t</span> <span class=n>username_len</span><span class=p>)</span> <span class=p>{</span>
  <span class=c1>// åˆå§‹åŒ–å›ºå®š8å­—èŠ‚è®¡ç®—å¯†é’¥çš„ç©ºé—´
</span><span class=c1></span>  <span class=k>const</span> <span class=n>size_t</span> <span class=n>input_buf_len</span> <span class=o>=</span> <span class=mi>8</span><span class=p>;</span>
  <span class=kt>char</span> <span class=o>*</span><span class=n>input_buf</span> <span class=o>=</span> <span class=n>malloc</span><span class=p>(</span><span class=n>input_buf_len</span><span class=p>);</span>
  <span class=k>for</span> <span class=p>(</span><span class=n>size_t</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>input_buf_len</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>input_buf</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x52</span> <span class=o>+</span> <span class=n>i</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=c1>// ç”¨ç”¨æˆ·è¾“å…¥æ›¿æ¢åˆå§‹åŒ–çš„æ•°æ®
</span><span class=c1></span>  <span class=n>memcpy_s</span><span class=p>(</span><span class=n>input_buf</span><span class=p>,</span> <span class=n>input_buf_len</span><span class=p>,</span> <span class=n>username</span><span class=p>,</span> <span class=n>username_len</span><span class=p>);</span>

  <span class=c1>// å¼‚æˆ–å¤„ç†
</span><span class=c1></span>  <span class=k>for</span> <span class=p>(</span><span class=n>size_t</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>input_buf_len</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>input_buf</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^=</span> <span class=mh>0x25</span><span class=p>;</span>
  <span class=p>}</span>

  <span class=c1>// åˆå§‹åŒ– Hex è¾“å‡º
</span><span class=c1></span>  <span class=k>const</span> <span class=n>size_t</span> <span class=n>output_buf_len</span> <span class=o>=</span> <span class=mi>17</span><span class=p>;</span>
  <span class=kt>char</span> <span class=o>*</span><span class=n>output_buf</span> <span class=o>=</span> <span class=n>malloc</span><span class=p>(</span><span class=n>output_buf_len</span><span class=p>);</span>

  <span class=c1>// è½¬ä¸ºå¯è¯»å­—ç¬¦ä¸²
</span><span class=c1></span>  <span class=k>for</span> <span class=p>(</span><span class=n>size_t</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>input_buf_len</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>sprintf</span><span class=p>(</span><span class=o>&amp;</span><span class=n>output_buf</span><span class=p>[</span><span class=n>i</span> <span class=o>*</span> <span class=mi>2</span><span class=p>],</span> <span class=s>&#34;%02x&#34;</span><span class=p>,</span> <span class=n>input_buf</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
  <span class=p>}</span>

  <span class=n>output_buf</span><span class=p>[</span><span class=mi>16</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
  <span class=n>free</span><span class=p>(</span><span class=n>input_buf</span><span class=p>);</span>
  <span class=k>return</span> <span class=n>output_buf</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>while</span> <span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
    <span class=kt>char</span> <span class=o>*</span><span class=n>username</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
    <span class=n>size_t</span> <span class=n>username_len</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=kt>char</span> <span class=o>*</span><span class=n>serial</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
    <span class=n>size_t</span> <span class=n>serial_len</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=n>size_t</span> <span class=n>linesize</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;username:&#34;</span><span class=p>);</span>
    <span class=n>linesize</span> <span class=o>=</span> <span class=n>getline</span><span class=p>(</span><span class=o>&amp;</span><span class=n>username</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>username_len</span><span class=p>,</span> <span class=n>stdin</span><span class=p>);</span>
    <span class=n>username_len</span> <span class=o>=</span> <span class=n>r_trim</span><span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=n>linesize</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>username_len</span> <span class=o>&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>free</span><span class=p>(</span><span class=n>username</span><span class=p>);</span>
      <span class=n>puts</span><span class=p>(</span><span class=s>&#34;username less than 8 letter&#34;</span><span class=p>);</span>
      <span class=k>continue</span><span class=p>;</span>
    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>username_len</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>free</span><span class=p>(</span><span class=n>username</span><span class=p>);</span>
      <span class=k>continue</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;serial:&#34;</span><span class=p>);</span>
    <span class=n>linesize</span> <span class=o>=</span> <span class=n>getline</span><span class=p>(</span><span class=o>&amp;</span><span class=n>serial</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>serial_len</span><span class=p>,</span> <span class=n>stdin</span><span class=p>);</span>
    <span class=n>serial_len</span> <span class=o>=</span> <span class=n>r_trim</span><span class=p>(</span><span class=n>serial</span><span class=p>,</span> <span class=n>linesize</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>serial_len</span> <span class=o>!=</span> <span class=mi>16</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>free</span><span class=p>(</span><span class=n>username</span><span class=p>);</span>
      <span class=n>free</span><span class=p>(</span><span class=n>serial</span><span class=p>);</span>
      <span class=n>puts</span><span class=p>(</span><span class=s>&#34;serial has 16 letters&#34;</span><span class=p>);</span>
      <span class=k>continue</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>char</span> <span class=o>*</span><span class=n>correct</span> <span class=o>=</span> <span class=n>calculate</span><span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=n>username_len</span><span class=p>);</span>
    <span class=kt>int</span> <span class=n>rc</span> <span class=o>=</span> <span class=n>strncmp</span><span class=p>(</span><span class=n>serial</span><span class=p>,</span> <span class=n>correct</span><span class=p>,</span> <span class=mi>16</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>rc</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>free</span><span class=p>(</span><span class=n>correct</span><span class=p>);</span>
      <span class=n>puts</span><span class=p>(</span><span class=s>&#34;Good job!&#34;</span><span class=p>);</span>
      <span class=k>break</span><span class=p>;</span>
    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
      <span class=n>puts</span><span class=p>(</span><span class=s>&#34;wrong pwd!&#34;</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=n>free</span><span class=p>(</span><span class=n>username</span><span class=p>);</span>
    <span class=n>free</span><span class=p>(</span><span class=n>serial</span><span class=p>);</span>
    <span class=n>free</span><span class=p>(</span><span class=n>correct</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>ç¼–è¯‘æ–¹å¼æ˜¯</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-batch data-lang=batch>clang main.c -o cm02-easy.exe -Wall -m32 -O0
clang main.c -o cm02-normal.exe -Wall -m32 -O1
clang main.c -o cm02-hard.exe -Wall -m32 -O2
</code></pre></td></tr></table>
</div>
</div><h2 id=0x02-è§‚å¯Ÿ>0x02 è§‚å¯Ÿ</h2>
<p>å¯åŠ¨åè§‚å¯Ÿè¡Œä¸ºï¼ˆä¸æˆªå›¾äº†ã€‚ï¼‰</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext>weakptr in cm02 â¯ .\cm02-easy.exe
username:abc
serial:123456
serial é•¿åº¦ä¸º16
username:abc
serial:123456789012345 
wrong pwd!
username:
serial:
serial é•¿åº¦ä¸º16
username:abc
serial:aaaaaaaaaaaaaaa
wrong pwd!
</code></pre></td></tr></table>
</div>
</div><p>è¿™æ¬¡çš„ç›®æ ‡æ˜¯ï¼š</p>
<ol>
<li>å¾—åˆ°æŸä¸ªç”¨æˆ·åå¯¹åº”çš„åºåˆ—å·ï¼ˆ<code>serial</code>ï¼‰ã€‚</li>
<li>ç ´è§£ï¼Œæ€»æ˜¯æ­£ç¡®æˆ–å¯¹ä»»ä½•è¾“å…¥éƒ½æç¤ºæ­£ç¡®ã€‚</li>
<li>æ³¨å†Œæœºã€‚</li>
</ol>
<h2 id=0x03-é™æ€åˆ†æ---easy>0x03 é™æ€åˆ†æ - easy</h2>
<h3 id=31-ä¸»å¾ªç¯>3.1 ä¸»å¾ªç¯</h3>
<p>åœ¨å…¬å¸æ²¡IDAï¼Œç”¨ <a class=link href=image/crackme-02/https://cutter.re/>Cutter</a> æ‰“å¼€ï¼Œåœ¨ä¸Šæ–¹è¾“å…¥æ¡†è¾“å…¥ <code>main</code> è·³è½¬åˆ° <code>main</code> å‡½æ•°ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-1.png loading=lazy alt=image-20210914114426600></p>
<p>ç„¶åç‚¹å‡» <em>å›¾è¡¨ï¼ˆmainï¼‰</em> è¿›å…¥ç±»ä¼¼ IDA çš„æ§åˆ¶æµè§†å›¾ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-2.png loading=lazy alt=image-20210914114547128></p>
<p>ä¹‹åå°±èƒ½çœ‹åˆ°ä¸‹é¢çš„æ§åˆ¶æµäº†ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-3.png loading=lazy></p>
<p>easyéš¾åº¦ä¸‹æ²¡æœ‰å¼€å¯ä»»ä½•ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œæ§åˆ¶æµå’ŒåŸå§‹ä»£ç èƒ½ç›´æ¥å¯¹åº”ä¸Šã€‚ç§ç€å›°éš¾å¾ˆå¤šå¯¹å§ï¼Ÿ</p>
<p>å…ˆç®€å•æ‰«ä¸€çœ¼ï¼Œä¼šå‘ç°å¾ˆå¤šåˆ†æ”¯ç›´æ¥è·³å›äº†<code>0x0040139d</code>ï¼Œä¹Ÿå°±æ˜¯ä»ä¸Šå¾€ä¸‹æ•°ç¬¬äºŒä¸ªä»£ç å—ï¼ŒåŸºæœ¬æ¯ä¸ªè·³è½¬éƒ½æ˜¯ä¸‹ä¸€ä¸ªå—æˆ–è·³å›è¿™ä¸ªå—ã€‚æŒ‰ç…§ <a class=link href=https://nnnewb.github.io/blog/p/crackme-01/ target=_blank rel=noopener>cm01</a>çš„ç»éªŒï¼Œæˆ‘ä»¬å…ˆæ‰¾åˆ°å…³é”®çš„ä¸€è·³ã€‚å¯ä»¥ç›´æ¥æœç´¢å­—ç¬¦ä¸²å¼•ç”¨ï¼ˆ<code>wrong pwd!</code>ï¼‰ï¼Œä¹Ÿå¯ä»¥é€ä¸ªä»£ç å—çœ‹ä¸‹å»ã€‚</p>
<p>å¾ˆå¿«ï¼Œå³ä¸‹è§’çš„å…³é”®è·³å‡ºç°åœ¨çœ¼å‰ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-4.png loading=lazy alt=image-20210914152834262></p>
<p>æ¥ç€å›å¤´çœ‹è·³è½¬æ¡ä»¶ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-5.png loading=lazy alt=image-20210914153728179></p>
<p>è™½ç„¶æ²¡æœ‰åå­—ï¼Œä½†<code>fcn.00403ef4</code> æ˜¯è€ç†Ÿäººäº†ã€‚ä¸‰ä¸ªå‚æ•°ï¼Œ<code>ecx</code>ã€<code>eax</code>ã€<code>0x10</code>ï¼Œè¿”å›ç»“æœå’Œ<code>0</code>åšæ¯”è¾ƒï¼Œ<code>jne</code>æ¡ä»¶è·³è½¬ã€‚</p>
<ul>
<li><code>cmp</code>æŒ‡ä»¤ï¼Œæ“ä½œæ•°ç›¸å‡ï¼ˆ<code>dest</code>-<code>src</code>ï¼‰ï¼Œç»“æœå­˜å…¥æ ‡å¿—ä½ <code>SF</code>å’Œ<code>ZF</code>ã€‚
<ul>
<li>ç»“æœæ˜¯è´Ÿæ•°ï¼ˆ<code>dest</code>&lt;<code>src</code>ï¼‰ï¼Œ<code>SF</code>ä¹Ÿå°±æ˜¯ç»“æœç¬¦å·ä½è®¾ç½®ä¸º1ã€‚</li>
<li>ç»“æœæ˜¯æ­£æ•°ï¼ˆ<code>dest</code>><code>src</code>ï¼‰ï¼Œ<code>SF</code>ä¹Ÿå°±æ˜¯ç»“æœç¬¦å·ä½è®¾ç½®ä¸º0ã€‚</li>
<li>ç»“æœæ˜¯0ï¼ˆ<code>dest</code>=<code>src</code>ï¼‰ï¼Œ<code>ZF</code>è®¾ç½®ä¸º1ã€‚</li>
</ul>
</li>
<li><code>jne</code>æˆ–<code>jnz</code>æŒ‡ä»¤ï¼Œéé›¶è·³è½¬ã€‚<code>ZF</code>æ ‡å¿—ä½ä¸º<code>1</code>æ—¶è·³è½¬ã€‚</li>
</ul>
<p>çŒœæµ‹è¿™ä¸ªå‡½æ•°åº”è¯¥æ˜¯<code>strncmp</code>ã€‚ç»§ç»­å¾€å›çœ‹å‚æ•°æ˜¯æ€ä¹ˆæ¥çš„ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-6.png loading=lazy alt=image-20210914155544252></p>
<p><code>eax</code>æ¥è‡ª<code>sub.02x_40298c</code>è¿™ä¸ªå‡½æ•°ï¼Œåé¢ä¸¤ä¸ªè„±è£¤å­æ”¾å±çš„<code>mov</code>å¿½ç•¥ã€‚<code>ecx</code>åˆ™æ¥æ¥è‡ª<code>mov ecx,dword [ebp-10h]</code>è¿™ä¸€è¡Œã€‚</p>
<p>å…ˆä¸ç€æ€¥åˆ†æå‡½æ•°ï¼Œç»§ç»­å¾€å›æ‰¾ï¼Œæ‰¾åˆ°<code>[ebp-10h]</code>çš„æ¥æºã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-7.png loading=lazy alt=image-20210914161814604></p>
<p>åœ¨å…¥å£ç‚¹é™„è¿‘ï¼Œçœ‹åˆ°<code>[ebp-10]</code>è¢«åˆå§‹åŒ–æˆäº†0ã€‚</p>
<p>å› ä¸ºæ²¡æœ‰å¾ˆæ˜ç¡®çš„è·¯å¾„ï¼Œæ‰‹åŠ¨è®¡ç®—æ ˆä¸Šåç§»åˆéå¸¸éº»çƒ¦ï¼Œè¿™é‡Œæœ¬åº”è¯¥æå‡ºè°ƒè¯•å™¨â€”â€”ä½†å‡ºäºå­¦ä¹ ç»ƒæ‰‹çš„ç›®çš„ï¼Œè¿˜æ˜¯å…ˆå°è¯•è®¡ç®—ä¸‹ã€‚é¦–å…ˆå›é¡¾ä¸‹ç®€åŒ–çš„æ ˆå†…å­˜å¸ƒå±€ï¼Œä»ä¸Šå¾€ä¸‹å¢é•¿ï¼Œå¦‚å›¾ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-8.png loading=lazy alt=stack-layout></p>
<p>æ¥ä¸‹æ¥ä»<code>mov ebp,esp</code>å¼€å§‹ï¼Œå¾€ä¸‹åˆ—å‡ºæ‰€æœ‰å‡½æ•°è°ƒç”¨ï¼Œæ‹ä¸€æ‹é€»è¾‘ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-9.png loading=lazy alt=image-20210914214920437></p>
<p>ç¬¬ä¸€ä¸ªæ¡†ï¼Œ<code>[esp+2ch+Ix]</code> è®¡ç®—ç»“æœæ˜¯ <code>[esp]</code>ï¼Œä¹Ÿå°±æ˜¯æ ˆé¡¶ï¼Œæ ˆé¡¶è®¾ç½®ä¸ºå­—ç¬¦ä¸² <code>username:</code>ï¼Œæ¥ç€è°ƒç”¨ä¸€ä¸ªæœªçŸ¥å‡½æ•°ã€‚ä»å‚æ•°åˆ¤æ–­æˆ‘ä»¬å…ˆè®¤ä¸ºæ˜¯ä¸€ä¸ªè¾“å‡ºå­—ç¬¦ä¸²çš„å‡½æ•°ã€‚</p>
<p>å†çœ‹ç¬¬äºŒä¸ªæ¡†ï¼Œ<code>acrt_iob_func</code>ï¼Œç™¾åº¦ä¸€ä¸‹å°±ä¼šå‘ç°ï¼Œ<code>__acrt_iob_func</code>å‡½æ•°æ˜¯å®šä¹‰äº c è¿è¡Œåº“é‡Œçš„å‡½æ•°ï¼Œä½œç”¨æ˜¯è¿”å› <code>stdin/stdout/stderr</code> ã€‚æ ˆé¡¶è®¾ç½®ä¸º0ï¼Œæ‰€ä»¥è·å¾—çš„æ˜¯ <code>stdin</code>ã€‚</p>
<p>å†çœ‹ç¬¬ä¸‰ä¸ªæ¡†ï¼Œ<code>edx</code>å’Œ<code>ecx</code>èµ‹å€¼ä¸ºæ ˆä¸Šä¸¤ä¸ªå˜é‡çš„åœ°å€ï¼Œå†ä¸ºå‚æ•°ã€‚æŒ‰é¡ºåºå°±æ˜¯<code>f(edx,ecx,stdin)</code>ã€‚æš‚æ—¶ä¸æ˜ã€‚å‡½æ•°è¿”å›å€¼è¢«èµ‹å€¼å›äº†<code>[ebp-18h]</code>ã€‚</p>
<p>ç¬¬å››ä¸ªæ¡†ï¼Œä»ç¬¬ä¸‰ä¸ªæ¡†å¾—åˆ°çš„è¿”å›å€¼è¢«å½“å‚æ•°ä¼ ç»™ä¸€ä¸ªæœªçŸ¥å‡½æ•°ã€‚<code>f([ebp-8h], [ebp-18h])</code>ï¼Œè¿”å›å€¼è¢«èµ‹å€¼å› <code>[ebp-0Ch]</code>ã€‚</p>
<p>ç»“åˆæœ€åçš„ <code>cmp</code> å’Œ <code>jbe</code> æŒ‡ä»¤åˆ†æï¼Œäººè‚‰åç¼–è¯‘åç”¨ä¼ªä»£ç è¡¨ç¤ºï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚<code>jbe</code>æŒ‡ä»¤åªåœ¨<code>cmp</code>å·¦æ“ä½œæ•°å°äºç­‰äºå³æ“ä½œæ•°æ—¶æ‰§è¡Œè·³è½¬ï¼ˆ<code>CF</code>æ ‡å¿—ä½å’Œ<code>ZF</code>æ ‡å¿—ä½å…¶ä¸­ä¸€ä¸ªä¸º1æ—¶ï¼‰ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=n>var</span> <span class=n>var_8</span> <span class=c1># åç§»å€¼ ebp-8h</span>
<span class=n>var</span> <span class=n>var_0C</span> <span class=c1># åç§»å€¼ ebp-0Ch</span>
<span class=n>var</span> <span class=n>var_18</span> <span class=c1># åç§»å€¼ ebp-18h</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&#34;username:&#34;</span><span class=p>)</span>
<span class=n>var_18</span> <span class=o>=</span> <span class=n>unknown_func1</span><span class=p>(</span><span class=o>&amp;</span><span class=n>var_8</span><span class=p>,</span><span class=o>&amp;</span><span class=n>var_0c</span><span class=p>,</span><span class=n>stdin</span><span class=p>)</span>
<span class=n>var_0c</span> <span class=o>=</span> <span class=n>unknown_func2</span><span class=p>(</span><span class=n>var_8</span><span class=p>,</span> <span class=n>var_18</span><span class=p>)</span>
<span class=k>if</span> <span class=n>var_0c</span> <span class=o>&lt;=</span> <span class=mi>8</span><span class=p>:</span>
    <span class=o>...</span> <span class=c1># jbe è·³è½¬æ‰§è¡Œ</span>
</code></pre></td></tr></table>
</div>
</div><p><img src=/blog/image/crackme-02/cm02-easy-10.png loading=lazy alt=image-20210914223919137></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œå½“ <code>var_0c</code> å°äº 8 æ—¶ï¼Œæç¤º <code>username less than 8 letter</code> ã€‚å› æ­¤å¯ä»¥ç¡®å®š <code>[ebp-0Ch]</code> è¿™ä¸ªå˜é‡å°±æ˜¯ <code>username</code> å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œä¸Šä¸€ä¸ªå‡½æ•°ä¼šè®¡ç®—å­—ç¬¦ä¸²é•¿åº¦è¿”å›ã€‚æˆ‘ä»¬å†æ ¹æ®è¿™ä¸ªå‘ç°ä¿®æ”¹ä¸‹ä¼ªä»£ç ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=n>var</span> <span class=n>var_8</span> <span class=c1># åç§»å€¼ ebp-8h</span>
<span class=n>var</span> <span class=n>username_len</span> <span class=c1># åç§»å€¼ ebp-0Ch</span>
<span class=n>var</span> <span class=n>var_18</span> <span class=c1># åç§»å€¼ ebp-18h</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&#34;username:&#34;</span><span class=p>)</span>
<span class=n>var_18</span> <span class=o>=</span> <span class=n>unknown_func1</span><span class=p>(</span><span class=o>&amp;</span><span class=n>var_8</span><span class=p>,</span><span class=o>&amp;</span><span class=n>username_len</span><span class=p>,</span><span class=n>stdin</span><span class=p>)</span> <span class=c1># var_8 å¯èƒ½æ˜¯ username æŒ‡é’ˆ</span>
<span class=n>username_len</span> <span class=o>=</span> <span class=n>unknown_func2</span><span class=p>(</span><span class=n>var_8</span><span class=p>,</span> <span class=n>var_18</span><span class=p>)</span> <span class=c1># è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦</span>
<span class=k>if</span> <span class=n>username_len</span> <span class=o>&lt;=</span> <span class=mi>8</span><span class=p>:</span>
    <span class=o>...</span> <span class=c1># jbe è·³è½¬æ‰§è¡Œ</span>
<span class=k>else</span><span class=p>:</span>
    <span class=c1># jmp åˆ°å¼€å¤´</span>

</code></pre></td></tr></table>
</div>
</div><p>ç¬¬ä¸€ä¸ªæœªçŸ¥å‡½æ•°çœ‹èµ·æ¥å·²ç»å‘¼ä¹‹æ¬²å‡ºäº†ï¼Œ<code>stdin</code>å’Œ<code>&username_len</code>ä½œä¸ºå‚æ•°ï¼Œ<code>var_8</code> æœ‰æå¤§å¯èƒ½å°±æ˜¯<code>username</code>å­—ç¬¦ä¸²æŒ‡é’ˆã€‚ä¸è¿‡åœ¨è¿›å…¥è°ƒè¯•å™¨å‰ï¼Œè¿˜ä¸èƒ½é©¬ä¸Šä¸‹ç»“è®ºï¼Œç»§ç»­çœ‹æ­£ç¡®è·³è½¬çš„ä»£ç ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=nf>cmp</span> <span class=p>[</span><span class=no>ebp-0Ch</span><span class=p>],</span> <span class=mi>0</span>
<span class=nf>jnz</span> <span class=no>...</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™æ¬¡æ˜¯æ¯”è¾ƒç”¨æˆ·åé•¿åº¦å’Œ0ï¼Œé0è·³è½¬ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-11.png loading=lazy alt=image-20210914224625891></p>
<p>å¯ä»¥çœ‹åˆ°ä¸ºé›¶æ—¶ï¼Œç»è¿‡ä¸€ä¸ªæœªçŸ¥å‡½æ•° <code>sub_4036FC(var_8)</code> åï¼Œè·³å›å¼€å¤´ã€‚</p>
<p>ç»§ç»­çœ‹æ­£ç¡®æµç¨‹ï¼Œ<code>jmp $+5</code> ï¼Œ<code>$</code> è¡¨ç¤ºå½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»£ç åœ¨ä»£ç æ®µå†…çš„åç§»é‡ï¼Œ+5å°±æ˜¯ä»å½“å‰ä»£ç å¼€å§‹å¾€åè·³è¿‡5ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹IDAåˆ†æå¥½çš„è·³è½¬ä½ç½®ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-12.png loading=lazy alt=image-20210914225052452></p>
<p>åˆæ˜¯éå¸¸ç†Ÿæ‚‰çš„ä»£ç ï¼Œå’Œè¯»å– <code>username</code> çš„åˆ†ææ–¹å¼ç›¸åŒï¼Œä»¥ç›¸åŒçš„é¡ºåºè°ƒç”¨ç›¸åŒçš„å‡½æ•°ï¼Œå¯ä»¥å¾—åˆ°<code>var_14</code>æ˜¯<code>serial_len</code>ï¼Œ<code>Str1</code>å¯èƒ½æ˜¯<code>serial</code>å­—ç¬¦ä¸²æŒ‡é’ˆã€‚ä¸åšé‡å¤åˆ†æï¼Œç»§ç»­å¾€ä¸‹çœ‹ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-13.png loading=lazy alt=image-20210914225322787></p>
<p>å³è¾¹çš„ä»£ç å—æ˜¯å…³äºé•¿åº¦çš„åˆ¤æ–­ï¼Œåˆ†ææ–¹æ³•ä¸å†é‡å¤ã€‚å·¦ä¾§ä»£ç å°±æ˜¯æˆ‘ä»¬çš„å…³é”®è·³è½¬äº†ï¼Œå…¶ä¸­å‡ºç°ä¸¤ä¸ªå‡½æ•°è°ƒç”¨ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=nf>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=p>[</span><span class=no>ebp</span><span class=err>+</span><span class=no>var_C</span><span class=p>]</span>
<span class=nf>mov</span>     <span class=no>ecx</span><span class=p>,</span> <span class=p>[</span><span class=no>ebp</span><span class=err>+</span><span class=no>Block</span><span class=p>]</span>
<span class=nf>mov</span>     <span class=p>[</span><span class=no>esp</span><span class=err>+</span><span class=mi>2</span><span class=no>Ch</span><span class=err>+</span><span class=no>Ix</span><span class=p>],</span> <span class=no>ecx</span> <span class=c>; void *
</span><span class=c></span><span class=no>mov</span>     <span class=p>[</span><span class=no>esp</span><span class=err>+</span><span class=mi>2</span><span class=no>Ch</span><span class=err>+</span><span class=no>Str2</span><span class=p>],</span> <span class=no>eax</span> <span class=c>; size_t
</span><span class=c></span><span class=no>call</span>    <span class=no>sub_401250</span>
<span class=nf>mov</span>     <span class=p>[</span><span class=no>ebp</span><span class=err>+</span><span class=no>var_1C</span><span class=p>],</span> <span class=no>eax</span>
</code></pre></td></tr></table>
</div>
</div><p><code>var_c</code>å…ˆå‰è¢«åˆ¤æ–­æ˜¯<code>username_len</code>ï¼Œ<code>Block</code>å°±æ˜¯<code>var_8</code>ï¼Œå…ˆå‰è¢«æ€€ç–‘æ˜¯ç”¨æˆ·é”®å…¥çš„ç”¨æˆ·åå­—ç¬¦ä¸²æŒ‡é’ˆã€‚æœªçŸ¥å‡½æ•°çš„è¿”å›å€¼ä¿å­˜åœ¨ <code>[ebp-1ch]</code>ä¸­ã€‚</p>
<p>è¿™ä¸ª<code>1c</code>åœ¨éšåçš„ä»£ç ä¸­ç«‹åˆ»è¢«ç”¨åˆ°ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=nf>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=p>[</span><span class=no>ebp</span><span class=err>+</span><span class=no>var_1C</span><span class=p>]</span>
<span class=nf>mov</span>     <span class=no>ecx</span><span class=p>,</span> <span class=p>[</span><span class=no>ebp</span><span class=err>+</span><span class=no>Str1</span><span class=p>]</span>
<span class=nf>mov</span>     <span class=p>[</span><span class=no>esp</span><span class=err>+</span><span class=mi>2</span><span class=no>Ch</span><span class=err>+</span><span class=no>Ix</span><span class=p>],</span> <span class=no>ecx</span> <span class=c>; Str1
</span><span class=c></span><span class=no>mov</span>     <span class=p>[</span><span class=no>esp</span><span class=err>+</span><span class=mi>2</span><span class=no>Ch</span><span class=err>+</span><span class=no>Str2</span><span class=p>],</span> <span class=no>eax</span> <span class=c>; Str2
</span><span class=c></span><span class=no>mov</span>     <span class=p>[</span><span class=no>esp</span><span class=err>+</span><span class=mi>2</span><span class=no>Ch</span><span class=err>+</span><span class=no>MaxCount</span><span class=p>],</span> <span class=mi>10</span><span class=no>h</span> <span class=c>; MaxCount
</span><span class=c></span><span class=no>call</span>    <span class=no>_strncmp</span>
<span class=nf>mov</span>     <span class=p>[</span><span class=no>ebp</span><span class=err>+</span><span class=no>var_20</span><span class=p>],</span> <span class=no>eax</span>
</code></pre></td></tr></table>
</div>
</div><p><code>Str1</code>åœ¨<code>serial</code>è¾“å…¥è¿™ä¸€æ­¥è¢«æ€€ç–‘æ˜¯ç”¨æˆ·è¾“å…¥çš„åºåˆ—å·å­—ç¬¦ä¸²æŒ‡é’ˆï¼Œå®ƒå’Œä¸Šä¸€ä¸ªå‡½æ•°è°ƒç”¨è¿”å›çš„<code>var_1c</code>è¢«ä½œä¸ºå‚æ•°ä¼ é€’ç»™<code>strncmp</code>ï¼Œå­—ç¬¦ä¸²é•¿åº¦æœ€å¤§16å­—èŠ‚ã€‚ç”±æ­¤å¯è§ï¼Œ<code>var_1c</code>åŸºæœ¬å¯ä»¥ç¡®å®šæ˜¯æ­£ç¡®åºåˆ—å·çš„æŒ‡é’ˆï¼Œä¹‹å‰çš„æœªçŸ¥å‡½æ•°å¯èƒ½å°±æ˜¯ç”Ÿæˆåºåˆ—å·çš„å‡½æ•°ã€‚</p>
<p>ä¸‹ä¸€æ­¥åˆ†æåºåˆ—å·ç”Ÿæˆå‡½æ•°ã€‚</p>
<h3 id=32-ç”Ÿæˆåºåˆ—å·>3.2 ç”Ÿæˆåºåˆ—å·</h3>
<p>å…ˆçœ‹ä¸‹æ§åˆ¶æµå…¨è§ˆï¼Œèƒ½ä¾ç¨€åˆ†è¾¨å‡ºä¸‰ä¸ªå¾ªç¯ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-14.png loading=lazy alt=generate></p>
<p>è‡ªåŠ¨åˆ†æå‡ºçš„å˜é‡è¡¨</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=c>; var uint32_t var_1ch @ ebp-0x1c
</span><span class=c>; var int32_t var_18h @ ebp-0x18
</span><span class=c>; var int32_t var_14h @ ebp-0x14
</span><span class=c>; var uint32_t var_10h @ ebp-0x10
</span><span class=c>; var uint32_t var_ch @ ebp-0xc
</span><span class=c>; var int32_t var_8h @ ebp-0x8
</span><span class=c>; var int32_t var_4h @ ebp-0x4
</span><span class=c>; arg uint32_t arg_8h @ ebp+0x8
</span><span class=c>; arg int32_t arg_ch @ ebp+0xc
</span><span class=c>; var int32_t var_sp_4h @ esp+0x4
</span><span class=c>; var int32_t var_sp_8h @ esp+0x8
</span><span class=c>; var int32_t var_sp_ch @ esp+0xc
</span></code></pre></td></tr></table>
</div>
</div><p>å…ˆçœ‹å¾ªç¯å¤–çš„ä»£ç ï¼Œç®€å•æŒ‰ç”¨é€”åˆ’ä¸€ä¸‹åˆ†éš”çº¿ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=err>0</span><span class=nf>x004071f0</span>      <span class=no>push</span>    <span class=no>ebp</span>
<span class=err>0</span><span class=nf>x004071f1</span>      <span class=no>mov</span>     <span class=no>ebp</span><span class=p>,</span> <span class=no>esp</span>
<span class=err>0</span><span class=nf>x004071f3</span>      <span class=no>sub</span>     <span class=no>esp</span><span class=p>,</span> <span class=mi>0x2c</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x004071f6</span>      <span class=no>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>arg_ch</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x004071f9</span>      <span class=no>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>arg_8h</span><span class=p>]</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x004071fc</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_4h</span><span class=p>],</span> <span class=mi>8</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x00407203</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>esp</span><span class=p>],</span> <span class=mi>8</span>
<span class=err>0</span><span class=nf>x0040720a</span>      <span class=no>call</span>    <span class=no>fcn.00401302</span>
<span class=err>0</span><span class=nf>x0040720f</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_8h</span><span class=p>],</span> <span class=no>eax</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x00407212</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_ch</span><span class=p>],</span> <span class=mi>0</span>
</code></pre></td></tr></table>
</div>
</div><p>å¼€å¤´æ˜¯æƒ¯ä¾‹çš„ä¸¤å¥æ ˆå¸§å‡†å¤‡åŠ¨ä½œï¼Œéšåå¼€è¾Ÿ 0x2c å¤§å°çš„æ ˆç©ºé—´ã€‚</p>
<p>ä¸¤ä¸ªæ²¡ç”¨çš„ <code>mov eax,...</code>ï¼Œä¹‹åæ˜¯<code>[ebp-4h]</code>è®¾ç½®ä¸º8ï¼Œå†æŠŠ8ä½œä¸ºå‚æ•°è°ƒç”¨äº†ä¸€ä¸ªæœªçŸ¥å‡½æ•°ï¼Œè¿”å›å€¼èµ‹å€¼ç»™<code>[ebp-8h]</code>ï¼Œå†åˆå§‹åŒ–<code>[ebp-ch]</code>ä¸º 0ã€‚ä¼ªä»£ç è¡¨ç¤ºå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=kt>int</span> <span class=n>var_4h</span><span class=p>,</span> <span class=n>var_8h</span><span class=err>ï¼Œ</span> <span class=n>var_ch</span><span class=p>;</span> <span class=c1>// ebp-4h, ebp-8h, ebp-ch
</span><span class=c1></span><span class=n>var_4h</span> <span class=o>=</span> <span class=mh>0x8</span><span class=p>;</span>
<span class=n>var_8h</span> <span class=o>=</span> <span class=n>unknown_func</span><span class=p>(</span><span class=mh>0x8</span><span class=p>);</span>
<span class=n>var_ch</span> <span class=o>=</span> <span class=mh>0x0</span><span class=p>;</span>
</code></pre></td></tr></table>
</div>
</div><p>ç„¶åæ˜¯ä¸€ä¸ªæ¡ä»¶è·³è½¬ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=err>0</span><span class=nf>x00407219</span>      <span class=no>cmp</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_ch</span><span class=p>],</span> <span class=mi>8</span>
<span class=err>0</span><span class=nf>x0040721d</span>      <span class=no>jae</span>     <span class=mi>0x407242</span>
</code></pre></td></tr></table>
</div>
</div><p>å­¦ä¹ ä¸‹<code>jae</code>æŒ‡ä»¤ã€‚<code>jae</code>æŒ‡ä»¤å’Œ<code>jnc</code>æŒ‡ä»¤ç›¸åŒï¼Œ<code>CF=0</code>åˆ™è·³è½¬ã€‚<code>jae</code> å¯ä»¥çœ‹ä½œ <em>Jump if above or equals</em>ã€‚ä¸Šä¸€å¥ <code>cmp</code> è®¡ç®— <code>var_ch - 0x8</code> ï¼Œå¯¹ç›¸å…³æ ‡å¿—ä½èµ‹å€¼ã€‚<code>jae</code>æŒ‡ä»¤æ ¹æ®<code>CF</code>æ ‡å¿—ä½åˆ¤æ–­ï¼Œç”±äº<code>cmp</code>æŒ‡ä»¤æ˜¯å‡æ³•ï¼Œæ‰€ä»¥åˆ¤æ–­çš„æ˜¯å‡æ³•ä¸­æœ‰æ²¡æœ‰å‡ºç° <em>å€Ÿä½</em> ã€‚</p>
<p>ç®€å•çš„æè¿°å°±æ˜¯ï¼Œ<code>cmp ax, bx</code>ï¼Œå¦‚æœ<code>ax &lt; bx</code> åˆ™ <code>CF=1</code>ï¼Œå¦‚æœ <code>ax >= bx</code> åˆ™ <code>CF=0</code>ã€‚</p>
<p>å› ä¸ºæˆ‘ä»¬çŸ¥é“ <code>var_ch</code> åˆšè¢«åˆå§‹åŒ–æˆäº†0ï¼Œä¸æˆç«‹ï¼Œç»§ç»­çœ‹ä¸æˆç«‹çš„åˆ†æ”¯ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=err>0</span><span class=nf>x00407223</span>      <span class=no>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_ch</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x00407226</span>      <span class=no>add</span>     <span class=no>eax</span><span class=p>,</span> <span class=mi>0x52</span>  <span class=c>; 82
</span><span class=c></span><span class=mi>0x00407229</span>      <span class=no>mov</span>     <span class=no>dl</span><span class=p>,</span> <span class=no>al</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x0040722b</span>      <span class=no>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_8h</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x0040722e</span>      <span class=no>mov</span>     <span class=no>ecx</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_ch</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x00407231</span>      <span class=no>mov</span>     <span class=no>byte</span> <span class=p>[</span><span class=no>eax</span> <span class=err>+</span> <span class=no>ecx</span><span class=p>],</span> <span class=no>dl</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x00407234</span>      <span class=no>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_ch</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x00407237</span>      <span class=no>add</span>     <span class=no>eax</span><span class=p>,</span> <span class=mi>1</span>
<span class=err>0</span><span class=nf>x0040723a</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_ch</span><span class=p>],</span> <span class=no>eax</span>
<span class=err>0</span><span class=nf>x0040723d</span>      <span class=no>jmp</span>     <span class=mi>0x407219</span>
</code></pre></td></tr></table>
</div>
</div><p>æŠŠ<code>var_ch</code>ç§»å…¥å¯„å­˜å™¨<code>eax</code>åï¼ŒåŠ ä¸Š<code>0x52</code>ï¼Œåˆç§»åŠ¨<code>al</code>åˆ°<code>dl</code>ã€‚åç»­<code>eax</code>è¢«ç”¨ä½œåˆ«çš„ç”¨é€”ï¼Œè¿™ä¸€ç•ªæ“ä½œå…¶å®å°±æ˜¯ç»™<code>dl</code>èµ‹å€¼äº†ä¸€ä¸ª<code>(int16_t)0x52+var_ch</code>ã€‚</p>
<p>éšåæŠŠ<code>var_8h</code>å’Œ<code>var_ch</code>ç›¸åŠ åçš„åœ°å€èµ‹å€¼ <code>dl</code>ï¼Œä¹Ÿå°±æ˜¯<code>0x52</code>ã€‚</p>
<p>æ¥ç€<code>var_ch</code>è‡ªå¢1ï¼Œè·³å› <code>jae</code>åˆ¤æ–­å‰çš„ <code>cmp</code>ï¼Œå½¢æˆå¾ªç¯ï¼Œæˆ‘ä»¬ç”¨ä¼ªä»£ç è¡¨ç¤ºã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=kt>int</span> <span class=n>var_4h</span><span class=p>,</span> <span class=n>var_8h</span><span class=err>ï¼Œ</span> <span class=n>var_ch</span><span class=p>;</span> <span class=c1>// ebp-4h, ebp-8h, ebp-ch
</span><span class=c1></span><span class=n>var_4h</span> <span class=o>=</span> <span class=mh>0x8</span><span class=p>;</span>
<span class=n>var_8h</span> <span class=o>=</span> <span class=n>unknown_func</span><span class=p>(</span><span class=mh>0x8</span><span class=p>);</span>
<span class=n>var_ch</span> <span class=o>=</span> <span class=mh>0x0</span><span class=p>;</span>
<span class=k>while</span><span class=p>(</span><span class=n>var_ch</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=p>{</span>
    <span class=o>*</span><span class=p>(</span><span class=n>var_8h</span> <span class=o>+</span> <span class=n>var_ch</span><span class=p>)</span> <span class=o>=</span> <span class=mh>0x52</span> <span class=o>+</span> <span class=n>var_ch</span><span class=p>;</span>
    <span class=n>var_ch</span><span class=o>++</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>ä»ç»“æ„ä¸Šçœ‹ï¼Œæ˜¯ä¸€ä¸ªå…¸å‹çš„ for å¾ªç¯ã€‚ <code>var_8h</code> æ˜¯ä¸€ä¸ªæœªçŸ¥å‡½æ•°è¿”å›çš„æŒ‡é’ˆã€‚æˆ‘ä»¬ç¨å¾®æ”¹ä¸‹ä¼ªä»£ç ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=kt>int</span> <span class=n>var_4h</span><span class=p>,</span> <span class=n>var_8h</span><span class=p>;</span> <span class=c1>// ebp-4h, ebp-8h
</span><span class=c1></span><span class=n>var_4h</span> <span class=o>=</span> <span class=mh>0x8</span><span class=p>;</span>
<span class=n>var_8h</span> <span class=o>=</span> <span class=n>unknown_func</span><span class=p>(</span><span class=mh>0x8</span><span class=p>);</span>

<span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>var_ch</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=n>var_ch</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=n>var_ch</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// var_ch -&gt; ebp-ch
</span><span class=c1></span>    <span class=n>var_8h</span><span class=p>[</span><span class=n>var_ch</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x52</span> <span class=o>+</span> <span class=n>var_ch</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>æ¥ç€ç»§ç»­çœ‹å¾ªç¯ç»“æŸåçš„ä»£ç ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=err>0</span><span class=nf>x00407242</span>      <span class=no>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>arg_ch</span><span class=p>]</span> <span class=c>; ebp+ch å‡½æ•°å³å¾€å·¦æ•°ç¬¬äºŒä¸ªå…¥å‚
</span><span class=c></span><span class=mi>0x00407245</span>      <span class=no>mov</span>     <span class=no>ecx</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>arg_8h</span><span class=p>]</span> <span class=c>; ebp+8h å‡½æ•°å³å¾€å·¦æ•°ç¬¬ä¸€ä¸ªå…¥å‚
</span><span class=c></span><span class=mi>0x00407248</span>      <span class=no>mov</span>     <span class=no>edx</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_8h</span><span class=p>]</span> <span class=c>; ebp-8h
</span><span class=c>; ---
</span><span class=c></span><span class=mi>0x0040724b</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>esp</span><span class=p>],</span> <span class=no>edx</span>
<span class=err>0</span><span class=nf>x0040724e</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_sp_4h</span><span class=p>],</span> <span class=mi>8</span>
<span class=err>0</span><span class=nf>x00407256</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_sp_8h</span><span class=p>],</span> <span class=no>ecx</span>
<span class=err>0</span><span class=nf>x0040725a</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_sp_ch</span><span class=p>],</span> <span class=no>eax</span>
<span class=err>0</span><span class=nf>x0040725e</span>      <span class=no>call</span>    <span class=no>fcn.00407310</span>
<span class=err>0</span><span class=nf>x00407263</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_10h</span><span class=p>],</span> <span class=mi>0</span>
</code></pre></td></tr></table>
</div>
</div><p>ä»ä¹‹å‰åˆ†æä¸»å¾ªç¯çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç° <code>arg_8h</code> å…¶å®æ˜¯ç”¨æˆ·åå­—ç¬¦ä¸²æŒ‡é’ˆï¼Œ<code>arg_ch</code>æ˜¯ç”¨æˆ·åå­—ç¬¦ä¸²é•¿åº¦ã€‚</p>
<p>æ¥ç€è¿™ä¸¤ä¸ªå…¥å‚ï¼Œå’Œ <code>var_8h</code>ï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰å¾—åˆ°æŒ‡é’ˆï¼Œä¼ å…¥ä¸€ä¸ªæœªçŸ¥å‡½æ•°ï¼Œéšåå†åˆå§‹åŒ–äº†ä¸€ä¸ªå˜é‡ <code>var_10h</code>ã€‚</p>
<p>ä¼ªä»£ç å¦‚ä¸‹ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=n>unknown_func</span><span class=p>(</span><span class=n>var_8h</span><span class=p>,</span> <span class=mh>0x8</span><span class=p>,</span> <span class=n>username</span><span class=p>,</span> <span class=n>username_len</span><span class=p>);</span> <span class=c1>// çŒœæµ‹çš„å‡½æ•°ç­¾å func(void*, int, void*, int)
</span><span class=c1></span><span class=kt>int</span> <span class=n>var_10h</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</code></pre></td></tr></table>
</div>
</div><p>æ¥ç€åˆæ˜¯ä¸€ä¸ªæ¡ä»¶è·³è½¬ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=err>0</span><span class=nf>x0040726a</span>      <span class=no>cmp</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_10h</span><span class=p>],</span> <span class=mi>8</span>
<span class=err>0</span><span class=nf>x0040726e</span>      <span class=no>jae</span>     <span class=mi>0x407292</span>
</code></pre></td></tr></table>
</div>
</div><p>å’Œå…ˆå‰çš„å¾ªç¯ç›¸åŒï¼Œä¸ä½œé‡å¤åˆ†æï¼Œç›´æ¥è¿›å…¥å¾ªç¯ä½“ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=err>0</span><span class=nf>x00407274</span>      <span class=no>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_8h</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x00407277</span>      <span class=no>mov</span>     <span class=no>ecx</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_10h</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x0040727a</span>      <span class=no>movsx</span>   <span class=no>edx</span><span class=p>,</span> <span class=no>byte</span> <span class=p>[</span><span class=no>eax</span> <span class=err>+</span> <span class=no>ecx</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x0040727e</span>      <span class=no>xor</span>     <span class=no>edx</span><span class=p>,</span> <span class=mi>0x25</span>  <span class=c>; 37
</span><span class=c></span><span class=mi>0x00407281</span>      <span class=no>mov</span>     <span class=no>byte</span> <span class=p>[</span><span class=no>eax</span> <span class=err>+</span> <span class=no>ecx</span><span class=p>],</span> <span class=no>dl</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x00407284</span>      <span class=no>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_10h</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x00407287</span>      <span class=no>add</span>     <span class=no>eax</span><span class=p>,</span> <span class=mi>1</span>
<span class=err>0</span><span class=nf>x0040728a</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_10h</span><span class=p>],</span> <span class=no>eax</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x0040728d</span>      <span class=no>jmp</span>     <span class=mi>0x40726a</span>
</code></pre></td></tr></table>
</div>
</div><p>å‰ä¸¤æ¡æŒ‡ä»¤æ²¡ä»€ä¹ˆå¯è¯´çš„ï¼Œ<code>movsx</code>è¿˜æ˜¯ç¬¬ä¸€æ¬¡è§ï¼Œå­¦ä¹ ä¸‹ã€‚</p>
<p><code>movsx</code> ä»æ¥æºå–æ•°ï¼Œä¸è¶³çš„éƒ¨åˆ†ç”¨æ¥æºçš„ç¬¦å·ä½å¡«å……ï¼Œè¿™é‡Œå–çš„æ˜¯<code>var_8h[var_10h]</code>ï¼Œä¸€å­—èŠ‚ï¼Œåˆ° <code>edx</code> å¯„å­˜å™¨ã€‚<code>movsx</code>çš„å¥½å¤„æ˜¯å¯ä»¥ä¿ç•™ç¬¦å·ä½ï¼ŒåŠ è½½ä¸åŒå¤§å°çš„æ•°æ®æ—¶ï¼ˆæ¯”å¦‚æ¥æºæ˜¯ <code>word</code>ï¼Œç›®æ ‡æ˜¯ <code>dword</code>ï¼‰ï¼Œå¦‚æœæ¥æºæ˜¯è´Ÿæ•°ï¼Œåˆ™å¡«å……ç¬¦å·ä½å¯ä»¥æ­£ç¡®è¡¨ç¤ºè¡¥ç å½¢å¼è¡¨ç¤ºçš„è´Ÿæ•°ã€‚</p>
<p>ä»<code>var_8h[var_10h]</code>å–æ•°ç§»å…¥<code>edx</code> åï¼Œä¹‹åæ˜¯ä¸€å¥ç®€å•çš„ <code>xor</code>ï¼Œé€»è¾‘å¼‚æˆ–è¿ç®—ã€‚ä¹‹åå°†<code>xor</code>è¿ç®—ç»“æœå–ä½ä½1å­—èŠ‚ï¼ˆ<code>dl</code>å¯„å­˜å™¨ï¼‰ç§»å›<code>var_8h[var_10h]</code>ã€‚</p>
<p>ä¹‹åè‡ªå¢ï¼Œè·³è½¬å¾ªç¯ï¼Œå’Œä¹‹å‰çš„å¾ªç¯ä¸€æ ·ã€‚å°†åˆ†æè¿‡çš„éƒ¨åˆ†ç”¨ä¼ªä»£ç è¡¨ç¤ºå¦‚ä¸‹ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=kt>int</span> <span class=n>var_4h</span><span class=p>,</span> <span class=n>var_8h</span><span class=p>;</span> <span class=c1>// ebp-4h, ebp-8h
</span><span class=c1></span><span class=n>var_4h</span> <span class=o>=</span> <span class=mh>0x8</span><span class=p>;</span>
<span class=n>var_8h</span> <span class=o>=</span> <span class=n>unknown_func</span><span class=p>(</span><span class=mh>0x8</span><span class=p>);</span>

<span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>var_ch</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=n>var_ch</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=n>var_ch</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// var_ch -&gt; ebp-ch
</span><span class=c1></span>    <span class=n>var_8h</span><span class=p>[</span><span class=n>var_ch</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x52</span> <span class=o>+</span> <span class=n>var_ch</span><span class=p>;</span>
<span class=p>}</span>

<span class=n>unknown_func</span><span class=p>(</span><span class=n>var_8h</span><span class=p>,</span> <span class=mh>0x8</span><span class=p>,</span> <span class=n>username</span><span class=p>,</span> <span class=n>username_len</span><span class=p>);</span> <span class=c1>// çŒœæµ‹çš„å‡½æ•°ç­¾å func(void*, int, void*, int)
</span><span class=c1></span><span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>var_10h</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=n>var_10h</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=n>var_10h</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// var_10h -&gt; ebp-10h
</span><span class=c1></span>    <span class=n>var_8h</span><span class=p>[</span><span class=n>var_10h</span><span class=p>]</span> <span class=o>^=</span> <span class=mh>0x25</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>ç»§ç»­çœ‹å¾ªç¯ç»“æŸåçš„åŠ¨ä½œã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=err>0</span><span class=nf>x00407292</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_14h</span><span class=p>],</span> <span class=mi>0x11</span> <span class=c>; 17
</span><span class=c></span><span class=mi>0x00407299</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>esp</span><span class=p>],</span> <span class=mi>0x11</span> <span class=c>; [0x11:4]=-1 ; 17
</span><span class=c></span><span class=mi>0x004072a0</span>      <span class=no>call</span>    <span class=no>fcn.00401302</span>
<span class=err>0</span><span class=nf>x004072a5</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_18h</span><span class=p>],</span> <span class=no>eax</span>
<span class=err>0</span><span class=nf>x004072a8</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_1ch</span><span class=p>],</span> <span class=mi>0</span>
</code></pre></td></tr></table>
</div>
</div><p>è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›å€¼èµ‹å€¼ç»™<code>var_18h</code>ï¼ŒåŒæ—¶åˆå§‹åŒ–<code>var_1ch</code>ä¸º 0ã€‚ä¼ªä»£ç è¡¨ç¤ºå¦‚ä¸‹ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=kt>int</span> <span class=n>var_14h</span> <span class=o>=</span> <span class=mh>0x11</span><span class=p>;</span>
<span class=n>var_18h</span> <span class=o>=</span> <span class=n>unknown_func</span><span class=p>(</span><span class=mh>0x11</span><span class=p>);</span>
<span class=kt>int</span> <span class=n>var_1ch</span> <span class=o>=</span> <span class=mh>0x0</span><span class=p>;</span>
</code></pre></td></tr></table>
</div>
</div><p>æ¥ä¸‹æ¥åˆæ˜¯ä¸€ä¸ªå¾ªç¯ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=err>0</span><span class=nf>x004072af</span>      <span class=no>cmp</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_1ch</span><span class=p>],</span> <span class=mi>8</span>
<span class=err>0</span><span class=nf>x004072b3</span>      <span class=no>jae</span>     <span class=mi>0x4072f2</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸é‡å¤åˆ†æï¼Œè¿›å…¥å¾ªç¯ä½“ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=err>0</span><span class=nf>x004072b9</span>      <span class=no>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_8h</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x004072bc</span>      <span class=no>mov</span>     <span class=no>ecx</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_1ch</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x004072bf</span>      <span class=no>movsx</span>   <span class=no>eax</span><span class=p>,</span> <span class=no>byte</span> <span class=p>[</span><span class=no>eax</span> <span class=err>+</span> <span class=no>ecx</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x004072c3</span>      <span class=no>mov</span>     <span class=no>edx</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_18h</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x004072c6</span>      <span class=no>mov</span>     <span class=no>ecx</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_1ch</span><span class=p>]</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x004072c9</span>      <span class=no>shl</span>     <span class=no>ecx</span><span class=p>,</span> <span class=mi>1</span>
<span class=err>0</span><span class=nf>x004072cc</span>      <span class=no>add</span>     <span class=no>edx</span><span class=p>,</span> <span class=no>ecx</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x004072ce</span>      <span class=no>lea</span>     <span class=no>ecx</span><span class=p>,</span> <span class=no>str.02x</span> <span class=c>; 0x45de50ï¼Œå†…å®¹æ˜¯ %02x
</span><span class=c>; ---
</span><span class=c></span><span class=mi>0x004072d4</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>esp</span><span class=p>],</span> <span class=no>edx</span>
<span class=err>0</span><span class=nf>x004072d7</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_sp_4h</span><span class=p>],</span> <span class=no>ecx</span>
<span class=err>0</span><span class=nf>x004072db</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_sp_8h</span><span class=p>],</span> <span class=no>eax</span>
<span class=err>0</span><span class=nf>x004072df</span>      <span class=no>call</span>    <span class=no>fcn.00403dcd</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x004072e4</span>      <span class=no>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_1ch</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x004072e7</span>      <span class=no>add</span>     <span class=no>eax</span><span class=p>,</span> <span class=mi>1</span>
<span class=err>0</span><span class=nf>x004072ea</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>var_1ch</span><span class=p>],</span> <span class=no>eax</span>
<span class=err>0</span><span class=nf>x004072ed</span>      <span class=no>jmp</span>     <span class=mi>0x4072af</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¾ç„¶æ˜¯ä» <code>var_8h[var_1ch]</code> å–æ•°ï¼Œä¹‹åæŠŠ <code>var_18h</code> å’Œ <code>var_1ch</code> ä¹Ÿå–æ•°ï¼Œåˆ†åˆ«æ”¾åˆ° <code>eax</code>ã€<code>edx</code>ã€<code>ecx</code>ã€‚</p>
<p>æ¥ç€æ˜¯ä¸€ä¸ªæ²¡è§è¿‡çš„å‘½ä»¤ï¼Œ<code>shl</code>ï¼Œå­¦ä¹ ä¸‹ã€‚</p>
<p><code>shl</code>æ˜¯é€»è¾‘å·¦ç§»ï¼Œå’Œ c ä¸­çš„ <code>&lt;&lt;</code> è¿ç®—ç¬¦ä¸€æ ·ï¼Œä¸¤ä¸ªæ“ä½œæ•°ï¼Œå‘½ä»¤æ ¼å¼<code>shl å¯„å­˜å™¨,ç«‹å³æ•°</code>ã€‚</p>
<p>è¿™é‡Œåšçš„å°±æ˜¯ <code>ecx</code>ï¼Œä¹Ÿå°±æ˜¯ <code>var_1ch</code> çš„å€¼å·¦ç§»1ä½ï¼Œä¼—æ‰€å‘¨çŸ¥å·¦ç§»nä½å¯ä»¥çœ‹ä½œä¹˜ä¸Š2^n^ ï¼Œæ‰€ä»¥è¿™å¥ <code>shl</code> å…¶å®å°±æ˜¯ <code>var_1ch*2</code>ã€‚å·¦ç§»åç»“æœåŠ åˆ°äº†<code>edx</code>ï¼Œ<code>edx</code>æ˜¯<code>var_18h</code>ã€‚</p>
<p>ä¹‹åæ˜¯ä¸€ä¸ª<code>lea</code>ï¼ŒåŠ è½½åœ°å€ï¼Œå†…å®¹æ˜¯å¸¸é‡å­—ç¬¦ä¸² <code>%02x</code>ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª c æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚</p>
<p>æ¥ç€å‹æ ˆä¼ å‚ï¼Œè°ƒç”¨æœªçŸ¥å‡½æ•°ï¼Œç»“æœå¿½ç•¥ã€‚ä¼ªä»£ç è¡¨ç¤ºå¦‚ä¸‹ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=n>unknown_func</span><span class=p>(</span><span class=n>var_18h</span> <span class=o>+</span> <span class=n>var_1ch</span> <span class=o>*</span> <span class=mi>2</span><span class=p>,</span> <span class=s>&#34;%02x&#34;</span><span class=p>,</span> <span class=n>var_8h</span><span class=p>[</span><span class=n>var_1ch</span><span class=p>]);</span>
</code></pre></td></tr></table>
</div>
</div><p>éšåæ˜¯å˜é‡è‡ªå¢ï¼Œè·³è½¬å›å¾ªç¯å¼€å¤´ã€‚</p>
<p>æˆ‘ä»¬æŠŠåˆ†æå‡ºæ¥çš„ä¼ªä»£ç å†åˆå¹¶ä¸‹ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=kt>int</span> <span class=n>var_4h</span><span class=p>,</span> <span class=n>var_8h</span><span class=p>;</span> <span class=c1>// ebp-4h, ebp-8h
</span><span class=c1></span><span class=n>var_4h</span> <span class=o>=</span> <span class=mh>0x8</span><span class=p>;</span>
<span class=n>var_8h</span> <span class=o>=</span> <span class=n>unknown_func</span><span class=p>(</span><span class=mh>0x8</span><span class=p>);</span>

<span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>var_ch</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=n>var_ch</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=n>var_ch</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// var_ch -&gt; ebp-ch
</span><span class=c1></span>    <span class=n>var_8h</span><span class=p>[</span><span class=n>var_ch</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x52</span> <span class=o>+</span> <span class=n>var_ch</span><span class=p>;</span>
<span class=p>}</span>

<span class=n>unknown_func</span><span class=p>(</span><span class=n>var_8h</span><span class=p>,</span> <span class=mh>0x8</span><span class=p>,</span> <span class=n>username</span><span class=p>,</span> <span class=n>username_len</span><span class=p>);</span> <span class=c1>// çŒœæµ‹çš„å‡½æ•°ç­¾å func(void*, int, void*, int)
</span><span class=c1></span><span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>var_10h</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=n>var_10h</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=n>var_10h</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// var_10h -&gt; ebp-10h
</span><span class=c1></span>    <span class=n>var_8h</span><span class=p>[</span><span class=n>var_10h</span><span class=p>]</span> <span class=o>^=</span> <span class=mh>0x25</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=n>var_14h</span> <span class=o>=</span> <span class=mh>0x11</span><span class=p>;</span>
<span class=n>var_18h</span> <span class=o>=</span> <span class=n>unknown_func</span><span class=p>(</span><span class=mh>0x11</span><span class=p>);</span>
<span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>var_1ch</span> <span class=o>=</span> <span class=mh>0x0</span><span class=p>;</span> <span class=n>var_1ch</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=n>var_1ch</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>unknown_func</span><span class=p>(</span><span class=n>var_18h</span> <span class=o>+</span> <span class=n>var_1ch</span> <span class=o>*</span> <span class=mi>2</span><span class=p>,</span> <span class=s>&#34;%02x&#34;</span><span class=p>,</span> <span class=n>var_8h</span><span class=p>[</span><span class=n>var_1ch</span><span class=p>]);</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>æœ€åæ˜¯å¾ªç¯ç»“æŸåçš„ä»£ç ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=err>0</span><span class=nf>x004072f2</span>      <span class=no>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_18h</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x004072f5</span>      <span class=no>mov</span>     <span class=no>byte</span> <span class=p>[</span><span class=no>eax</span> <span class=err>+</span> <span class=mi>0x10</span><span class=p>],</span> <span class=mi>0</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x004072f9</span>      <span class=no>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_8h</span><span class=p>]</span>
<span class=err>0</span><span class=nf>x004072fc</span>      <span class=no>mov</span>     <span class=no>dword</span> <span class=p>[</span><span class=no>esp</span><span class=p>],</span> <span class=no>eax</span>
<span class=err>0</span><span class=nf>x004072ff</span>      <span class=no>call</span>    <span class=no>fcn.00402a36</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x00407304</span>      <span class=no>mov</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>dword</span> <span class=p>[</span><span class=no>var_18h</span><span class=p>]</span>
<span class=c>; ---
</span><span class=c></span><span class=err>0</span><span class=nf>x00407307</span>      <span class=no>add</span>     <span class=no>esp</span><span class=p>,</span> <span class=mi>0x2c</span>
<span class=err>0</span><span class=nf>x0040730a</span>      <span class=no>pop</span>     <span class=no>ebp</span>
<span class=err>0</span><span class=nf>x0040730b</span>      <span class=no>ret</span>
</code></pre></td></tr></table>
</div>
</div><p>é¦–å…ˆæ˜¯æŠŠ<code>var_18h[0x10]</code> çš„å€¼è®¾ä¸º0ã€‚</p>
<p>æ¥ç€<code>var_8h</code>åšå‚æ•°è°ƒæœªçŸ¥å‡½æ•°ã€‚</p>
<p>æŠŠ<code>var_18h</code>ç§»åˆ°<code>eax</code>ï¼Œä¹Ÿå°±æ˜¯<code>cdecl</code>çº¦å®šä¸‹çš„è¿”å›å€¼ä½ç½®ã€‚</p>
<p>æœ€åå¹³æ ˆï¼Œæ¢å¤<code>ebp</code>ï¼Œè¿”å›ï¼Œå‡½æ•°ç»“æŸã€‚æˆ‘ä»¬æŠŠæ‰€æœ‰å†…å®¹çš„ä¼ªä»£ç åˆå¹¶èµ·æ¥ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=kt>int</span> <span class=n>var_4h</span> <span class=o>=</span> <span class=mh>0x8</span><span class=p>;</span> <span class=c1>// ebp-4h
</span><span class=c1></span><span class=kt>void</span><span class=o>*</span> <span class=n>var_8h</span> <span class=o>=</span> <span class=n>unknown_func</span><span class=p>(</span><span class=mh>0x8</span><span class=p>);</span> <span class=c1>// ebp-8h
</span><span class=c1></span>
<span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>var_ch</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=n>var_ch</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=n>var_ch</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// var_ch -&gt; ebp-ch
</span><span class=c1></span>    <span class=n>var_8h</span><span class=p>[</span><span class=n>var_ch</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x52</span> <span class=o>+</span> <span class=n>var_ch</span><span class=p>;</span>
<span class=p>}</span>

<span class=n>unknown_func</span><span class=p>(</span><span class=n>var_8h</span><span class=p>,</span> <span class=mh>0x8</span><span class=p>,</span> <span class=n>username</span><span class=p>,</span> <span class=n>username_len</span><span class=p>);</span> <span class=c1>// çŒœæµ‹çš„å‡½æ•°ç­¾å func(void*, int, void*, int)
</span><span class=c1></span><span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>var_10h</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=n>var_10h</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=n>var_10h</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// var_10h -&gt; ebp-10h
</span><span class=c1></span>    <span class=n>var_8h</span><span class=p>[</span><span class=n>var_10h</span><span class=p>]</span> <span class=o>^=</span> <span class=mh>0x25</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=n>var_14h</span> <span class=o>=</span> <span class=mh>0x11</span><span class=p>;</span>
<span class=n>var_18h</span> <span class=o>=</span> <span class=n>unknown_func</span><span class=p>(</span><span class=mh>0x11</span><span class=p>);</span>
<span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>var_1ch</span> <span class=o>=</span> <span class=mh>0x0</span><span class=p>;</span> <span class=n>var_1ch</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=n>var_1ch</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>unknown_func</span><span class=p>(</span><span class=n>var_18h</span> <span class=o>+</span> <span class=n>var_1ch</span> <span class=o>*</span> <span class=mi>2</span><span class=p>,</span> <span class=s>&#34;%02x&#34;</span><span class=p>,</span> <span class=n>var_8h</span><span class=p>[</span><span class=n>var_1ch</span><span class=p>]);</span>
<span class=p>}</span>
<span class=n>var_18h</span><span class=p>[</span><span class=mh>0x10</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

<span class=n>unknown_func</span><span class=p>(</span><span class=n>var_8h</span><span class=p>);</span>
<span class=k>return</span> <span class=n>var_18h</span><span class=p>;</span>
</code></pre></td></tr></table>
</div>
</div><p>ä»è¿™æˆ‘ä»¬å·²ç»èƒ½çœ‹å‡ºå…·ä½“ç®—æ³•äº†ï¼ŒæœªçŸ¥å‡½æ•°å¯ä»¥çŒœæµ‹è°ƒè¯•çœ‹çœ‹ã€‚</p>
<h2 id=0x04-è°ƒè¯•å™¨---easy>0x04 è°ƒè¯•å™¨ - easy</h2>
<p>è°ƒè¯•çš„ç›®æ ‡æ˜¯ç¡®è®¤ç”Ÿæˆåºåˆ—å·çš„ç®—æ³•ï¼ŒæŠŠåˆ†æå‡ºçš„ä¼ªä»£ç ä¸­è¿˜ä¸æ¸…æ¥šç”¨é€”çš„æœªçŸ¥å‡½æ•°ï¼Œåˆ†æå‡ºä½œç”¨ã€‚</p>
<h3 id=41-x32dbg>4.1 x32dbg</h3>
<p>æ‰“å¼€è°ƒè¯•å™¨åï¼Œå…ˆæ‰¾åˆ°å…³é”®è·³ï¼Œåœ¨å·¥å…·æ ç‚¹å‡»å­—ç¬¦ä¸²å·¥å…·å›¾æ ‡ï¼Œåœ¨ä¸‹æ–¹æœç´¢æ è¾“å…¥<code>wrong pwd!</code></p>
<p><img src=/blog/image/crackme-02/cm02-easy-15.png loading=lazy alt=image-20210915140718400></p>
<p>è·³åˆ°å¼•ç”¨ä½ç½®ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-18.png loading=lazy alt=image-20210915111455604></p>
<p><img src=/blog/image/crackme-02/cm02-easy-19.png loading=lazy alt=image-20210915111621678></p>
<p>ä¹‹åå¯ä»¥æŒ‰gï¼Œè¿›å…¥æ§åˆ¶æµè§†å›¾ï¼Œä¸è¿‡è¿™ä¸ªæ§åˆ¶æµè§†å›¾æœ‰ç‚¹ä¸å¥½çœ‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥å‚è€ƒé™æ€åˆ†æä¸­çš„æ±‡ç¼–ï¼Œç›´æ¥æ‰¾åˆ°å‡½æ•°ï¼Œå¹¶åœ¨å…¥å£ä¸‹æ–­ç‚¹ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-20.png loading=lazy alt=image-20210915112358449></p>
<p>å°è¯•éšä¾¿è¾“å…¥ä¸€ç‚¹å†…å®¹ï¼Œè°ƒè¯•å™¨å‘½ä¸­ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-21.png loading=lazy alt=image-20210915112552389></p>
<p>æ¥ä¸‹æ¥å°±å¯ä»¥ç”¨å·¦ä¸Šè§’çš„å•æ­¥è°ƒè¯•äº†ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-22.png loading=lazy alt=image-20210915140939909></p>
<p>ä¸åšæ›´å¤šä»‹ç»ï¼Œæ±‡ç¼–çš„åˆ†æå·²ç»è¿›è¡Œè¿‡ä¸€æ¬¡ã€‚è¿™æ¬¡æˆ‘ä»¬æ‰¾åˆ°å¯¹è¾“å…¥ &ldquo;abc&rdquo; çš„æ­£ç¡®åºåˆ—å·ï¼Œå®Œæˆä¸€æ¬¡è§£å¯†ã€‚</p>
<p>åªéœ€è¦åœ¨æ–­ç‚¹å¤„ç‚¹å‡»<img src=/blog/image/crackme-02/cm02-easy-23.png loading=lazy alt=image-20210915141120060>æŒ‰é’®ï¼Œç„¶åè§‚å¯Ÿ<code>eax</code>å¯„å­˜å™¨ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-24.png loading=lazy alt=image-20210915141405302></p>
<p>æŠ„å‡ºæ¥ï¼ˆå±…ç„¶ä¸èƒ½å³é”®å¤åˆ¶åé¢çš„å­—ç¬¦ä¸²ï¼‰ï¼Œå†…å®¹æ˜¯<code>4447467073727d7c</code>ã€‚</p>
<p>æ¥ç€ç»§ç»­è¿è¡Œï¼Œå†æŠŠæŠ„å‡ºæ¥çš„ç­”æ¡ˆå¤åˆ¶è¿›å»çœ‹çœ‹ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-25.png loading=lazy alt=image-20210915141838395></p>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ‹¿åˆ°äº†ä¸€ä¸ªå¯ä»¥ç”¨çš„åºåˆ—å·ã€‚</p>
<h2 id=0x05-æ³¨å†Œæœº>0x05 æ³¨å†Œæœº</h2>
<h3 id=51-python-è„šæœ¬æ³¨å†Œæœº>5.1 Python è„šæœ¬æ³¨å†Œæœº</h3>
<p>å…ˆæŠŠå‰é¢çš„ä¼ªä»£ç è´´ä¸€ä¸‹ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=kt>int</span> <span class=n>var_4h</span> <span class=o>=</span> <span class=mh>0x8</span><span class=p>;</span> <span class=c1>// ebp-4h
</span><span class=c1></span><span class=kt>void</span><span class=o>*</span> <span class=n>var_8h</span> <span class=o>=</span> <span class=n>unknown_func</span><span class=p>(</span><span class=mh>0x8</span><span class=p>);</span> <span class=c1>// ebp-8h
</span><span class=c1></span>
<span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>var_ch</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=n>var_ch</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=n>var_ch</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// var_ch -&gt; ebp-ch
</span><span class=c1></span>    <span class=n>var_8h</span><span class=p>[</span><span class=n>var_ch</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x52</span> <span class=o>+</span> <span class=n>var_ch</span><span class=p>;</span>
<span class=p>}</span>

<span class=n>unknown_func</span><span class=p>(</span><span class=n>var_8h</span><span class=p>,</span> <span class=mh>0x8</span><span class=p>,</span> <span class=n>username</span><span class=p>,</span> <span class=n>username_len</span><span class=p>);</span> <span class=c1>// çŒœæµ‹çš„å‡½æ•°ç­¾å func(void*, int, void*, int)
</span><span class=c1></span><span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>var_10h</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=n>var_10h</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=n>var_10h</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// var_10h -&gt; ebp-10h
</span><span class=c1></span>    <span class=n>var_8h</span><span class=p>[</span><span class=n>var_10h</span><span class=p>]</span> <span class=o>^=</span> <span class=mh>0x25</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=n>var_14h</span> <span class=o>=</span> <span class=mh>0x11</span><span class=p>;</span>
<span class=n>var_18h</span> <span class=o>=</span> <span class=n>unknown_func</span><span class=p>(</span><span class=mh>0x11</span><span class=p>);</span>
<span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>var_1ch</span> <span class=o>=</span> <span class=mh>0x0</span><span class=p>;</span> <span class=n>var_1ch</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=n>var_1ch</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>unknown_func</span><span class=p>(</span><span class=n>var_18h</span> <span class=o>+</span> <span class=n>var_1ch</span> <span class=o>*</span> <span class=mi>2</span><span class=p>,</span> <span class=s>&#34;%02x&#34;</span><span class=p>,</span> <span class=n>var_8h</span><span class=p>[</span><span class=n>var_1ch</span><span class=p>]);</span>
<span class=p>}</span>
<span class=n>var_18h</span><span class=p>[</span><span class=mh>0x10</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

<span class=n>unknown_func</span><span class=p>(</span><span class=n>var_8h</span><span class=p>);</span>
<span class=k>return</span> <span class=n>var_18h</span><span class=p>;</span>
</code></pre></td></tr></table>
</div>
</div><p>é‡Œé¢çš„æœªçŸ¥å‡½æ•°ï¼ˆå¤±ç­–ï¼Œclangé»˜è®¤é™æ€é“¾æ¥äº†libcmtï¼Œå¾ˆå¤šåº“å‡½æ•°åœ¨x32dbgé‡Œè®¤ä¸å‡ºæ¥ï¼‰çŒœä¸€çŒœå§ã€‚</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=n>username</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;username:&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span>
<span class=n>username_len</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>username</span><span class=p>)</span>

<span class=n>var_4h</span> <span class=o>=</span> <span class=mi>8</span>
<span class=n>var_8h</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span>

<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>):</span>
    <span class=n>var_8h</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x52</span> <span class=o>+</span> <span class=n>i</span>

<span class=c1># è¿™é‡Œçš„æœªçŸ¥å‡½æ•°é€šè¿‡è°ƒè¯•å™¨å¯ä»¥çœ‹å‡ºï¼ŒæŠŠå…¥å‚å¤åˆ¶åˆ°äº† var_8h é‡Œ</span>
<span class=n>var_8h</span><span class=p>[:</span><span class=n>username_len</span><span class=p>]</span> <span class=o>=</span> <span class=n>username</span>

<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>):</span>
    <span class=n>var_8h</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^=</span> <span class=mh>0x25</span>

<span class=c1># for(int var_1ch = 0x0; var_1ch &lt; 8; var_1ch++) {</span>
<span class=c1>#     unknown_func(var_18h + var_1ch * 2, &#34;%02x&#34;, var_8h[var_1ch]);</span>
<span class=c1># }</span>
<span class=c1>#</span>
<span class=c1># æœ€åçš„é‚£ä¸ªå¾ªç¯ä¸­ï¼Œå‡½æ•°åˆ¤æ–­ä¸º sprintf æˆ–å…¶ä»–å•¥ï¼Œæ ¼å¼åŒ–æ˜ç¡®æ˜¯2ä½å°å†™16è¿›åˆ¶æ•°</span>
<span class=c1># å‰é¢çš„è®¡ç®—çœ‹ä½œæ˜¯ç®—åç§»ï¼Œä¸€ä¸ª var_8h çš„å­—èŠ‚å¯¹åº” 2 å­—èŠ‚16è¿›åˆ¶è¡¨ç¤ºï¼Œæ‰€ä»¥ var_18h åŠ ä¸Š NUL ä¸€å…±æ˜¯ 0x11 ä¹Ÿå°±æ˜¯ 17 ä¸ªå­—èŠ‚</span>
<span class=c1># å¾ªç¯çš„ä½œç”¨æ˜¯æŠŠ var_8h è¿™ä¸ªå­—èŠ‚æ•°ç»„è½¬æ¢æˆ16è¿›åˆ¶è¡¨ç¤ºçš„å­—ç¬¦ä¸²ã€‚</span>
<span class=c1>#</span>
<span class=c1># åœ¨ python é‡Œç”¨ hex() å°±è¡Œäº†ã€‚</span>
<span class=nb>print</span><span class=p>(</span><span class=n>var_8h</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œè„šæœ¬ï¼Œè¾“å…¥<code>abc</code>ï¼Œè¾“å‡º<code>4447467073727d7c</code>ï¼Œç¡®è®¤æ³¨å†Œæœºå¯ä»¥ç”Ÿæˆåºåˆ—å·ã€‚</p>
<h2 id=0x06-ä¿®æ”¹-exe>0x06 ä¿®æ”¹ exe</h2>
<h3 id=61-x32dbg-ä¿®æ”¹å…³é”®è·³>6.1 x32dbg ä¿®æ”¹å…³é”®è·³</h3>
<p>ç”¨è°ƒè¯•å™¨æ‰“å¼€åæ‰¾åˆ°å†³å®šserialæ˜¯å¦æ­£ç¡®çš„å…³é”®è·³è½¬ï¼Œå³é”®äºŒè¿›åˆ¶é€‰æ‹©ç”¨NOPå¡«å……ï¼Œç¡®è®¤å³å¯ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-26.png loading=lazy alt=image-20210915150907420></p>
<p>ä¿®æ”¹åæ•ˆæœå¦‚å›¾ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-27.png loading=lazy alt=image-20210915150953046></p>
<p>æ¥ç€æŠŠä¿®æ”¹åçš„exeä¿å­˜ä¸‹æ¥ï¼Œåœ¨æ–‡ä»¶èœå•é‡Œé€‰æ‹©è¡¥ä¸ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-28.png loading=lazy alt=image-20210915151220354></p>
<p>å…¨é€‰ï¼Œç‚¹ä¿®è¡¥æ–‡ä»¶ï¼Œé€‰æ‹©è·¯å¾„ä¿å­˜ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-29.png loading=lazy alt=image-20210915151322628></p>
<p>æˆ‘ä¿å­˜åœ¨<code>cm02-easy-patched.exe</code>ï¼Œæ¥ç€æˆ‘ä»¬è¯•è¯•è¿è¡Œã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-30.png loading=lazy alt=image-20210915151903611></p>
<p>é—æ†¾çš„æ˜¯è¢«x32dbgè¡¥ä¸åŠŸèƒ½å¯¼å‡ºçš„æ–‡ä»¶éœ€è¦ç®¡ç†å‘˜æƒé™è¿è¡Œï¼Œä¸ºäº†èƒ½æˆªåˆ°å›¾ï¼Œå›¾ä¸­ç”¨äº†åä¸º<code>sudo</code>çš„å·¥å…·å‘½ä»¤ï¼Œå¯ä»¥ç”¨<code>scoop install sudo</code>æ¥å®‰è£…<code>sudo</code>ï¼Œç‚¹å‡»å»<a class=link href=https://scoop.sh target=_blank rel=noopener>scoopé¦–é¡µ</a>ã€‚</p>
<h3 id=62-åç¼–è¯‘å™¨ä¿®æ”¹å…³é”®è·³>6.2 åç¼–è¯‘å™¨ä¿®æ”¹å…³é”®è·³</h3>
<p>ä»¥Cutterä¸ºä¾‹ï¼Œæ‰¾åˆ°<code>jne</code>æŒ‡ä»¤åï¼Œå³é”®ä¿®æ”¹ä¸º<code>nop</code>å³å¯ã€‚è®°å¾—å…ˆå¤‡ä»½ã€‚</p>
<p><img src=/blog/image/crackme-02/cm02-easy-31.png loading=lazy alt=image-20210915152428449></p>
<p><img src=/blog/image/crackme-02/cm02-easy-32.png loading=lazy alt=image-20210915152609774></p>
<p>ä¿®æ”¹åä¹Ÿèƒ½å®ç°å’Œx32å¯¼å‡ºä¸€æ ·çš„æ•ˆæœï¼Œè€Œä¸”ä¸ç”¨ç®¡ç†å‘˜æƒé™ã€‚</p>
<h2 id=ç»“è®º>ç»“è®º</h2>
<p>æ€»å¾—æœ‰ä¸ªç»“è®ºã€‚</p>
<p>è¿™æ¬¡é€†å‘åº”è¯¥èƒ½å¸®åŠ©å­¦åˆ°ä¸‹é¢çš„ä¸œè¥¿ï¼š</p>
<ul>
<li>æ ˆå¸§ç»“æ„å’Œå‡½æ•°è°ƒç”¨</li>
<li><code>cmp</code>æŒ‡ä»¤</li>
<li><code>jne</code>ã€<code>jbe</code>ã€<code>jnz</code>ã€<code>jae</code>æŒ‡ä»¤</li>
<li><code>movsx</code>æŒ‡ä»¤</li>
<li><code>shl</code>æŒ‡ä»¤</li>
</ul>
<p>åº“å‡½æ•°å› ä¸ºé™æ€é“¾æ¥çš„ç¼˜æ•…å·²ç»å˜æˆäº†æ–‡ä¸­çš„æœªçŸ¥å‡½æ•°ï¼Œé€ æˆäº†åˆ†æä¸Šçš„éšœç¢ã€‚è€å®è¯´å¦‚æœä¸æ˜¯è‡ªå·±å†™çš„æºç ï¼Œèƒ½ä¸èƒ½è¿™ä¹ˆé¡ºåˆ©é€†å‘å‡ºæ³¨å†Œæœºè¿˜çœŸä¸å¥½è¯´ã€‚</p>
<p>å¼€å¯ä¼˜åŒ–çš„ <em>normal</em> å’Œ <em>hard</em> éš¾åº¦å°±ä¸è¿›ä¸€æ­¥åˆ†æäº†ï¼Œæœ‰å…´è¶£å¯ä»¥çœ‹çœ‹ã€‚</p>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/blog/tags/%E6%B1%87%E7%BC%96/>æ±‡ç¼–</a>
<a href=/blog/tags/%E9%80%86%E5%90%91/>é€†å‘</a>
</section>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>ç›¸å…³æ–‡ç« </h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article class=has-image>
<a href=/blog/p/learning-packer-08/>
<div class=article-image>
<img src=/blog/p/learning-packer-08/cover.303a5ee85ad8275c094df5988adf0791_hu8b7651a2bda3b235d3ed49f67a1e20bd_99156_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post åŠ å£³åŸç†08ï¼šæ··æ·†æŠ€æœ¯å…¥é—¨" data-key=learning-packer-08 data-hash="md5-MDpe6FrYJ1wJTfWYit8HkQ==">
</div>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>åŠ å£³åŸç†08ï¼šæ··æ·†æŠ€æœ¯å…¥é—¨</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/blog/p/learning-packer-07/>
<div class=article-image>
<img src=/blog/p/learning-packer-07/cover.303a5ee85ad8275c094df5988adf0791_hu8b7651a2bda3b235d3ed49f67a1e20bd_99156_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post åŠ å£³åŸç†07 - èŠ±æŒ‡ä»¤å…¥é—¨" data-key=learning-packer-07 data-hash="md5-MDpe6FrYJ1wJTfWYit8HkQ==">
</div>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>åŠ å£³åŸç†07 - èŠ±æŒ‡ä»¤å…¥é—¨</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/blog/p/learning-packer-06/>
<div class=article-image>
<img src=/blog/p/learning-packer-06/cover.303a5ee85ad8275c094df5988adf0791_hu8b7651a2bda3b235d3ed49f67a1e20bd_99156_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post åŠ å£³åŸç†06ï¼šåè°ƒè¯•æŠ€æœ¯å…¥é—¨" data-key=learning-packer-06 data-hash="md5-MDpe6FrYJ1wJTfWYit8HkQ==">
</div>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>åŠ å£³åŸç†06ï¼šåè°ƒè¯•æŠ€æœ¯å…¥é—¨</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/blog/p/learning-packer-04-zlib-compression-packer-demo/>
<div class=article-image>
<img src=/blog/p/learning-packer-04-zlib-compression-packer-demo/cover.303a5ee85ad8275c094df5988adf0791_hu8b7651a2bda3b235d3ed49f67a1e20bd_99156_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post åŠ å£³åŸç†04 - zlibå‹ç¼©å£³æ¡ˆä¾‹" data-key=learning-packer-04-zlib-compression-packer-demo data-hash="md5-MDpe6FrYJ1wJTfWYit8HkQ==">
</div>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>åŠ å£³åŸç†04 - zlibå‹ç¼©å£³æ¡ˆä¾‹</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/blog/p/learning-packer-03-support-no-relocations/>
<div class=article-image>
<img src=/blog/p/learning-packer-03-support-no-relocations/cover.303a5ee85ad8275c094df5988adf0791_hu8b7651a2bda3b235d3ed49f67a1e20bd_99156_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post åŠ å£³åŸç†03 - æ”¯æŒæ²¡æœ‰é‡å®šä½çš„ç¨‹åº" data-key=learning-packer-03-support-no-relocations data-hash="md5-MDpe6FrYJ1wJTfWYit8HkQ==">
</div>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>åŠ å£³åŸç†03 - æ”¯æŒæ²¡æœ‰é‡å®šä½çš„ç¨‹åº</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<footer class=site-footer>
<section class=copyright>
&copy;
2021 -
2024 weakptr's ç¬”è®°
</section>
<section class=powerby>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡
ï¼Œç”± <a href=https://nnnewb.github.io/blog/>nnnewb</a> ä¿®æ”¹
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">ç›®å½•</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#å¾—æœ‰ä¸ªå‰è¨€>å¾—æœ‰ä¸ªå‰è¨€</a></li>
<li><a href=#0x01-æºç >0x01 æºç </a></li>
<li><a href=#0x02-è§‚å¯Ÿ>0x02 è§‚å¯Ÿ</a></li>
<li><a href=#0x03-é™æ€åˆ†æ---easy>0x03 é™æ€åˆ†æ - easy</a>
<ol>
<li><a href=#31-ä¸»å¾ªç¯>3.1 ä¸»å¾ªç¯</a></li>
<li><a href=#32-ç”Ÿæˆåºåˆ—å·>3.2 ç”Ÿæˆåºåˆ—å·</a></li>
</ol>
</li>
<li><a href=#0x04-è°ƒè¯•å™¨---easy>0x04 è°ƒè¯•å™¨ - easy</a>
<ol>
<li><a href=#41-x32dbg>4.1 x32dbg</a></li>
</ol>
</li>
<li><a href=#0x05-æ³¨å†Œæœº>0x05 æ³¨å†Œæœº</a>
<ol>
<li><a href=#51-python-è„šæœ¬æ³¨å†Œæœº>5.1 Python è„šæœ¬æ³¨å†Œæœº</a></li>
</ol>
</li>
<li><a href=#0x06-ä¿®æ”¹-exe>0x06 ä¿®æ”¹ exe</a>
<ol>
<li><a href=#61-x32dbg-ä¿®æ”¹å…³é”®è·³>6.1 x32dbg ä¿®æ”¹å…³é”®è·³</a></li>
<li><a href=#62-åç¼–è¯‘å™¨ä¿®æ”¹å…³é”®è·³>6.2 åç¼–è¯‘å™¨ä¿®æ”¹å…³é”®è·³</a></li>
</ol>
</li>
<li><a href=#ç»“è®º>ç»“è®º</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/blog/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>