<!doctype html><html lang=zh-cn dir=ltr>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="å‰è¨€ ä¼—æ‰€å‘¨çŸ¥ï¼ŒAPIç½‘å…³æ˜¯å¾®æœåŠ¡æ¶æ„çš„é‡è¦ç»„ä»¶ï¼Œèµ·åˆ°ä¸€ä¸ªæ•´æµè¿‡æ»¤çš„ä½œç”¨ã€‚è™½ç„¶ gRPC-Gateway è¦å•¥æ²¡å•¥ï¼Œå’Œ API ç½‘å…³çš„æ¨¡å¼ä¹Ÿæ‰¯ä¸ä¸Šå¤ªå¤šå…³ç³»ï¼Œä½†æ€»ä¹‹å…ˆèµ·ä¸ªé«˜è°ƒã€‚
ç„¶åå°±æ˜¯çœŸæ­£é‡åˆ°çš„é—®é¢˜äº†ã€‚åœ¨æ—§çš„æ¶æ„é‡Œï¼ŒgRPC-Gateway çš„ç”¨æ³•ï¼Œæ˜¯å¯¹æ¯ä¸ªéœ€è¦æš´éœ² HTTP æœåŠ¡çš„ gRPC æœåŠ¡éƒ½èµ·ä¸€ä¸ªå¯¹åº”çš„ gRPC-Gateway ã€‚æœ€æ—©çš„åšæ³•æ˜¯ gRPC-Gateway æœåŠ¡å•ç‹¬ä½œä¸ºä¸€ä¸ª POD ï¼ŒgRPC æœåŠ¡å®ç°ä¹Ÿå•ç‹¬ä¸€ä¸ª POD ã€‚åæ¥æˆ‘æ”¹æˆäº† Gateway å’Œ æœåŠ¡åœ¨åŒä¸€ä¸ª POD å†…ï¼Œèµ·ä¸¤ä¸ª container ã€‚
ä¹‹å‰çš„åšæ³•éƒ½å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ gRPC-Gateway è¦åˆ†é…å°‘é‡çš„ CPU å’Œå†…å­˜é…é¢ï¼Œè™½ç„¶æ¯ä¸ª gRPC-Gateway æœåŠ¡åˆ†åˆ°çš„å†…å­˜å’ŒCPUéƒ½å¾ˆå°‘ï¼Œä½†æ¶ä¸ä½æœåŠ¡å¤šï¼Œå†…å­˜å’Œ CPU çš„é…é¢éƒ½å ç”¨äº†ä¸å°‘ï¼Œå®é™…ç”¨åˆ°çš„å°‘å¾—å¯æ€œï¼Œå¤§éƒ¨åˆ†é…é¢éƒ½æ˜¯æµªè´¹ã€‚
ä¸‹é¢å…·ä½“åˆ†æä¸‹æ€ä¹ˆæŠŠ gateway å•ç‹¬æå–æˆä¸€ä¸ª PODï¼Œç»™æ‰€æœ‰ gRPC æœåŠ¡å½“ç½‘å…³ï¼ŒåŒæ—¶ä¿æŒè´Ÿè½½å‡è¡¡å‘æŒ¥ä½œç”¨ï¼Œæä¾›æ— ç¼æ‰©å®¹ã€‚
å®ç°ç½‘å…³ å®˜æ–¹demo // Create a client connection to the gRPC server we just started // This is where the gRPC-Gateway proxies the requests conn, err := grpc.DialContext( context."><title>gRPC-Gateway ç”¨ä½œå¤šä¸ª gRPC æœåŠ¡çš„ç½‘å…³</title>
<link rel=canonical href=https://nnnewb.github.io/blog/p/grpc-gateway-used-as-multiple-grpc-server-gateway/>
<link rel=stylesheet href=/blog/scss/style.min.b80bf249ce4a22cf55e8d7340a0b37a2f2c10f54f3a9a49cb94b694a2eb0bbea.css><meta property="og:title" content="gRPC-Gateway ç”¨ä½œå¤šä¸ª gRPC æœåŠ¡çš„ç½‘å…³">
<meta property="og:description" content="å‰è¨€ ä¼—æ‰€å‘¨çŸ¥ï¼ŒAPIç½‘å…³æ˜¯å¾®æœåŠ¡æ¶æ„çš„é‡è¦ç»„ä»¶ï¼Œèµ·åˆ°ä¸€ä¸ªæ•´æµè¿‡æ»¤çš„ä½œç”¨ã€‚è™½ç„¶ gRPC-Gateway è¦å•¥æ²¡å•¥ï¼Œå’Œ API ç½‘å…³çš„æ¨¡å¼ä¹Ÿæ‰¯ä¸ä¸Šå¤ªå¤šå…³ç³»ï¼Œä½†æ€»ä¹‹å…ˆèµ·ä¸ªé«˜è°ƒã€‚
ç„¶åå°±æ˜¯çœŸæ­£é‡åˆ°çš„é—®é¢˜äº†ã€‚åœ¨æ—§çš„æ¶æ„é‡Œï¼ŒgRPC-Gateway çš„ç”¨æ³•ï¼Œæ˜¯å¯¹æ¯ä¸ªéœ€è¦æš´éœ² HTTP æœåŠ¡çš„ gRPC æœåŠ¡éƒ½èµ·ä¸€ä¸ªå¯¹åº”çš„ gRPC-Gateway ã€‚æœ€æ—©çš„åšæ³•æ˜¯ gRPC-Gateway æœåŠ¡å•ç‹¬ä½œä¸ºä¸€ä¸ª POD ï¼ŒgRPC æœåŠ¡å®ç°ä¹Ÿå•ç‹¬ä¸€ä¸ª POD ã€‚åæ¥æˆ‘æ”¹æˆäº† Gateway å’Œ æœåŠ¡åœ¨åŒä¸€ä¸ª POD å†…ï¼Œèµ·ä¸¤ä¸ª container ã€‚
ä¹‹å‰çš„åšæ³•éƒ½å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ gRPC-Gateway è¦åˆ†é…å°‘é‡çš„ CPU å’Œå†…å­˜é…é¢ï¼Œè™½ç„¶æ¯ä¸ª gRPC-Gateway æœåŠ¡åˆ†åˆ°çš„å†…å­˜å’ŒCPUéƒ½å¾ˆå°‘ï¼Œä½†æ¶ä¸ä½æœåŠ¡å¤šï¼Œå†…å­˜å’Œ CPU çš„é…é¢éƒ½å ç”¨äº†ä¸å°‘ï¼Œå®é™…ç”¨åˆ°çš„å°‘å¾—å¯æ€œï¼Œå¤§éƒ¨åˆ†é…é¢éƒ½æ˜¯æµªè´¹ã€‚
ä¸‹é¢å…·ä½“åˆ†æä¸‹æ€ä¹ˆæŠŠ gateway å•ç‹¬æå–æˆä¸€ä¸ª PODï¼Œç»™æ‰€æœ‰ gRPC æœåŠ¡å½“ç½‘å…³ï¼ŒåŒæ—¶ä¿æŒè´Ÿè½½å‡è¡¡å‘æŒ¥ä½œç”¨ï¼Œæä¾›æ— ç¼æ‰©å®¹ã€‚
å®ç°ç½‘å…³ å®˜æ–¹demo // Create a client connection to the gRPC server we just started // This is where the gRPC-Gateway proxies the requests conn, err := grpc.DialContext( context.">
<meta property="og:url" content="https://nnnewb.github.io/blog/p/grpc-gateway-used-as-multiple-grpc-server-gateway/">
<meta property="og:site_name" content="weakptr's ç¬”è®°">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="golang"><meta property="article:tag" content="kubernetes"><meta property="article:tag" content="microservice"><meta property="article:published_time" content="2022-02-23T17:30:00+08:00"><meta property="article:modified_time" content="2022-02-23T17:30:00+08:00">
<meta name=twitter:title content="gRPC-Gateway ç”¨ä½œå¤šä¸ª gRPC æœåŠ¡çš„ç½‘å…³">
<meta name=twitter:description content="å‰è¨€ ä¼—æ‰€å‘¨çŸ¥ï¼ŒAPIç½‘å…³æ˜¯å¾®æœåŠ¡æ¶æ„çš„é‡è¦ç»„ä»¶ï¼Œèµ·åˆ°ä¸€ä¸ªæ•´æµè¿‡æ»¤çš„ä½œç”¨ã€‚è™½ç„¶ gRPC-Gateway è¦å•¥æ²¡å•¥ï¼Œå’Œ API ç½‘å…³çš„æ¨¡å¼ä¹Ÿæ‰¯ä¸ä¸Šå¤ªå¤šå…³ç³»ï¼Œä½†æ€»ä¹‹å…ˆèµ·ä¸ªé«˜è°ƒã€‚
ç„¶åå°±æ˜¯çœŸæ­£é‡åˆ°çš„é—®é¢˜äº†ã€‚åœ¨æ—§çš„æ¶æ„é‡Œï¼ŒgRPC-Gateway çš„ç”¨æ³•ï¼Œæ˜¯å¯¹æ¯ä¸ªéœ€è¦æš´éœ² HTTP æœåŠ¡çš„ gRPC æœåŠ¡éƒ½èµ·ä¸€ä¸ªå¯¹åº”çš„ gRPC-Gateway ã€‚æœ€æ—©çš„åšæ³•æ˜¯ gRPC-Gateway æœåŠ¡å•ç‹¬ä½œä¸ºä¸€ä¸ª POD ï¼ŒgRPC æœåŠ¡å®ç°ä¹Ÿå•ç‹¬ä¸€ä¸ª POD ã€‚åæ¥æˆ‘æ”¹æˆäº† Gateway å’Œ æœåŠ¡åœ¨åŒä¸€ä¸ª POD å†…ï¼Œèµ·ä¸¤ä¸ª container ã€‚
ä¹‹å‰çš„åšæ³•éƒ½å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ gRPC-Gateway è¦åˆ†é…å°‘é‡çš„ CPU å’Œå†…å­˜é…é¢ï¼Œè™½ç„¶æ¯ä¸ª gRPC-Gateway æœåŠ¡åˆ†åˆ°çš„å†…å­˜å’ŒCPUéƒ½å¾ˆå°‘ï¼Œä½†æ¶ä¸ä½æœåŠ¡å¤šï¼Œå†…å­˜å’Œ CPU çš„é…é¢éƒ½å ç”¨äº†ä¸å°‘ï¼Œå®é™…ç”¨åˆ°çš„å°‘å¾—å¯æ€œï¼Œå¤§éƒ¨åˆ†é…é¢éƒ½æ˜¯æµªè´¹ã€‚
ä¸‹é¢å…·ä½“åˆ†æä¸‹æ€ä¹ˆæŠŠ gateway å•ç‹¬æå–æˆä¸€ä¸ª PODï¼Œç»™æ‰€æœ‰ gRPC æœåŠ¡å½“ç½‘å…³ï¼ŒåŒæ—¶ä¿æŒè´Ÿè½½å‡è¡¡å‘æŒ¥ä½œç”¨ï¼Œæä¾›æ— ç¼æ‰©å®¹ã€‚
å®ç°ç½‘å…³ å®˜æ–¹demo // Create a client connection to the gRPC server we just started // This is where the gRPC-Gateway proxies the requests conn, err := grpc.DialContext( context.">
</head>
<body class=article-page>
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"dark")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky">
<button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box>
<span class=hamburger-inner></span>
</span>
</button>
<header>
<figure class=site-avatar>
<a href=/blog>
<img src=/blog/img/avatar_hub37949326d1692892aa1e64434c0dda6_382115_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a>
<span class=emoji>ğŸ‘</span>
</figure>
<div class=site-meta>
<h1 class=site-name><a href=/blog>weakptr's ç¬”è®°</a></h1>
<h2 class=site-description>å¼ƒèˆ¹ï¼</h2>
</div>
</header><ol class=menu id=main-menu>
<li>
<a href=/blog><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>é¦–é¡µ</span>
</a>
</li>
<li>
<a href=/blog/about><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>å…³äºæˆ‘</span>
</a>
</li>
<li>
<a href=/blog/archive><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>å½’æ¡£</span>
</a>
</li>
<li>
<a href=/blog/categories><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>åˆ†ç±»</span>
</a>
</li>
<div class=menu-bottom-section>
<li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span>
</li>
</div>
</ol>
</aside>
<main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/blog/categories/golang/>
golang
</a>
</header>
<div class=article-title-wrapper>
<h2 class=article-title>
<a href=/blog/p/grpc-gateway-used-as-multiple-grpc-server-gateway/>gRPC-Gateway ç”¨ä½œå¤šä¸ª gRPC æœåŠ¡çš„ç½‘å…³</a>
</h2>
</div>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2022å¹´ 2æœˆ 23æ—¥</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
é˜…è¯»æ—¶é•¿: 2 åˆ†é’Ÿ
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<h2 id=å‰è¨€>å‰è¨€</h2>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒAPIç½‘å…³æ˜¯å¾®æœåŠ¡æ¶æ„çš„é‡è¦ç»„ä»¶ï¼Œèµ·åˆ°ä¸€ä¸ªæ•´æµè¿‡æ»¤çš„ä½œç”¨ã€‚è™½ç„¶ gRPC-Gateway è¦å•¥æ²¡å•¥ï¼Œå’Œ API ç½‘å…³çš„æ¨¡å¼ä¹Ÿæ‰¯ä¸ä¸Šå¤ªå¤šå…³ç³»ï¼Œä½†æ€»ä¹‹å…ˆèµ·ä¸ªé«˜è°ƒã€‚</p>
<p>ç„¶åå°±æ˜¯çœŸæ­£é‡åˆ°çš„é—®é¢˜äº†ã€‚åœ¨æ—§çš„æ¶æ„é‡Œï¼ŒgRPC-Gateway çš„ç”¨æ³•ï¼Œæ˜¯å¯¹æ¯ä¸ªéœ€è¦æš´éœ² HTTP æœåŠ¡çš„ gRPC æœåŠ¡éƒ½èµ·ä¸€ä¸ªå¯¹åº”çš„ gRPC-Gateway ã€‚æœ€æ—©çš„åšæ³•æ˜¯ gRPC-Gateway æœåŠ¡å•ç‹¬ä½œä¸ºä¸€ä¸ª POD ï¼ŒgRPC æœåŠ¡å®ç°ä¹Ÿå•ç‹¬ä¸€ä¸ª POD ã€‚åæ¥æˆ‘æ”¹æˆäº† Gateway å’Œ æœåŠ¡åœ¨åŒä¸€ä¸ª POD å†…ï¼Œèµ·ä¸¤ä¸ª container ã€‚</p>
<p>ä¹‹å‰çš„åšæ³•éƒ½å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ gRPC-Gateway è¦åˆ†é…å°‘é‡çš„ CPU å’Œå†…å­˜é…é¢ï¼Œè™½ç„¶æ¯ä¸ª gRPC-Gateway æœåŠ¡åˆ†åˆ°çš„å†…å­˜å’ŒCPUéƒ½å¾ˆå°‘ï¼Œä½†æ¶ä¸ä½æœåŠ¡å¤šï¼Œå†…å­˜å’Œ CPU çš„é…é¢éƒ½å ç”¨äº†ä¸å°‘ï¼Œå®é™…ç”¨åˆ°çš„å°‘å¾—å¯æ€œï¼Œå¤§éƒ¨åˆ†é…é¢éƒ½æ˜¯æµªè´¹ã€‚</p>
<p>ä¸‹é¢å…·ä½“åˆ†æä¸‹æ€ä¹ˆæŠŠ gateway å•ç‹¬æå–æˆä¸€ä¸ª PODï¼Œç»™æ‰€æœ‰ gRPC æœåŠ¡å½“ç½‘å…³ï¼ŒåŒæ—¶ä¿æŒè´Ÿè½½å‡è¡¡å‘æŒ¥ä½œç”¨ï¼Œæä¾›æ— ç¼æ‰©å®¹ã€‚</p>
<h2 id=å®ç°ç½‘å…³>å®ç°ç½‘å…³</h2>
<h3 id=å®˜æ–¹demo>å®˜æ–¹demo</h3>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=c1>// Create a client connection to the gRPC server we just started
</span><span class=c1>// This is where the gRPC-Gateway proxies the requests
</span><span class=c1></span><span class=nx>conn</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>grpc</span><span class=p>.</span><span class=nf>DialContext</span><span class=p>(</span>
    <span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span>
    <span class=s>&#34;0.0.0.0:8080&#34;</span><span class=p>,</span>
    <span class=nx>grpc</span><span class=p>.</span><span class=nf>WithBlock</span><span class=p>(),</span>
    <span class=nx>grpc</span><span class=p>.</span><span class=nf>WithTransportCredentials</span><span class=p>(</span><span class=nx>insecure</span><span class=p>.</span><span class=nf>NewCredentials</span><span class=p>()),</span>
<span class=p>)</span>
<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
    <span class=nx>log</span><span class=p>.</span><span class=nf>Fatalln</span><span class=p>(</span><span class=s>&#34;Failed to dial server:&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
<span class=p>}</span>

<span class=nx>gwmux</span> <span class=o>:=</span> <span class=nx>runtime</span><span class=p>.</span><span class=nf>NewServeMux</span><span class=p>()</span>
<span class=c1>// Register Greeter
</span><span class=c1></span><span class=nx>err</span> <span class=p>=</span> <span class=nx>helloworldpb</span><span class=p>.</span><span class=nf>RegisterGreeterHandler</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span> <span class=nx>gwmux</span><span class=p>,</span> <span class=nx>conn</span><span class=p>)</span>
<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
    <span class=nx>log</span><span class=p>.</span><span class=nf>Fatalln</span><span class=p>(</span><span class=s>&#34;Failed to register gateway:&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
<span class=p>}</span>

<span class=nx>gwServer</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>http</span><span class=p>.</span><span class=nx>Server</span><span class=p>{</span>
    <span class=nx>Addr</span><span class=p>:</span>    <span class=s>&#34;:8090&#34;</span><span class=p>,</span>
    <span class=nx>Handler</span><span class=p>:</span> <span class=nx>gwmux</span><span class=p>,</span>
<span class=p>}</span>

<span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Serving gRPC-Gateway on http://0.0.0.0:8090&#34;</span><span class=p>)</span>
<span class=nx>log</span><span class=p>.</span><span class=nf>Fatalln</span><span class=p>(</span><span class=nx>gwServer</span><span class=p>.</span><span class=nf>ListenAndServe</span><span class=p>())</span>
</code></pre></div><p>æ ¸å¿ƒé€»è¾‘åœ¨è¿™ä¸¤è¡Œï¼š</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>gwmux</span> <span class=o>:=</span> <span class=nx>runtime</span><span class=p>.</span><span class=nf>NewServeMux</span><span class=p>()</span>
<span class=c1>// Register Greeter
</span><span class=c1></span><span class=nx>err</span> <span class=p>=</span> <span class=nx>helloworldpb</span><span class=p>.</span><span class=nf>RegisterGreeterHandler</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span> <span class=nx>gwmux</span><span class=p>,</span> <span class=nx>conn</span><span class=p>)</span>
<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
    <span class=nx>log</span><span class=p>.</span><span class=nf>Fatalln</span><span class=p>(</span><span class=s>&#34;Failed to register gateway:&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><p><code>gwmux</code>æ˜¯ gRPC-Gateway çš„è¿è¡Œæ—¶ <code>mux</code> å®ä¾‹ï¼Œå¯ä»¥ç†è§£æˆè·¯ç”±ã€‚ æ ‡å‡†åº“çš„ <code>http</code> åŒ…ä¹Ÿæœ‰è‡ªå·±çš„ <code>mux</code> ï¼Œä½† gRPC-Gateway é¡¹ç›®è‡ªå·±å®ç°äº†ä¸€ä¸ªã€‚çœ‹åˆ° <code>gwmux</code>åº”è¯¥å°±èƒ½æƒ³åˆ°è¿™è‚¯å®šæ˜¯æ³¨å†Œè·¯ç”±ï¼Œç†è®ºä¸Šæ¥è¯´â€”â€”å¦‚æœä½ æœ‰å¤šä¸ª gRPC æœåŠ¡ï¼Œè€Œä¸” url æ²¡æœ‰å†²çªçš„è¯ï¼Œæ³¨å†Œå¤šä¸ªæœåŠ¡åˆ°è·¯ç”±ä¸Šåº”è¯¥æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p>
<p>æ‰€ä»¥å‰©ä¸‹çš„é—®é¢˜å°±æ˜¯è¿™ä¸ª <code>RegisterGreeterHandler</code> å†…æ˜¯ä¸æ˜¯æˆ‘ä»¬é¢„æœŸçš„é‚£æ ·ï¼Œç±»ä¼¼ <code>mux</code> æ³¨å†Œè·¯ç”±çš„ç”¨æ³•ï¼Ÿ</p>
<h3 id=registerxxxhandlerclient-å®ç°>RegisterXXXHandlerClient å®ç°</h3>
<p><img src=/blog/p/grpc-gateway-used-as-multiple-grpc-server-gateway/image-20220222154718918.png width=1207 height=132 srcset="/blog/p/grpc-gateway-used-as-multiple-grpc-server-gateway/image-20220222154718918_huae7e9726eb83dcb6808b9604bde89ea7_31321_480x0_resize_box_3.png 480w, /blog/p/grpc-gateway-used-as-multiple-grpc-server-gateway/image-20220222154718918_huae7e9726eb83dcb6808b9604bde89ea7_31321_1024x0_resize_box_3.png 1024w" loading=lazy alt=RegisterXXXHandlerClientå®ç° class=gallery-image data-flex-grow=914 data-flex-basis=2194px></p>
<p>é¡ºç€ <code>RegisterXXXHandler</code>å¾ˆå¿«å°±èƒ½æ‰¾åˆ°å®ç°ï¼Œ<code>RegisterXXXHandlerClient</code>ã€‚<code>Handle</code>çš„ç”¨æ³•æ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œæ˜¯ä¸€ä¸ªç±»ä¼¼ <code>http.ServeMux</code> çš„å¯¹è±¡ã€‚å¤„ç†å‡½æ•°é‡Œçš„é€»è¾‘å¾ˆæ¸…æ™°ã€‚</p>
<p><img src=/blog/p/grpc-gateway-used-as-multiple-grpc-server-gateway/image-20220222155630463.png width=1167 height=420 srcset="/blog/p/grpc-gateway-used-as-multiple-grpc-server-gateway/image-20220222155630463_hu5863f8bc3c05d0c34f00482d4fdc41e8_65629_480x0_resize_box_3.png 480w, /blog/p/grpc-gateway-used-as-multiple-grpc-server-gateway/image-20220222155630463_hu5863f8bc3c05d0c34f00482d4fdc41e8_65629_1024x0_resize_box_3.png 1024w" loading=lazy alt=HandleFunc class=gallery-image data-flex-grow=277 data-flex-basis=666px></p>
<p>å‡½æ•°ä½“å¯ä»¥ç®€å•åˆ’åˆ†æˆä¸¤éƒ¨åˆ†ï¼š</p>
<ul>
<li>æ„é€ å’Œå‘é€è¯·æ±‚
<ul>
<li>æ ¹æ®è¯·æ±‚çš„ <code>Content-Type</code> é€‰æ‹© <code>Marshaler</code> ã€‚</li>
<li>æ„é€ è¯·æ±‚ä¸Šä¸‹æ–‡ï¼Œä»HTTPè¯·æ±‚é‡Œæå–<code>grpc-metadata</code>å¼€å¤´çš„å…ƒæ•°æ®åˆ° <code>context</code> é‡Œã€‚</li>
<li><code>request_XXX_0</code> ååºåˆ—åŒ– HTTP è¯·æ±‚ä½“åˆ° protobuf ç”Ÿæˆçš„ç»“æ„ï¼Œå¹¶å‘é€è¯·æ±‚ã€‚</li>
</ul>
</li>
<li>æ„é€ å’Œè¿”å›å“åº”
<ul>
<li>ä»å“åº”å…ƒæ•°æ®é‡Œæ„é€ ä¸Šä¸‹æ–‡</li>
<li>æ„é€ å’Œè¿”å› HTTP å“åº”</li>
</ul>
</li>
</ul>
<p>æ•´ä¸ªæµç¨‹æ˜¯æ— çŠ¶æ€ä¹Ÿå’Œ <code>gwmux</code> æœ¬èº«æ— ç»‘å®šçš„ã€‚æ¢è¨€ä¹‹ï¼Œç†è®ºä¸Šæ¥è¯´å®Œå…¨å¯ä»¥æŠŠæ‰€æœ‰ gRPC-Gateway ç”Ÿæˆçš„ <code>Register</code> å‡½æ•°æ³¨å†Œåˆ°åŒä¸€ä¸ª <code>gwmux</code> ä¸Šã€‚</p>
<h3 id=backendå’Œæ³¨å†Œ>Backendå’Œæ³¨å†Œ</h3>
<p>å‡ºäºæ¸…æ™°åŒ–çš„è€ƒè™‘ï¼ŒGateway æœåŠ¡çš„æ„é€ è¿‡ç¨‹æˆ‘å†™æˆäº† Builder æ¨¡å¼ã€‚</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>type</span> <span class=nx>registerHandlerFn</span> <span class=kd>func</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>mux</span> <span class=o>*</span><span class=nx>runtime</span><span class=p>.</span><span class=nx>ServeMux</span><span class=p>,</span> <span class=nx>conn</span> <span class=o>*</span><span class=nx>grpc</span><span class=p>.</span><span class=nx>ClientConn</span><span class=p>)</span> <span class=p>(</span><span class=nx>err</span> <span class=kt>error</span><span class=p>)</span>

<span class=kd>type</span> <span class=nx>GRPCBackend</span> <span class=kd>struct</span> <span class=p>{</span>
	<span class=nx>RegisterHandlerFunc</span> <span class=nx>registerHandlerFn</span>
	<span class=nx>BackendAddr</span>         <span class=kt>string</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=o>*</span><span class=nx>DonviewGRPCGatewayServer</span><span class=p>)</span> <span class=nf>Serve</span><span class=p>()</span> <span class=kt>error</span> <span class=p>{</span>
	<span class=nx>mux</span> <span class=o>:=</span> <span class=nx>runtime</span><span class=p>.</span><span class=nf>NewServeMux</span><span class=p>(</span><span class=nx>s</span><span class=p>.</span><span class=nx>muxOptions</span><span class=o>...</span><span class=p>)</span>

	<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>backend</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>s</span><span class=p>.</span><span class=nx>backends</span> <span class=p>{</span>
		<span class=nx>conn</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>grpc</span><span class=p>.</span><span class=nf>DialContext</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=nx>backend</span><span class=p>.</span><span class=nx>BackendAddr</span><span class=p>,</span> <span class=nx>s</span><span class=p>.</span><span class=nx>dialOptions</span><span class=o>...</span><span class=p>)</span>
		<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
			<span class=k>return</span> <span class=nx>err</span>
		<span class=p>}</span>

		<span class=nx>err</span> <span class=p>=</span> <span class=nx>backend</span><span class=p>.</span><span class=nf>RegisterHandlerFunc</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=nx>mux</span><span class=p>,</span> <span class=nx>conn</span><span class=p>)</span>
		<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
			<span class=k>return</span> <span class=nx>err</span>
		<span class=p>}</span>
	<span class=p>}</span>

	<span class=kd>var</span> <span class=nx>handler</span> <span class=nx>http</span><span class=p>.</span><span class=nx>Handler</span> <span class=p>=</span> <span class=nx>mux</span>
	<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>wrapperFn</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>s</span><span class=p>.</span><span class=nx>httpHandlerWrappers</span> <span class=p>{</span>
		<span class=nx>handler</span> <span class=p>=</span> <span class=nf>wrapperFn</span><span class=p>(</span><span class=nx>handler</span><span class=p>)</span>
	<span class=p>}</span>

	<span class=k>return</span> <span class=nx>http</span><span class=p>.</span><span class=nf>ListenAndServe</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;0.0.0.0:%d&#34;</span><span class=p>,</span> <span class=nx>s</span><span class=p>.</span><span class=nx>port</span><span class=p>),</span> <span class=nx>handler</span><span class=p>)</span>
<span class=p>}</span>

</code></pre></div><p>æ‰€æœ‰ gRPC åç«¯è¢«æ³¨å†Œåˆ° <code>s.backends</code> ï¼Œåœ¨å¼€å§‹æœåŠ¡çš„æ—¶å€™è°ƒç”¨ <code>Serve</code> å‡½æ•°ï¼ŒæŠŠ gRPC æœåŠ¡æ³¨å†Œåˆ° <code>mux</code> é‡Œã€‚å› ä¸ºäº‹å‰ç¡®ä¿äº†æœåŠ¡è·¯ç”±ä¸ä¼šé‡å ï¼Œç†è®ºä¸Šæ¥è¯´æ³¨å†Œå®Œå°±èƒ½ç”¨ã€‚</p>
<h2 id=è´Ÿè½½å‡è¡¡>è´Ÿè½½å‡è¡¡</h2>
<p>æœ€åˆçš„æ¶æ„é‡Œï¼Œä¸€ä¸ª gRPC-Gateway æœåŠ¡å¯¹åº”ä¸€ä¸ª gRPC æœåŠ¡ï¼Œè¯·æ±‚è¿›å…¥æœåŠ¡çš„è¿‡ç¨‹æ˜¯ä»äº‘æœåŠ¡æä¾›å•†çš„ LB => kubernetes service (load balancer) => gateway => ClusterIP => gRPC Server ã€‚</p>
<p>åæ¥æ”¹æˆä¸€ä¸ª POD åŒ…å« gateway å’Œ gRPC ä¸¤ä¸ª container åï¼Œgateway è®¿é—® gRPC æœåŠ¡å°±ä¸åœ¨ç»è¿‡ ClusterIP è¿™ä¸€å±‚ä»£ç†äº†ï¼Œè·¯å¾„å˜æˆäº‘æœåŠ¡å•†çš„ LB => kubernetes service (load balancer) => gateway => gRPC Server ã€‚</p>
<p>æœ€åæ˜¯ç°åœ¨çš„ç‰ˆæœ¬ï¼Œç½‘å…³ç»Ÿä¸€æˆä¸€ä¸ªå®¹å™¨ï¼Œè·¯å¾„å’Œä¸Šè¿°ä¸€æ ·ã€‚</p>
<p>ä¸‰è€…çš„åŒºåˆ«åœ¨äºè´Ÿè½½å‡è¡¡çš„æ—¶æœºã€‚Kubernetes çš„ ClusterIP æ˜¯åŒæ ·å…·å¤‡è´Ÿè½½å‡è¡¡èƒ½åŠ›çš„ï¼Œæœ€åˆæ¶æ„ä¸­è´Ÿè½½å‡è¡¡ä¸€å…±è¿›è¡Œäº†ä¸‰æ¬¡ï¼Œä»äº‘æœåŠ¡å•†çš„LBåˆ°ä¸»æœºç«¯å£ï¼ˆkubernetesï¼‰ï¼Œkuberneteså†æ¬¡è´Ÿè½½å‡è¡¡ï¼Œè½¬å‘åˆ° gatewayã€‚gatewayå†ç»ç”± ClusterIP è½¬å‘è‡³ gRPC æœåŠ¡ï¼Œæ¯ä¸€æ¬¡è½¬å‘éƒ½ç»å†ä¸€æ¬¡è´Ÿè½½å‡è¡¡ï¼Œåˆ†åˆ«æä¾›äº†è™šæ‹Ÿä¸»æœºçš„æ‰©å®¹èƒ½åŠ›ã€gatewayæœåŠ¡çš„æ‰©å®¹èƒ½åŠ›ã€gRPCæœåŠ¡çš„æ‰©å®¹èƒ½åŠ›ã€‚</p>
<p>ç¬¬äºŒç‰ˆä¿®æ”¹å»æ‰äº† gateway åˆ° gRPC æœåŠ¡çš„è´Ÿè½½å‡è¡¡ï¼Œå˜æˆäº†ç›´è¿ï¼Œå»¶è¿Ÿè¡¨ç°ä¸Šç†è®ºä¸Šæ¥è¯´ä¼šæœ‰æ”¹å–„ï¼Œä½†æˆ‘æ²¡åšè¿‡åŸºå‡†æµ‹è¯•ï¼Œæ‰€ä»¥è¿™ä¸ªâ€œç†è®ºä¸Šâ€ä¹Ÿåªæ˜¯å‡­æ„Ÿè§‰è¯´ã€‚ä½†å¯ä»¥æ˜ç¡®çš„æ˜¯ gateway ä¼šé¢å¤–å æ®èµ„æºé…é¢ï¼Œé€ æˆæµªè´¹ï¼Œä¸å¥½è¯´å€¼ä¸å€¼ï¼Œä¸ªäººæ„Ÿè§‰æ²¡å¤ªå¤§æ„ä¹‰ã€‚</p>
<p>ç¬¬ä¸‰ç‰ˆï¼Œç»Ÿä¸€äº† gatewayï¼Œè¿˜æ˜¯ä¸‰æ¬¡è´Ÿè½½å‡è¡¡ã€‚ä¸è¿‡Gatewayå¯¹èµ„æºé…é¢çš„ä½¿ç”¨æ•ˆç‡ä¼šæ›´å¥½ä¸€ç‚¹ï¼Œä¾ç„¶ä¿æŒäº†ä¸»æœºã€gatewayã€gRPC æœåŠ¡çš„å¯ä¼¸ç¼©æ€§ã€‚</p>
<p><img src=/blog/p/grpc-gateway-used-as-multiple-grpc-server-gateway/image-20220222165344894.png width=176 height=714 srcset="/blog/p/grpc-gateway-used-as-multiple-grpc-server-gateway/image-20220222165344894_huca7a171cf394f94ea2cc15092e42ada3_10452_480x0_resize_box_3.png 480w, /blog/p/grpc-gateway-used-as-multiple-grpc-server-gateway/image-20220222165344894_huca7a171cf394f94ea2cc15092e42ada3_10452_1024x0_resize_box_3.png 1024w" loading=lazy alt=ä¸‰æ¬¡LB class=gallery-image data-flex-grow=24 data-flex-basis=59px></p>
<h2 id=æ€»ç»“>æ€»ç»“</h2>
<p>å•ä»ç†è®ºä¸Šæ¥è¯´è¿™æ ·è®¾è®¡åº”è¯¥æ˜¯ OK çš„ï¼Œä½†æ˜¯ gRPC-Gateway å®˜æ–¹å¯¹è´Ÿè½½å‡è¡¡æ²¡æœ‰è¯´æ³•ï¼Œå¯¹èƒ½ä¸èƒ½æ³¨å†Œå¤šä¸ª gRPC æœåŠ¡åˆ°ä¸€ä¸ª <code>mux</code> ä¸Šä¹Ÿæ²¡æœ‰å®˜æ–¹çš„æ–‡æ¡£è¯´æ˜ï¼Œå¾ˆéš¾è¯´è¿™å¸®äººèƒ½ä¸èƒ½ä¿è¯å‘åå…¼å®¹ï¼Œä¸‡ä¸€ä¹‹åçš„ç‰ˆæœ¬ä¸æ”¯æŒæ³¨å†Œåˆ°ä¸€ä¸ª <code>mux</code> ä¸Šäº†ï¼Œåˆ°æ—¶å€™æ”¹èµ·æ¥å°±éº»çƒ¦äº†ï¼Œæ¯”è¾ƒåçš„æƒ…å†µå°±æ˜¯ä½ å¾—è‡ªå·±å†™ä¸€ä¸ª <code>protoc-gen-gateway</code> è¿™æ ·çš„ç©æ„å„¿æ¥ç”Ÿæˆä¸€ä¸ªè‡ªå·±çš„ç½‘å…³ã€‚</p>
<p>æ­¤å¤–è¿˜æœ‰ä¸€ä¸ªç¼ºé™·ï¼ŒgRPC-Gateway åˆ° gRPC Server çš„è´Ÿè½½å‡è¡¡ç”± Kubernetes ClusterIP æä¾›ï¼Œä½†æ˜¯ <a class=link href=https://stackoverflow.com/questions/49888133/kubernetes-service-cluster-ip-how-is-this-internally-load-balanced-across-diffe target=_blank rel=noopener>ClusterIP çš„è´Ÿè½½å‡è¡¡ç®—æ³•æ˜¯ Round Robin/Random</a> ï¼Œå¹¶ä¸æ”¯æŒæ ¹æ®è´Ÿè½½æˆ–å…¶ä»–ç»´åº¦çš„æµ‹é‡æ•°æ®æ¥å†³å®šå¦‚ä½•å‡è¡¡è´Ÿè½½ï¼Œæœªæ¥å¦‚æœéœ€è¦æ ¹æ®è´Ÿè½½æƒ…å†µåˆ†å‘è¯·æ±‚ï¼Œå¯èƒ½è¿˜å¾—åœ¨ç½‘å…³åˆ° gRPC æœåŠ¡ä¹‹é—´åŠ ä¸ªè´Ÿè½½å‡è¡¡ç»„ä»¶ï¼Œå†æä¾›ä¸€ä¸ªæœåŠ¡å‘ç°/æ³¨å†Œä¸­å¿ƒæ¥å¸®åŠ©è°ƒåº¦ã€‚</p>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/blog/tags/golang/>golang</a>
<a href=/blog/tags/kubernetes/>kubernetes</a>
<a href=/blog/tags/microservice/>microservice</a>
</section>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>ç›¸å…³æ–‡ç« </h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article>
<a href=/blog/p/go-kit-note/>
<div class=article-details>
<h2 class=article-title>go-kit ç¬”è®°</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/my-opinion-of-gokit-architecture/>
<div class=article-details>
<h2 class=article-title>gokit æ¶æ„ä¹‹æˆ‘è§</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/protogen-code-generation/>
<div class=article-details>
<h2 class=article-title>protogenä»£ç ç”Ÿæˆ</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/stack-based-virtual-machine-for-minilang/>
<div class=article-details>
<h2 class=article-title>åŸºäºæ ˆçš„è™šæ‹Ÿæœº</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/a-s-exp-evaluator/>
<div class=article-details>
<h2 class=article-title>ä¸€ä¸ªsè¡¨è¾¾å¼æ±‚å€¼å™¨</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<link rel=stylesheet href=https://unpkg.com/vssue/dist/vssue.min.css>
<div id=vssue></div>
<script src=https://unpkg.com/vue@2.6.14/dist/vue.runtime.min.js></script>
<script src=https://unpkg.com/vssue@1.4.8/dist/vssue.github.min.js></script>
<script>new Vue({el:"#vssue",render:a=>a("Vssue",{props:{title:"gRPC-Gateway ç”¨ä½œå¤šä¸ª gRPC æœåŠ¡çš„ç½‘å…³",options:{autoCreateIssue:!0,owner:"nnnewb",repo:"blog",clientId:"285910fdc1567a1a23e3",clientSecret:"f00da5438d9ac82c4a86024866c7a916ae411edc"}}})})</script>
<footer class=site-footer>
<section class=copyright>
&copy;
2021 -
2022 weakptr's ç¬”è®°
</section>
<section class=powerby>
GitHub Pages <br>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.10.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">ç›®å½•</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#å‰è¨€>å‰è¨€</a></li>
<li><a href=#å®ç°ç½‘å…³>å®ç°ç½‘å…³</a>
<ol>
<li><a href=#å®˜æ–¹demo>å®˜æ–¹demo</a></li>
<li><a href=#registerxxxhandlerclient-å®ç°>RegisterXXXHandlerClient å®ç°</a></li>
<li><a href=#backendå’Œæ³¨å†Œ>Backendå’Œæ³¨å†Œ</a></li>
</ol>
</li>
<li><a href=#è´Ÿè½½å‡è¡¡>è´Ÿè½½å‡è¡¡</a></li>
<li><a href=#æ€»ç»“>æ€»ç»“</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/blog/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>