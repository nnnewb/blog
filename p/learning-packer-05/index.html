<!doctype html><html lang=zh-cn>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="前言 完成了简单的压缩壳之后放松下，在52论坛病毒分析区看到过几次把代码隐藏到图片里的做法，也看到过把程序转成图片后训练神经网络来判断有没有恶意的，于是就想，淦，这不是挺好玩的嘛。
0x01 思路 用图片保存程序最简单的做法就是直接把程序每个字节都转成像素，然后输出成灰度图。比较进阶的做法就像是二维码了，大色块，容错校验，图片被压到包浆也能扫出来。但那个有点点难（我菜）最终成果也大到不现实，而且实话说打包到程序里就不用考虑被二次压缩的情况了。所以简单的8bit灰度图就刑。
说到位图肯定有人想到了 BMP ，我记得上学那会儿还跟着网上哪儿找的教程，学着用 ffmpeg 把 Bad Apple 转成位图序列，再转成字符图合并成 HTML，用 js 播放。说起来都是泪。
现在已经成了正经的码农，再折腾 BMP 就没意思了，PNG 就挺好的。
图片可以放到 Section 里——但并没有意义，所以我选择放到资源里。写一个 .rc 文件用 windres 编译出目标文件，再拿 gcc 链接就行了。如此一来并没有 lief 出场的机会，编译好的加载器就是加完壳的程序。
加载器则采用开启 ASLR 的模式，这样程序的节表会比较干净，没有明显特征（虽然也没什么卵用）。
0x02 加载器 2.1 资源介绍 参考微软的文档 Using Resources、Menu and Other Resources。
 A resource is binary data that you can add to the executable file of a Windows-based application. A resource can be either standard or defined. The data in a standard resource describes an icon, cursor, menu, dialog box, bitmap, enhanced metafile, font, accelerator table, message-table entry, string-table entry, or version information."><title>加壳原理05：利用图片隐藏</title>
<link rel=canonical href=https://nnnewb.github.io/blog/p/learning-packer-05/>
<link rel=stylesheet href=/blog/scss/style.min.css><meta property="og:title" content="加壳原理05：利用图片隐藏">
<meta property="og:description" content="前言 完成了简单的压缩壳之后放松下，在52论坛病毒分析区看到过几次把代码隐藏到图片里的做法，也看到过把程序转成图片后训练神经网络来判断有没有恶意的，于是就想，淦，这不是挺好玩的嘛。
0x01 思路 用图片保存程序最简单的做法就是直接把程序每个字节都转成像素，然后输出成灰度图。比较进阶的做法就像是二维码了，大色块，容错校验，图片被压到包浆也能扫出来。但那个有点点难（我菜）最终成果也大到不现实，而且实话说打包到程序里就不用考虑被二次压缩的情况了。所以简单的8bit灰度图就刑。
说到位图肯定有人想到了 BMP ，我记得上学那会儿还跟着网上哪儿找的教程，学着用 ffmpeg 把 Bad Apple 转成位图序列，再转成字符图合并成 HTML，用 js 播放。说起来都是泪。
现在已经成了正经的码农，再折腾 BMP 就没意思了，PNG 就挺好的。
图片可以放到 Section 里——但并没有意义，所以我选择放到资源里。写一个 .rc 文件用 windres 编译出目标文件，再拿 gcc 链接就行了。如此一来并没有 lief 出场的机会，编译好的加载器就是加完壳的程序。
加载器则采用开启 ASLR 的模式，这样程序的节表会比较干净，没有明显特征（虽然也没什么卵用）。
0x02 加载器 2.1 资源介绍 参考微软的文档 Using Resources、Menu and Other Resources。
 A resource is binary data that you can add to the executable file of a Windows-based application. A resource can be either standard or defined. The data in a standard resource describes an icon, cursor, menu, dialog box, bitmap, enhanced metafile, font, accelerator table, message-table entry, string-table entry, or version information.">
<meta property="og:url" content="https://nnnewb.github.io/blog/p/learning-packer-05/">
<meta property="og:site_name" content="weakptr's 笔记">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="逆向"><meta property="article:tag" content="windows"><meta property="article:tag" content="c++"><meta property="article:tag" content="python"><meta property="article:published_time" content="2021-10-21T21:17:00+08:00"><meta property="article:modified_time" content="2021-10-21T21:17:00+08:00">
<meta name=twitter:title content="加壳原理05：利用图片隐藏">
<meta name=twitter:description content="前言 完成了简单的压缩壳之后放松下，在52论坛病毒分析区看到过几次把代码隐藏到图片里的做法，也看到过把程序转成图片后训练神经网络来判断有没有恶意的，于是就想，淦，这不是挺好玩的嘛。
0x01 思路 用图片保存程序最简单的做法就是直接把程序每个字节都转成像素，然后输出成灰度图。比较进阶的做法就像是二维码了，大色块，容错校验，图片被压到包浆也能扫出来。但那个有点点难（我菜）最终成果也大到不现实，而且实话说打包到程序里就不用考虑被二次压缩的情况了。所以简单的8bit灰度图就刑。
说到位图肯定有人想到了 BMP ，我记得上学那会儿还跟着网上哪儿找的教程，学着用 ffmpeg 把 Bad Apple 转成位图序列，再转成字符图合并成 HTML，用 js 播放。说起来都是泪。
现在已经成了正经的码农，再折腾 BMP 就没意思了，PNG 就挺好的。
图片可以放到 Section 里——但并没有意义，所以我选择放到资源里。写一个 .rc 文件用 windres 编译出目标文件，再拿 gcc 链接就行了。如此一来并没有 lief 出场的机会，编译好的加载器就是加完壳的程序。
加载器则采用开启 ASLR 的模式，这样程序的节表会比较干净，没有明显特征（虽然也没什么卵用）。
0x02 加载器 2.1 资源介绍 参考微软的文档 Using Resources、Menu and Other Resources。
 A resource is binary data that you can add to the executable file of a Windows-based application. A resource can be either standard or defined. The data in a standard resource describes an icon, cursor, menu, dialog box, bitmap, enhanced metafile, font, accelerator table, message-table entry, string-table entry, or version information.">
</head>
<body class="article-page has-toc">
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=https://nnnewb.github.io/blog class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>返回</span>
</a>
</div>
<main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/blog/categories/%E9%80%86%E5%90%91/>
逆向
</a>
</header>
<h2 class=article-title>
<a href=/blog/p/learning-packer-05/>加壳原理05：利用图片隐藏</a>
</h2>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2021年 10月 21日</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
阅读时长: 3 分钟
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<h2 id=前言>前言</h2>
<p>完成了简单的压缩壳之后放松下，在52论坛病毒分析区看到过几次把代码隐藏到图片里的做法，也看到过把程序转成图片后训练神经网络来判断有没有恶意的，于是就想，淦，这不是挺好玩的嘛。</p>
<h2 id=0x01-思路>0x01 思路</h2>
<p>用图片保存程序最简单的做法就是直接把程序每个字节都转成像素，然后输出成灰度图。比较进阶的做法就像是二维码了，大色块，容错校验，图片被压到包浆也能扫出来。但那个有点点难（我菜）最终成果也大到不现实，而且实话说打包到程序里就不用考虑被二次压缩的情况了。所以简单的8bit灰度图就刑。</p>
<p>说到位图肯定有人想到了 BMP ，我记得上学那会儿还跟着网上哪儿找的教程，学着用 ffmpeg 把 <em>Bad Apple</em> 转成位图序列，再转成字符图合并成 HTML，用 js 播放。说起来都是泪。</p>
<p>现在已经成了正经的码农，再折腾 BMP 就没意思了，PNG 就挺好的。</p>
<p>图片可以放到 Section 里——但并没有意义，所以我选择放到资源里。写一个 <code>.rc</code> 文件用 <code>windres</code> 编译出目标文件，再拿 <code>gcc</code> 链接就行了。如此一来并没有 lief 出场的机会，编译好的加载器就是加完壳的程序。</p>
<p>加载器则采用开启 ASLR 的模式，这样程序的节表会比较干净，没有明显特征（虽然也没什么卵用）。</p>
<h2 id=0x02-加载器>0x02 加载器</h2>
<h3 id=21-资源介绍>2.1 资源介绍</h3>
<p>参考微软的文档 <a class=link href=https://docs.microsoft.com/en-us/windows/win32/menurc/using-resources target=_blank rel=noopener>Using Resources</a>、<a class=link href=https://docs.microsoft.com/en-us/windows/win32/menurc/resources target=_blank rel=noopener>Menu and Other Resources</a>。</p>
<blockquote>
<p>A <em>resource</em> is binary data that you can add to the executable file of a Windows-based application. A resource can be either standard or defined. The data in a <em>standard resource</em> describes an icon, cursor, menu, dialog box, bitmap, enhanced metafile, font, accelerator table, message-table entry, string-table entry, or version information. An <em>application-defined resource</em>, also called a <em>custom resource</em>, contains any data required by a specific application.</p>
</blockquote>
<p>资源就是一堆打包进可执行文件里的二进制数据，有标准资源类型和自定义的资源类型，标准的回头看就全是微软的历史包袱了，自定义的就是随便什么东西。</p>
<p>资源本身是有结构的，大体上分三层：</p>
<ol>
<li>类型；比如图标、对话框、位图、Manifest等等。</li>
<li>ID；资源的标识符，可以是数字或字符串。</li>
<li>语言；英语法语等等..</li>
</ol>
<p>经过这样三层索引就能找到对应资源的原始数据了。</p>
<p>如图：</p>
<p><figure style=flex-grow:194;flex-basis:467px>
<a href=/blog/p/learning-packer-05/07_resource_tree.png data-size=1080x555><img src=/blog/p/learning-packer-05/07_resource_tree.png srcset="/blog/p/learning-packer-05/07_resource_tree_hu7434ebea0cccdf660ca2884c9de14b61_327250_480x0_resize_box_3.png 480w, /blog/p/learning-packer-05/07_resource_tree_hu7434ebea0cccdf660ca2884c9de14b61_327250_1024x0_resize_box_3.png 1024w" width=1080 height=555 loading=lazy alt=07_resource_tree.png>
</a>
<figcaption>07_resource_tree.png</figcaption>
</figure></p>
<h3 id=22-查找并加载资源>2.2 查找并加载资源</h3>
<p>步骤很简单：</p>
<ol>
<li><code>FindResource</code> 找到你要的资源</li>
<li><code>SizeofResource</code> 确定你要的资源大小</li>
<li><code>LoadResource</code> 加载资源，得到 HANDLE</li>
<li><code>LockResource</code> 锁定资源，得到资源首字节指针</li>
</ol>
<p>实现比较啰嗦，主要是错误检查很啰嗦。我这返回值都是随便 return 的，更好的做法应该是 <code>GetLastError</code> 去拿错误码。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=kt>int</span> <span class=nf>get_resource</span><span class=p>(</span><span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>name</span><span class=p>,</span> <span class=kt>void</span> <span class=o>**</span><span class=n>buffer</span><span class=p>,</span> <span class=n>size_t</span> <span class=o>*</span><span class=n>length</span><span class=p>)</span> <span class=p>{</span>
  <span class=n>HRSRC</span> <span class=n>res_found</span> <span class=o>=</span> <span class=n>FindResourceA</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=s>&#34;BEAUTIFUL.PNG&#34;</span><span class=p>,</span> <span class=n>RT_RCDATA</span><span class=p>);</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>res_found</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>MessageBoxA</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=s>&#34;find resource failed&#34;</span><span class=p>,</span> <span class=s>&#34;FindResourceA&#34;</span><span class=p>,</span> <span class=n>MB_OK</span><span class=p>);</span>
    <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
  <span class=p>}</span>

  <span class=n>DWORD</span> <span class=n>sizeof_res</span> <span class=o>=</span> <span class=n>SizeofResource</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=n>res_found</span><span class=p>);</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>sizeof_res</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>MessageBoxA</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=s>&#34;sizeof resource failed&#34;</span><span class=p>,</span> <span class=s>&#34;SizeofResource&#34;</span><span class=p>,</span> <span class=n>MB_OK</span><span class=p>);</span>
    <span class=k>return</span> <span class=mi>2</span><span class=p>;</span>
  <span class=p>}</span>

  <span class=n>HGLOBAL</span> <span class=n>res_loaded</span> <span class=o>=</span> <span class=n>LoadResource</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=n>res_found</span><span class=p>);</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>res_loaded</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>MessageBoxA</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=s>&#34;load resource failed&#34;</span><span class=p>,</span> <span class=s>&#34;LoadResource&#34;</span><span class=p>,</span> <span class=n>MB_OK</span><span class=p>);</span>
    <span class=k>return</span> <span class=mi>3</span><span class=p>;</span>
  <span class=p>}</span>

  <span class=n>LPVOID</span> <span class=n>res_acquired</span> <span class=o>=</span> <span class=n>LockResource</span><span class=p>(</span><span class=n>res_loaded</span><span class=p>);</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>res_acquired</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>MessageBoxA</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=s>&#34;lock resource failed&#34;</span><span class=p>,</span> <span class=s>&#34;LockResource&#34;</span><span class=p>,</span> <span class=n>MB_OK</span><span class=p>);</span>
    <span class=k>return</span> <span class=mi>3</span><span class=p>;</span>
  <span class=p>}</span>

  <span class=o>*</span><span class=n>buffer</span> <span class=o>=</span> <span class=n>malloc</span><span class=p>(</span><span class=n>sizeof_res</span><span class=p>);</span>
  <span class=o>*</span><span class=n>length</span> <span class=o>=</span> <span class=n>sizeof_res</span><span class=p>;</span>
  <span class=n>memcpy</span><span class=p>(</span><span class=o>*</span><span class=n>buffer</span><span class=p>,</span> <span class=n>res_acquired</span><span class=p>,</span> <span class=n>sizeof_res</span><span class=p>);</span>
  <span class=n>UnlockResource</span><span class=p>(</span><span class=n>res_loaded</span><span class=p>);</span>
  <span class=n>FreeResource</span><span class=p>(</span><span class=n>res_loaded</span><span class=p>);</span>

  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div><p>得到数据后复制到新分配的内存里返回出去就完事了。</p>
<h3 id=23-解析图片>2.3 解析图片</h3>
<p>得到了资源图片的内容之后，下一步就是把图片解码成像素，还原到程序本身了。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=cp>#include</span> <span class=cpf>&#34;png.h&#34;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;stddef.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;stdint.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span><span class=cp></span>
<span class=k>typedef</span> <span class=kt>uint8_t</span> <span class=n>u8</span><span class=p>,</span> <span class=o>*</span><span class=n>u8p</span><span class=p>;</span>
<span class=k>typedef</span> <span class=kt>uint32_t</span> <span class=n>u32</span><span class=p>,</span> <span class=o>*</span><span class=n>u32p</span><span class=p>;</span>

<span class=c1>// decode PNG in memory
</span><span class=c1>// https://stackoverflow.com/questions/53237065/using-libpng-1-2-to-write-rgb-image-buffer-to-png-buffer-in-memory-causing-segme
</span><span class=c1></span><span class=n>u8p</span> <span class=nf>read_program_from_png</span><span class=p>(</span><span class=n>u8p</span> <span class=n>data</span><span class=p>,</span> <span class=n>size_t</span> <span class=n>length</span><span class=p>)</span> <span class=p>{</span>
  <span class=n>png_image</span> <span class=n>image</span><span class=p>;</span>
  <span class=n>memset</span><span class=p>(</span><span class=o>&amp;</span><span class=n>image</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>image</span><span class=p>));</span>
  <span class=n>image</span><span class=p>.</span><span class=n>version</span> <span class=o>=</span> <span class=n>PNG_IMAGE_VERSION</span><span class=p>;</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>png_image_begin_read_from_memory</span><span class=p>(</span><span class=o>&amp;</span><span class=n>image</span><span class=p>,</span> <span class=n>data</span><span class=p>,</span> <span class=n>length</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=nb>NULL</span><span class=p>;</span>
  <span class=p>}</span>

  <span class=n>png_bytep</span> <span class=n>buffer</span><span class=p>;</span>
  <span class=n>image</span><span class=p>.</span><span class=n>format</span> <span class=o>=</span> <span class=n>PNG_FORMAT_GRAY</span><span class=p>;</span>
  <span class=n>size_t</span> <span class=n>input_data_length</span> <span class=o>=</span> <span class=n>PNG_IMAGE_SIZE</span><span class=p>(</span><span class=n>image</span><span class=p>);</span>
  <span class=n>buffer</span> <span class=o>=</span> <span class=p>(</span><span class=n>png_bytep</span><span class=p>)</span><span class=n>malloc</span><span class=p>(</span><span class=n>input_data_length</span><span class=p>);</span>
  <span class=n>memset</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>input_data_length</span><span class=p>);</span>

  <span class=k>if</span> <span class=p>(</span><span class=n>png_image_finish_read</span><span class=p>(</span><span class=o>&amp;</span><span class=n>image</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=n>buffer</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=nb>NULL</span><span class=p>;</span>
  <span class=p>}</span>

  <span class=n>u32</span> <span class=n>actual_len</span> <span class=o>=</span> <span class=o>*</span><span class=p>((</span><span class=n>u32</span> <span class=o>*</span><span class=p>)</span><span class=n>buffer</span><span class=p>);</span>
  <span class=kt>void</span> <span class=o>*</span><span class=n>program</span> <span class=o>=</span> <span class=n>malloc</span><span class=p>(</span><span class=n>actual_len</span><span class=p>);</span>
  <span class=n>memcpy</span><span class=p>(</span><span class=n>program</span><span class=p>,</span> <span class=n>buffer</span> <span class=o>+</span> <span class=mi>4</span><span class=p>,</span> <span class=n>actual_len</span><span class=p>);</span>
  <span class=n>free</span><span class=p>(</span><span class=n>buffer</span><span class=p>);</span>

  <span class=k>return</span> <span class=p>(</span><span class=n>u8p</span><span class=p>)</span><span class=n>program</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div><p>面向 stackoverflow 编程，照着抄一个 libpng 的解码实现。不同的是把解码后的头4个字节作为小端序无符号整型，认为是程序的实际大小。因为程序的大小可能并不正好是图片的像素数量（width*height）。</p>
<p>最后是把解码后的内容复制到新分配的内存里返回。现在返回的指针应该就指向我们的 PE 文件内容了。</p>
<h3 id=24-入口点>2.4 入口点</h3>
<p>在入口点，调用加载资源函数获得资源数据的指针，传给解码的函数，得到解码后的PE文件指针，然后加载并跳转到被加载程序的入口点，就这么简单。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=kt>int</span> <span class=nf>_start</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span> <span class=p>{</span>
  <span class=kt>void</span> <span class=o>*</span><span class=n>buffer</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
  <span class=n>size_t</span> <span class=n>length</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>get_resource</span><span class=p>(</span><span class=s>&#34;BEAUTIFUL.PNG&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>buffer</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>length</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
  <span class=p>}</span>

  <span class=n>u8p</span> <span class=n>program</span> <span class=o>=</span> <span class=n>read_program_from_png</span><span class=p>((</span><span class=n>u8p</span><span class=p>)</span><span class=n>buffer</span><span class=p>,</span> <span class=n>length</span><span class=p>);</span>
  <span class=n>free</span><span class=p>(</span><span class=n>buffer</span><span class=p>);</span>

  <span class=k>if</span> <span class=p>(</span><span class=n>program</span> <span class=o>!=</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
    <span class=kt>void</span> <span class=p>(</span><span class=o>*</span><span class=n>entrypoint</span><span class=p>)(</span><span class=kt>void</span><span class=p>)</span> <span class=o>=</span> <span class=p>(</span><span class=kt>void</span> <span class=p>(</span><span class=o>*</span><span class=p>)(</span><span class=kt>void</span><span class=p>))</span><span class=n>load_PE</span><span class=p>((</span><span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=n>program</span><span class=p>);</span>
    <span class=n>entrypoint</span><span class=p>();</span>

    <span class=n>free</span><span class=p>(</span><span class=n>program</span><span class=p>);</span>
    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
  <span class=p>}</span>

  <span class=n>MessageBoxA</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=s>&#34;.packed section not found&#34;</span><span class=p>,</span> <span class=s>&#34;loader error&#34;</span><span class=p>,</span> <span class=n>MB_OK</span><span class=p>);</span>
  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div><h2 id=0x03-加壳机>0x03 加壳机</h2>
<h3 id=31-程序转图片>3.1 程序转图片</h3>
<p>使用 <code>pypng</code> 这个包实现把二进制程序转图片。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=n>IMG_PATH</span> <span class=o>=</span> <span class=s1>&#39;packer5-packed.png&#39;</span>
<span class=n>ROW_LEN</span> <span class=o>=</span> <span class=mi>256</span>
<span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;example.exe&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
    <span class=n>arr</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>content</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
    <span class=n>content</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;I&#39;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>content</span><span class=p>))</span><span class=o>+</span><span class=n>content</span>

    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>content</span><span class=p>)</span><span class=o>//</span><span class=n>ROW_LEN</span><span class=p>):</span>
        <span class=n>t</span> <span class=o>=</span> <span class=n>content</span><span class=p>[</span><span class=n>i</span><span class=o>*</span><span class=n>ROW_LEN</span><span class=p>:</span><span class=n>i</span><span class=o>*</span><span class=n>ROW_LEN</span><span class=o>+</span><span class=n>ROW_LEN</span><span class=p>]</span>
        <span class=n>arr</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>

    <span class=n>png</span><span class=o>.</span><span class=n>from_array</span><span class=p>(</span><span class=n>arr</span><span class=p>,</span> <span class=s1>&#39;L&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>IMG_PATH</span><span class=p>)</span>
</code></pre></div><p>非常简单的一段脚本。把内容长度和内容拼接后，以 <code>ROW_LEN</code> 每行，拆成一个二维数组，然后用 pypng 编码并保存。</p>
<h3 id=32-编译资源>3.2 编译资源</h3>
<p>随便新建一个 <code>rsrc.rc</code> 。</p>
<p>别问 <code>.rc</code> 怎么写，不知道，问就是面向谷歌编程抄的。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain>beautiful.png RCDATA &#34;packer5-packed.png&#34;
</code></pre></div><p>然后在脚本里调用 <code>windres</code> 编译。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>windres</span><span class=p>(</span><span class=n>sources</span><span class=p>,</span> <span class=n>output</span><span class=p>):</span>
    <span class=n>executable</span> <span class=o>=</span> <span class=s1>&#39;windres&#39;</span>
    <span class=n>args</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>sources</span><span class=p>,</span> <span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=nb>bytes</span><span class=p>)):</span>
        <span class=n>args</span> <span class=o>+=</span> <span class=n>sources</span>
    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>sources</span><span class=p>,</span> <span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>)):</span>
        <span class=n>args</span> <span class=o>+=</span> <span class=s1>&#39; &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>sources</span><span class=p>)</span>

    <span class=n>cmd</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>executable</span><span class=si>}</span><span class=s1> </span><span class=si>{</span><span class=n>args</span><span class=si>}</span><span class=s1> -o </span><span class=si>{</span><span class=n>output</span><span class=si>}</span><span class=s1>&#39;</span>
    <span class=n>proc</span> <span class=o>=</span> <span class=n>run</span><span class=p>(</span><span class=n>cmd</span><span class=p>,</span> <span class=n>shell</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>stderr</span><span class=o>=</span><span class=n>STDOUT</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>proc</span><span class=o>.</span><span class=n>returncode</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
        <span class=k>raise</span> <span class=n>CompilationError</span><span class=p>(</span><span class=n>proc</span><span class=o>.</span><span class=n>returncode</span><span class=p>,</span> <span class=n>proc</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>

<span class=n>windres</span><span class=p>(</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>src_dir</span><span class=p>,</span> <span class=s1>&#39;rsrc.rc&#39;</span><span class=p>),</span> <span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>src_dir</span><span class=p>,</span> <span class=s1>&#39;rsrc.o&#39;</span><span class=p>))</span>
</code></pre></div><p>就得到了 <code>rsrc.o</code> 。</p>
<h3 id=33-编译加载器>3.3 编译加载器</h3>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=c1># compile shifted loader program</span>
<span class=k>def</span> <span class=nf>compile</span><span class=p>(</span><span class=n>sources</span><span class=p>,</span> <span class=n>flags</span><span class=p>):</span>
    <span class=n>args</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
    <span class=n>compiler</span> <span class=o>=</span> <span class=s1>&#39;gcc&#39;</span>

    <span class=n>args</span> <span class=o>+=</span> <span class=s1>&#39;&#39;</span>
    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>sources</span><span class=p>,</span> <span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=nb>bytes</span><span class=p>)):</span>
        <span class=n>args</span> <span class=o>+=</span> <span class=n>sources</span>
    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>sources</span><span class=p>,</span> <span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>)):</span>
        <span class=n>args</span> <span class=o>+=</span> <span class=s1>&#39; &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>sources</span><span class=p>)</span>

    <span class=n>args</span> <span class=o>+=</span> <span class=s1>&#39; &#39;</span>
    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>flags</span><span class=p>,</span> <span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=nb>bytes</span><span class=p>)):</span>
        <span class=n>args</span> <span class=o>+=</span> <span class=n>flags</span>
    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>flags</span><span class=p>,</span> <span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>)):</span>
        <span class=n>args</span> <span class=o>+=</span> <span class=s1>&#39; &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>flags</span><span class=p>)</span>

    <span class=n>cmd</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>compiler</span><span class=si>}</span><span class=s1> </span><span class=si>{</span><span class=n>args</span><span class=si>}</span><span class=s1>&#39;</span>
    <span class=n>proc</span> <span class=o>=</span> <span class=n>run</span><span class=p>(</span><span class=n>cmd</span><span class=p>,</span> <span class=n>shell</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>stderr</span><span class=o>=</span><span class=n>STDOUT</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>proc</span><span class=o>.</span><span class=n>returncode</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
        <span class=k>raise</span> <span class=n>CompilationError</span><span class=p>(</span><span class=n>proc</span><span class=o>.</span><span class=n>returncode</span><span class=p>,</span> <span class=n>proc</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>

<span class=n>cflags</span> <span class=o>=</span> <span class=p>[</span>
    <span class=s1>&#39;-m32&#39;</span><span class=p>,</span>
    <span class=s1>&#39;-O2&#39;</span><span class=p>,</span>
    <span class=s1>&#39;-Wall&#39;</span><span class=p>,</span>
    <span class=s1>&#39;-I.&#39;</span><span class=p>,</span>
    <span class=s1>&#39;-Wl,--entry=__start&#39;</span><span class=p>,</span>
    <span class=s1>&#39;-nodefaultlibs&#39;</span><span class=p>,</span>
    <span class=s1>&#39;-nostartfiles&#39;</span><span class=p>,</span>
    <span class=s1>&#39;-lkernel32&#39;</span><span class=p>,</span>
    <span class=s1>&#39;-luser32&#39;</span><span class=p>,</span>
    <span class=s1>&#39;-lmsvcrt&#39;</span><span class=p>,</span>
    <span class=s1>&#39;-lpng&#39;</span><span class=p>,</span>
    <span class=s1>&#39;-o&#39;</span><span class=p>,</span>
    <span class=s1>&#39;packed.exe&#39;</span>
<span class=p>]</span>
<span class=nb>compile</span><span class=p>([</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>src_dir</span><span class=p>,</span> <span class=n>src</span><span class=p>)</span> <span class=k>for</span> <span class=n>src</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;loader.c&#39;</span><span class=p>,</span> <span class=s1>&#39;png_decode.c&#39;</span><span class=p>,</span> <span class=s1>&#39;rsrc.o&#39;</span><span class=p>]],</span> <span class=n>cflags</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s1>&#39;[+] compile loader with resource success.&#39;</span><span class=p>)</span>
</code></pre></div><p>主要是加上 <code>-lpng</code> 链接参数，链接 <code>libpng</code> 。输入文件里加上 <code>png_decode.c</code> 这个里面实现了 <code>read_program_from_png</code>，还有编译好的资源 <code>rsrc.o</code>。</p>
<h2 id=0x04-成果展示>0x04 成果展示</h2>
<h3 id=41-完整代码>4.1 完整代码</h3>
<p><a class=link href=https://github.com/nnnewb/learning-packer/tree/main/packer5 target=_blank rel=noopener>github.com - packer05</a></p>
<h3 id=42-成果>4.2 成果</h3>
<p><figure style=flex-grow:149;flex-basis:359px>
<a href=/blog/p/learning-packer-05/png-packer.gif data-size=934x624><img src=/blog/p/learning-packer-05/png-packer.gif srcset="/blog/p/learning-packer-05/png-packer_hu49467b8d76a283ecefa4b0c8c018eaea_352500_480x0_resize_box.gif 480w, /blog/p/learning-packer-05/png-packer_hu49467b8d76a283ecefa4b0c8c018eaea_352500_1024x0_resize_box.gif 1024w" width=934 height=624 loading=lazy alt=png-packer>
</a>
<figcaption>png-packer</figcaption>
</figure></p>
<p><figure style=flex-grow:428;flex-basis:1028px>
<a href=/blog/p/learning-packer-05/image-20211021172402101.png data-size=1123x262><img src=/blog/p/learning-packer-05/image-20211021172402101.png srcset="/blog/p/learning-packer-05/image-20211021172402101_hu5e82684139999b9b3beada7e64c4352c_121826_480x0_resize_box_3.png 480w, /blog/p/learning-packer-05/image-20211021172402101_hu5e82684139999b9b3beada7e64c4352c_121826_1024x0_resize_box_3.png 1024w" width=1123 height=262 loading=lazy alt=image-20211021172402101>
</a>
<figcaption>image-20211021172402101</figcaption>
</figure></p>
<p><figure style=flex-grow:168;flex-basis:404px>
<a href=/blog/p/learning-packer-05/image-20211021172445654.png data-size=745x442><img src=/blog/p/learning-packer-05/image-20211021172445654.png srcset="/blog/p/learning-packer-05/image-20211021172445654_huadd050e73542001f453da1b3213f5950_43748_480x0_resize_box_3.png 480w, /blog/p/learning-packer-05/image-20211021172445654_huadd050e73542001f453da1b3213f5950_43748_1024x0_resize_box_3.png 1024w" width=745 height=442 loading=lazy alt=image-20211021172445654>
</a>
<figcaption>image-20211021172445654</figcaption>
</figure></p>
<p><figure style=flex-grow:176;flex-basis:422px>
<a href=/blog/p/learning-packer-05/image-20211021172504888.png data-size=969x550><img src=/blog/p/learning-packer-05/image-20211021172504888.png srcset="/blog/p/learning-packer-05/image-20211021172504888_hubda3186aaf1f68e7da983b4009bb0f3d_50213_480x0_resize_box_3.png 480w, /blog/p/learning-packer-05/image-20211021172504888_hubda3186aaf1f68e7da983b4009bb0f3d_50213_1024x0_resize_box_3.png 1024w" width=969 height=550 loading=lazy alt=image-20211021172504888>
</a>
<figcaption>image-20211021172504888</figcaption>
</figure></p>
<h2 id=总结>总结</h2>
<p>这次实验主要是验证了从资源加载程序，本质和之前的其他加壳方式没有区别。把应用程序转换成图片后看到的效果确实比较有趣，我想如果用一张普通的图片或者其他文件类型，藏起来可能更隐蔽。</p>
<p>但到这里还是有明显的问题：壳和被加载的程序还是泾渭分明。</p>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/blog/tags/%E9%80%86%E5%90%91/>逆向</a>
<a href=/blog/tags/windows/>windows</a>
<a href=/blog/tags/c++/>c++</a>
<a href=/blog/tags/python/>python</a>
</section>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>相关文章</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article>
<a href=/blog/p/learning-packer-04-zlib-compression-packer-demo/>
<div class=article-details>
<h2 class=article-title>加壳原理04 - zlib压缩壳案例</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/learning-packer-03-support-no-relocations/>
<div class=article-details>
<h2 class=article-title>加壳原理03 - 支持没有重定位的程序</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/learning-packer-07/>
<div class=article-details>
<h2 class=article-title>加壳原理07 - 花指令入门</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/learning-packer-06/>
<div class=article-details>
<h2 class=article-title>加壳原理06：反调试技术入门</h2>
</div>
</a>
</article>
<article>
<a href=/blog/p/learning-packer-01/>
<div class=article-details>
<h2 class=article-title>加壳原理01 - Windows 程序的加载和运行</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<footer class=site-footer>
<section class=copyright>
&copy;
2021 weakptr's 笔记
</section>
<section class=powerby>
<a href=https://beian.miit.gov.cn/>浙ICP备2021032371号-1</a> <br>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.1.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">目录</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#前言>前言</a></li>
<li><a href=#0x01-思路>0x01 思路</a></li>
<li><a href=#0x02-加载器>0x02 加载器</a>
<ol>
<li><a href=#21-资源介绍>2.1 资源介绍</a></li>
<li><a href=#22-查找并加载资源>2.2 查找并加载资源</a></li>
<li><a href=#23-解析图片>2.3 解析图片</a></li>
<li><a href=#24-入口点>2.4 入口点</a></li>
</ol>
</li>
<li><a href=#0x03-加壳机>0x03 加壳机</a>
<ol>
<li><a href=#31-程序转图片>3.1 程序转图片</a></li>
<li><a href=#32-编译资源>3.2 编译资源</a></li>
<li><a href=#33-编译加载器>3.3 编译加载器</a></li>
</ol>
</li>
<li><a href=#0x04-成果展示>0x04 成果展示</a>
<ol>
<li><a href=#41-完整代码>4.1 完整代码</a></li>
<li><a href=#42-成果>4.2 成果</a></li>
</ol>
</li>
<li><a href=#总结>总结</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/blog/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>