<!doctype html><html lang=zh-cn dir=ltr>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="前言 还记得很久以前学数据结构只看到二叉树，讲到平衡，但平衡方法当时看纸质书手头也没有实验环境，后来就没继续学下去。现在有闲就重新捡起来学一下"><title>AVL树</title>
<link rel=canonical href=https://nnnewb.github.io/p/avl-tree/>
<link rel=stylesheet href=/scss/style.min.709d4f89582c5a09dc94158a722a16093cdffe24d9a8c77dd3f422c786203c41.css><script src=https://unpkg.com/dayjs@1.8.21/dayjs.min.js></script>
<script src=https://unpkg.com/dayjs@1.8.21/plugin/relativeTime.js></script>
<script src=https://unpkg.com/dayjs@1.8.21/locale/zh-cn.js></script>
<script>dayjs.locale('zh-cn'),dayjs.extend(dayjs_plugin_relativeTime)</script><meta property="og:title" content="AVL树">
<meta property="og:description" content="前言 还记得很久以前学数据结构只看到二叉树，讲到平衡，但平衡方法当时看纸质书手头也没有实验环境，后来就没继续学下去。现在有闲就重新捡起来学一下">
<meta property="og:url" content="https://nnnewb.github.io/p/avl-tree/">
<meta property="og:site_name" content="weakptr's 笔记">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="数据结构"><meta property="article:tag" content="python"><meta property="article:published_time" content="2022-02-11T15:07:00+08:00"><meta property="article:modified_time" content="2022-02-11T15:07:00+08:00">
<meta name=twitter:title content="AVL树">
<meta name=twitter:description content="前言 还记得很久以前学数据结构只看到二叉树，讲到平衡，但平衡方法当时看纸质书手头也没有实验环境，后来就没继续学下去。现在有闲就重新捡起来学一下">
</head>
<body class=article-page>
<script>(function(){const a='StackColorScheme';localStorage.setItem(a,"light")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky">
<button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box>
<span class=hamburger-inner></span>
</span>
</button>
<header>
<figure class=site-avatar>
<a href=/>
<img src=/img/avatar_hub37949326d1692892aa1e64434c0dda6_382115_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a>
<span class=emoji>🍑</span>
</figure>
<div class=site-meta>
<h1 class=site-name><a href=/>weakptr's 笔记</a></h1>
<h2 class=site-description>弃船！</h2>
</div>
</header><ol class=social-menu>
<li>
<a href=https://github.com/nnnewb/ target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg>
</a>
</li>
</ol><ol class=menu id=main-menu>
<li>
<a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>首页</span>
</a>
</li>
<li>
<a href=/about><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>关于我</span>
</a>
</li>
<li>
<a href=/archive><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>归档</span>
</a>
</li>
<li>
<a href=/categories><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>分类</span>
</a>
</li>
<li>
<a href=/tags><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg>
<span>标签</span>
</a>
</li>
<li>
<a href=/link><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>友链</span>
</a>
</li>
<li>
<a href=/search><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>搜索</span>
</a>
</li>
<div class=menu-bottom-section>
</div>
</ol>
</aside>
<main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/categories/python/>
python
</a>
</header>
<div class=article-title-wrapper>
<h2 class=article-title>
<a href=/p/avl-tree/>AVL树</a>
</h2>
</div>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2022-02-11T15:07:00+08:00>2022年 2月 11日</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
阅读时长: 6 分钟
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<h2 id=前言>前言</h2>
<p>还记得很久以前学数据结构只看到二叉树，讲到平衡，但平衡方法当时看纸质书手头也没有实验环境，后来就没继续学下去。现在有闲就重新捡起来学一下。先从AVL树继续看。</p>
<h2 id=avl树>AVL树</h2>
<p>AVL 树是以提出者名字命名的，Adelson-Velskii & Landis，俄国人，后来移居以色列。人怎么样不管啦。</p>
<p>AVL 树是一种平衡二叉树，左右子树高度差不超过1。保持平衡的方法是每次插入数据的时候发现子树不平衡，就把较高的子树提升为根，把根变成新的根的子树，把较高的子树变矮，较矮的子树变高，实现平衡。这个过程被叫做旋转，下面介绍旋转。</p>
<h2 id=左旋转右旋转>左旋转/右旋转</h2>
<p><img src=/p/avl-tree/640.webp width=1080 height=302 srcset="/p/avl-tree/640_hue4f2eb0b84b4ee9edbff095635b31765_16328_480x0_resize_q75_h2_box_2.webp 480w, /p/avl-tree/640_hue4f2eb0b84b4ee9edbff095635b31765_16328_1024x0_resize_q75_h2_box_2.webp 1024w" loading=lazy alt=右旋转 class=gallery-image data-flex-grow=357 data-flex-basis=858px></p>
<p><img src=/p/avl-tree/640-16445510501782.webp width=1080 height=265 srcset="/p/avl-tree/640-16445510501782_hu6ffc1b8ea7f9226d8e679d85cbb8998e_14524_480x0_resize_q75_h2_box_2.webp 480w, /p/avl-tree/640-16445510501782_hu6ffc1b8ea7f9226d8e679d85cbb8998e_14524_1024x0_resize_q75_h2_box_2.webp 1024w" loading=lazy alt=左旋转 class=gallery-image data-flex-grow=407 data-flex-basis=978px></p>
<p>左旋转和右旋转的逻辑是一样的。如果右子树比左子树高，就把右子树提升成根。如果左子树比右子树高，就把左子树提升成根。提升右子树叫左旋转，提升左子树叫右旋转。</p>
<p>把子树提升成根会有点麻烦。比如右子树提升为根，原来的根和左子树怎么办？我们并不想重新平衡树的时候把整个左子树都删掉，那原来的根和左子树就必须插回新的树里。</p>
<p>我们知道右子树的 key 肯定比根和左子树所有节点大，所以根要插回树的话，一个很直接的想法就是把旧的根接到右子树左下角的叶子节点。</p>
<p><img src=/p/avl-tree/image-20220211115435552.png width=442 height=352 srcset="/p/avl-tree/image-20220211115435552_hudaf66137716a342688a9fcb78a9ab8fa_32310_480x0_resize_box_3.png 480w, /p/avl-tree/image-20220211115435552_hudaf66137716a342688a9fcb78a9ab8fa_32310_1024x0_resize_box_3.png 1024w" loading=lazy alt=旧的根插回新根 class=gallery-image data-flex-grow=125 data-flex-basis=301px></p>
<p>的确，这样保持了二叉搜索树的特征，但新的树依然不平衡：节点5的左子树高度2，右子树高度0，高度差超过了1。稍微想想就知道，旧的根和左子树直接接到左下角叶子节点的话，会让原本平衡的新树左子树高度增加，进而失去平衡。</p>
<p>解决方法也很简单，不要把旧的树接到新的树最小值上，而是把新树的左子树，移植成旧树的右子树，再把旧树移植成新树的左子树。这样一来，右子树的左子树和左子树的右子树不管怎么旋转，高度都一样。</p>
<p><img src=/p/avl-tree/image-20220211135807095.png width=559 height=367 srcset="/p/avl-tree/image-20220211135807095_huce0ca6d6e6da680d37b57191522379d3_34024_480x0_resize_box_3.png 480w, /p/avl-tree/image-20220211135807095_huce0ca6d6e6da680d37b57191522379d3_34024_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220211135807095 class=gallery-image data-flex-grow=152 data-flex-basis=365px></p>
<p>为什么这样可以保持平衡呢？首先AVL树的子树也是AVL树，所以子树的子树之间高度差也不超过1。左旋转、右旋转的的作用是让子树高度一侧升高，一侧降低——注意，左旋转只能降低右儿子的右子树高度，右儿子的左子树高度不变。右旋转只能降低左儿子的左子树高度，左儿子的右子树高度不变。</p>
<p>举例来说，上图中右儿子的右子树（4-6-7-8）较高，旋转后变成了（6-7-8），而原本的（4-6-5）变成了（6-4-5），高度不变。</p>
<p>这个规律很好理解，因为原来的右子树变成了根，整个右子树剩下的节点高度都降低了。而右子树的左子树变成了现在的左子树的右子树，和根的距离一样，所以高度不变。</p>
<p><strong>左旋转让右子树的右子树高度-1，左子树的左子树高度+1。左子树的右子树高度等于右子树的左子树，旋转后新树的左右子树的高度相等。</strong></p>
<h2 id=双旋转>双旋转</h2>
<p>对于往左儿子的左子树插入节点造成的不平衡，右旋转可以实现降低左儿子的左子树高度，再次平衡。往右儿子的右子树插入节点造成的不平衡，左旋转可以降低右儿子的右子树高度，再次平衡。但对于左儿子的右子树或右儿子的左子树插入节点造成的不平衡，一次左、右旋转无法实现再平衡。</p>
<p>再看一个例子。</p>
<p><img src=/p/avl-tree/image-20220211141652944.png width=535 height=399 srcset="/p/avl-tree/image-20220211141652944_hue06f3e4447c8c13119165b1bee1e7d22_36072_480x0_resize_box_3.png 480w, /p/avl-tree/image-20220211141652944_hue06f3e4447c8c13119165b1bee1e7d22_36072_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220211141652944 class=gallery-image data-flex-grow=134 data-flex-basis=321px></p>
<p>旋转前，右儿子的左子树（4-7-6-5）高度是4，旋转后（7-4-6-5）高度不变，依然是4，树仍然不平衡。解决办法也很简单，先把右子树（7）右旋，让右儿子的左子树高度低于右子树，再对整棵树左旋，也就是AVL树的双旋转。</p>
<p>一步一步看双旋转是怎么解决这个问题的。</p>
<p>第一步，右儿子的左子树比右儿子右子树高，所以将右儿子右旋，使得右儿子的右子树高于右儿子的左子树。</p>
<p><img src=/p/avl-tree/image-20220211142847329.png width=490 height=346 srcset="/p/avl-tree/image-20220211142847329_hudfe01573f636ba8f14106612b6b86fbd_23701_480x0_resize_box_3.png 480w, /p/avl-tree/image-20220211142847329_hudfe01573f636ba8f14106612b6b86fbd_23701_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220211142847329 class=gallery-image data-flex-grow=141 data-flex-basis=339px></p>
<p>我们知道的左旋转时右儿子的左子树高度不变，右儿子的右子树高度-1。这一步前，直接对整棵树左旋时，最高的那颗子树（右儿子的左子树）高度没有变化，树依然不平衡，只是变成了右子树更矮，左子树更高而已。</p>
<p>而这一步之后，最高的子树变成了右子树的右子树。现在对整棵树左旋，右子树的右子树高度下降了，和原本右子树的左子树高度一致，达成平衡。</p>
<p><img src=/p/avl-tree/image-20220211151253277.png width=573 height=352 srcset="/p/avl-tree/image-20220211151253277_hu3754058aad682cd96a93972186837210_33976_480x0_resize_box_3.png 480w, /p/avl-tree/image-20220211151253277_hu3754058aad682cd96a93972186837210_33976_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20220211151253277 class=gallery-image data-flex-grow=162 data-flex-basis=390px></p>
<p>这个原则简单地说，就是左子树下最高的子树应该是左子树，右子树下最高的子树应该是右子树。如果新增节点后不满足这个条件，就要先对左子树左旋，或者对右子树右旋，来满足这个条件。</p>
<h2 id=代码实现>代码实现</h2>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Optional</span>


<span class=k>class</span> <span class=nc>AVLTreeNode</span><span class=p>:</span>
    <span class=s2>&#34;&#34;&#34;树节点
</span><span class=s2>    &#34;&#34;&#34;</span>
    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>parent</span><span class=p>:</span> <span class=s1>&#39;AVLTreeNode&#39;</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=n>value</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>parent</span> <span class=o>=</span> <span class=n>parent</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>left</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=s1>&#39;AVLTreeNode&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>right</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=s1>&#39;AVLTreeNode&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>height</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
        <span class=s2>&#34;&#34;&#34;子树高度
</span><span class=s2>
</span><span class=s2>        Returns:
</span><span class=s2>            int: 子树高度
</span><span class=s2>        &#34;&#34;&#34;</span>
        <span class=k>return</span> <span class=nb>max</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_left_height</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_right_height</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>_left_height</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>left</span><span class=o>.</span><span class=n>height</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>left</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=mi>0</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>_right_height</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>right</span><span class=o>.</span><span class=n>height</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>right</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=mi>0</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>balance</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
        <span class=s2>&#34;&#34;&#34;是否平衡
</span><span class=s2>
</span><span class=s2>        Returns:
</span><span class=s2>            bool: 是否平衡
</span><span class=s2>        &#34;&#34;&#34;</span>
        <span class=k>return</span> <span class=nb>abs</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_left_height</span><span class=o>-</span><span class=bp>self</span><span class=o>.</span><span class=n>_right_height</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=mi>1</span>

    <span class=k>def</span> <span class=nf>right_rotate</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=s2>&#34;&#34;&#34;节点右旋
</span><span class=s2>        &#34;&#34;&#34;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>left</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s1>&#39;can not rotate tree with empty left node&#39;</span><span class=p>)</span>
        <span class=c1># 旧的根成为右节点</span>
        <span class=c1># 旧的根的左节点成为新的根</span>
        <span class=c1># 新的根的右节点变成旧的根的左节点</span>
        <span class=c1># 旧的根变成新的根的右节点</span>
        <span class=n>old_root</span> <span class=o>=</span> <span class=bp>self</span>
        <span class=n>new_root</span> <span class=o>=</span> <span class=n>old_root</span><span class=o>.</span><span class=n>left</span>

        <span class=n>old_root</span><span class=o>.</span><span class=n>left</span> <span class=o>=</span> <span class=n>new_root</span><span class=o>.</span><span class=n>right</span>
        <span class=n>new_root</span><span class=o>.</span><span class=n>right</span> <span class=o>=</span> <span class=n>old_root</span>

        <span class=c1># 新根替换旧根</span>
        <span class=k>if</span> <span class=n>old_root</span><span class=o>.</span><span class=n>parent</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>old_root</span><span class=o>.</span><span class=n>parent</span><span class=o>.</span><span class=n>left</span> <span class=o>==</span> <span class=n>old_root</span><span class=p>:</span>
                <span class=n>old_root</span><span class=o>.</span><span class=n>parent</span><span class=o>.</span><span class=n>left</span> <span class=o>=</span> <span class=n>new_root</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>old_root</span><span class=o>.</span><span class=n>parent</span><span class=o>.</span><span class=n>right</span> <span class=o>=</span> <span class=n>new_root</span>

        <span class=n>new_root</span><span class=o>.</span><span class=n>parent</span> <span class=o>=</span> <span class=n>old_root</span><span class=o>.</span><span class=n>parent</span>
        <span class=n>old_root</span><span class=o>.</span><span class=n>parent</span> <span class=o>=</span> <span class=n>new_root</span>
        <span class=k>if</span> <span class=n>old_root</span><span class=o>.</span><span class=n>left</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>old_root</span><span class=o>.</span><span class=n>left</span><span class=o>.</span><span class=n>parent</span> <span class=o>=</span> <span class=n>old_root</span>

    <span class=k>def</span> <span class=nf>left_rotate</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=s2>&#34;&#34;&#34;节点左旋
</span><span class=s2>        &#34;&#34;&#34;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>right</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s1>&#39;can not rotate tree with empty right node&#39;</span><span class=p>)</span>
        <span class=c1># 旧的根成为左节点</span>
        <span class=c1># 旧的根的右节点成为新的根</span>
        <span class=c1># 新的根的左节点作为旧的根的右子树</span>
        <span class=c1># 旧的根变成新的根的左子树</span>
        <span class=n>old_root</span> <span class=o>=</span> <span class=bp>self</span>
        <span class=n>new_root</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>right</span>

        <span class=n>old_root</span><span class=o>.</span><span class=n>right</span> <span class=o>=</span> <span class=n>new_root</span><span class=o>.</span><span class=n>left</span>
        <span class=n>new_root</span><span class=o>.</span><span class=n>left</span> <span class=o>=</span> <span class=n>old_root</span>

        <span class=c1># 新根替换旧根</span>
        <span class=k>if</span> <span class=n>old_root</span><span class=o>.</span><span class=n>parent</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>old_root</span><span class=o>.</span><span class=n>parent</span><span class=o>.</span><span class=n>left</span> <span class=o>==</span> <span class=n>old_root</span><span class=p>:</span>
                <span class=n>old_root</span><span class=o>.</span><span class=n>parent</span><span class=o>.</span><span class=n>left</span> <span class=o>=</span> <span class=n>new_root</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>old_root</span><span class=o>.</span><span class=n>parent</span><span class=o>.</span><span class=n>right</span> <span class=o>=</span> <span class=n>new_root</span>

        <span class=n>new_root</span><span class=o>.</span><span class=n>parent</span> <span class=o>=</span> <span class=n>old_root</span><span class=o>.</span><span class=n>parent</span>
        <span class=n>old_root</span><span class=o>.</span><span class=n>parent</span> <span class=o>=</span> <span class=n>new_root</span>
        <span class=k>if</span> <span class=n>old_root</span><span class=o>.</span><span class=n>right</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>old_root</span><span class=o>.</span><span class=n>right</span><span class=o>.</span><span class=n>parent</span> <span class=o>=</span> <span class=n>old_root</span>

        <span class=k>assert</span> <span class=n>new_root</span><span class=o>.</span><span class=n>right</span><span class=o>.</span><span class=n>value</span> <span class=o>&gt;</span> <span class=n>new_root</span><span class=o>.</span><span class=n>value</span>
        <span class=k>assert</span> <span class=n>new_root</span><span class=o>.</span><span class=n>left</span><span class=o>.</span><span class=n>value</span> <span class=o>&lt;</span> <span class=n>new_root</span><span class=o>.</span><span class=n>value</span>

    <span class=k>def</span> <span class=nf>_rebalance</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>balance</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_left_height</span> <span class=o>&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>_right_height</span><span class=p>:</span>
            <span class=c1># 如果最高的子树是左子树的右子树，先对左子树左旋</span>
            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>left</span><span class=o>.</span><span class=n>left</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> \
                    <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>left</span><span class=o>.</span><span class=n>right</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> \
                    <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>left</span><span class=o>.</span><span class=n>left</span><span class=o>.</span><span class=n>height</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>left</span><span class=o>.</span><span class=n>right</span><span class=o>.</span><span class=n>height</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>left</span><span class=o>.</span><span class=n>left_rotate</span><span class=p>()</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>right_rotate</span><span class=p>()</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=c1># 如果最高的子树是右子树的左子树，先对右子树右旋</span>
            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>right</span><span class=o>.</span><span class=n>right</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> \
                    <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>right</span><span class=o>.</span><span class=n>left</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> \
                    <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>right</span><span class=o>.</span><span class=n>right</span><span class=o>.</span><span class=n>height</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>right</span><span class=o>.</span><span class=n>left</span><span class=o>.</span><span class=n>height</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>right</span><span class=o>.</span><span class=n>right_rotate</span><span class=p>()</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>left_rotate</span><span class=p>()</span>

    <span class=k>def</span> <span class=nf>insert</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
        <span class=s2>&#34;&#34;&#34;插入新节点
</span><span class=s2>
</span><span class=s2>        Args:
</span><span class=s2>            value (int): 要插入的数据
</span><span class=s2>        &#34;&#34;&#34;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>&gt;</span> <span class=n>value</span><span class=p>:</span>
            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>left</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>left</span> <span class=o>=</span> <span class=n>AVLTreeNode</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=bp>self</span><span class=p>)</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>left</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>&lt;</span> <span class=n>value</span><span class=p>:</span>
            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>right</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>right</span> <span class=o>=</span> <span class=n>AVLTreeNode</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=bp>self</span><span class=p>)</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>right</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_rebalance</span><span class=p>()</span>

    <span class=k>def</span> <span class=nf>search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
        <span class=s2>&#34;&#34;&#34;搜索值
</span><span class=s2>
</span><span class=s2>        Args:
</span><span class=s2>            value (int): 待搜索的值
</span><span class=s2>
</span><span class=s2>        Returns:
</span><span class=s2>            bool: 值是否存在
</span><span class=s2>        &#34;&#34;&#34;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>==</span> <span class=n>value</span><span class=p>:</span>
            <span class=k>return</span> <span class=kc>True</span>
        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>&gt;</span> <span class=n>value</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>left</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>left</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>&lt;</span> <span class=n>value</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>right</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>right</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>return</span> <span class=kc>False</span>




<span class=k>class</span> <span class=nc>AVLTree</span><span class=p>:</span>
    <span class=s2>&#34;&#34;&#34;AVL tree
</span><span class=s2>    &#34;&#34;&#34;</span>

    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>root</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>AVLTreeNode</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>height</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=s2>&#34;&#34;&#34;AVL树高度
</span><span class=s2>
</span><span class=s2>        Returns:
</span><span class=s2>            int: 树高度
</span><span class=s2>        &#34;&#34;&#34;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>root</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>root</span><span class=o>.</span><span class=n>height</span>
        <span class=k>return</span> <span class=mi>0</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>balance</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
        <span class=s2>&#34;&#34;&#34;树是否平衡
</span><span class=s2>
</span><span class=s2>        Returns:
</span><span class=s2>            bool: 树是否平衡
</span><span class=s2>        &#34;&#34;&#34;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>root</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>root</span><span class=o>.</span><span class=n>balance</span>
        <span class=k>return</span> <span class=kc>True</span>

    <span class=k>def</span> <span class=nf>insert</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
        <span class=s2>&#34;&#34;&#34;insert new value
</span><span class=s2>
</span><span class=s2>        Args:
</span><span class=s2>            value (int): new value
</span><span class=s2>        &#34;&#34;&#34;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>root</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>root</span> <span class=o>=</span> <span class=n>AVLTreeNode</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>root</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>

        <span class=c1># AVL 树旋转后根节点可能不再是现在这个节点，需要重新寻找根节点</span>
        <span class=n>top</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>root</span>
        <span class=k>while</span> <span class=n>top</span><span class=o>.</span><span class=n>parent</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>top</span> <span class=o>=</span> <span class=n>top</span><span class=o>.</span><span class=n>parent</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>root</span> <span class=o>=</span> <span class=n>top</span>

    <span class=k>def</span> <span class=nf>search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
        <span class=s2>&#34;&#34;&#34;search a value
</span><span class=s2>
</span><span class=s2>        Args:
</span><span class=s2>            value (int): searching value
</span><span class=s2>        &#34;&#34;&#34;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>root</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>return</span> <span class=kc>False</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>root</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>

</code></pre></td></tr></table>
</div>
</div><h2 id=总结>总结</h2>
<p>AVL树只要理解和左右旋转的方法和作用，就不难理解左右旋转与双旋转的意义了。</p>
<p>单次旋转的目的都是将两侧子树，一颗子树高度+1，一颗子树高度-1，将高度相差2的两颗子树重新平衡。</p>
<p>单次旋转的限制是只能降低子树中一颗子树的高度，左子树的左子树或右子树的右子树，所以一旦出现左右子树中最高的子树不是左-左或右-右，单次旋转就不能重新平衡。对这种情况，先旋转子树，令左-左或右-右成为最高的子树后，再对根节点旋转，就能重新平衡了。</p>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/>数据结构</a>
<a href=/tags/python/>python</a>
</section>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>相关文章</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article>
<a href=/p/b-tree/>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>B树</h2>
</div>
</a>
</article>
<article>
<a href=/p/pattern-match-in-python310/>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>pattern-match-in-python310</h2>
</div>
</a>
</article>
<article>
<a href=/p/flask%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0wsgi/>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>Flask源码阅读笔记：WSGI</h2>
</div>
</a>
</article>
<article>
<a href=/p/django-%E7%9A%84%E5%90%84%E7%A7%8D%E5%85%B3%E7%B3%BB%E5%AD%97%E6%AE%B5%E8%AF%A6%E8%A7%A3/>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>Django 的各种关系字段详解</h2>
</div>
</a>
</article>
<article>
<a href=/p/%E8%BD%BB%E9%87%8F%E7%BA%A7-django-%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%E6%9C%80%E5%B0%8F%E7%9A%84-django-%E5%BA%94%E7%94%A8/>
<div class=light>
<div class=lamp></div>
</div>
<div class=article-details>
<h2 class=article-title>轻量级 django 阅读笔记：最小的 django 应用</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<footer class=site-footer>
<section class=copyright>
&copy;
2021 -
2024 weakptr's 笔记
</section>
<section class=powerby>
<a href=https://beian.miit.gov.cn/>浙ICP备2021032371号-1</a>
<span style=margin-left:16px></span>
<a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33032402002231" style=display:inline-block;text-decoration:none;height:20px;line-height:20px>
<img src=/blog/image/beian.png style=float:left>
浙公网安备 33032402002231号
</a>
<br>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计
，由 <a href=https://nnnewb.github.io/blog/>nnnewb</a> 修改
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">目录</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#前言>前言</a></li>
<li><a href=#avl树>AVL树</a></li>
<li><a href=#左旋转右旋转>左旋转/右旋转</a></li>
<li><a href=#双旋转>双旋转</a></li>
<li><a href=#代码实现>代码实现</a></li>
<li><a href=#总结>总结</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>